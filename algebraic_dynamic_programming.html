<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-09-25 Thu 18:12 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Algebraic dynamic programming</title>
<meta name="author" content="Justin Veilleux" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  pre.src-C\+\+:before { content: 'C++'; }
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'JavaScript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="Agda.css" />
<style>.org-latex-block { margin: auto; } </style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Algebraic dynamic programming</h1>
<p>
Note: This was partially copied and Julia-translated from <a href="https://matteo.delab.re/files/slides/2024-02-polymorphic-dynamic-programming.pdf">Matt√©o</a>&rsquo;s Midiro
presentation.
</p>
<div id="outline-container-orgd95d862" class="outline-2">
<h2 id="orgd95d862"><span class="section-number-2">1.</span> Background: semi rings</h2>
<div class="outline-text-2" id="text-1">
<p>
A semiring is an algebraic structure that incarnates the essence of &ldquo;sum of
products&rdquo;. A couple of examples of semi rings would be the natural numbers,
square matrices (in two different ways), real numbers, polynomials, and more.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">abstract type</span> <span style="color: #531ab6; font-weight: bold;">Semiring</span> <span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<p>
A semi ring is a set with the following properties<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>:
</p>

<ol class="org-ol">
<li>Has an addition operation. (<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%278.748747pt%27 height=%277.641754pt%27 viewBox=%27-.500002 -6.311537 8.748747 7.641754%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g1-43%27 d=%27m4.07472-2.291407h2.779577c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.328767-.199253h-2.779577v-2.789539c0-.139477 0-.328767-.199253-.328767s-.199253 .18929-.199253 .328767v2.789539h-2.789539c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .328767 .199253h2.789539v2.789539c0 .139477 0 .328767 .199253 .328767s.199253-.18929 .199253-.328767v-2.789539z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page1%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g1-43%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( + \)" style="height: 0.7517em; vertical-align: -0.1309em; display: inline-block" class="org-latex org-latex-inline" />)</li>
<li>Has a multiplication operation. (<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%278.748747pt%27 height=%277.641754pt%27 viewBox=%27-.500002 -6.311537 8.748747 7.641754%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g5-2%27 d=%27m3.875467-2.769614l-1.992528-1.982565c-.119552-.119552-.139477-.139477-.219178-.139477c-.099626 0-.199253 .089664-.199253 .199253c0 .069738 .019925 .089664 .129514 .199253l1.992528 2.002491l-1.992528 2.002491c-.109589 .109589-.129514 .129514-.129514 .199253c0 .109589 .099626 .199253 .199253 .199253c.079701 0 .099626-.019925 .219178-.139477l1.982565-1.982565l2.062267 2.062267c.019925 .009963 .089664 .059776 .14944 .059776c.119552 0 .199253-.089664 .199253-.199253c0-.019925 0-.059776-.029888-.109589c-.009963-.019925-1.594022-1.58406-2.092154-2.092154l1.823163-1.823163c.049813-.059776 .199253-.18929 .249066-.249066c.009963-.019925 .049813-.059776 .049813-.129514c0-.109589-.079701-.199253-.199253-.199253c-.079701 0-.119552 .039851-.229141 .14944l-1.972603 1.972603z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page2%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g5-2%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( \times \)" style="height: 0.7517em; vertical-align: -0.1309em; display: inline-block" class="org-latex org-latex-inline" />)</li>
<li>Has additive identity. (<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2742.829061pt%27 height=%278.250585pt%27 viewBox=%27-.500002 -6.920368 42.829061 8.250585%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-120%27 d=%27m3.327522-3.008717c.059776-.259029 .288917-1.175592 .986301-1.175592c.049813 0 .288917 0 .498132 .129514c-.278954 .049813-.478207 .298879-.478207 .537983c0 .159402 .109589 .348692 .37858 .348692c.219178 0 .537983-.179328 .537983-.577833c0-.518057-.587796-.657534-.926526-.657534c-.577833 0-.926526 .52802-1.046077 .757161c-.249066-.657534-.787049-.757161-1.075965-.757161c-1.036115 0-1.603985 1.285181-1.603985 1.534247c0 .099626 .099626 .099626 .119552 .099626c.079701 0 .109589-.019925 .129514-.109589c.33873-1.05604 .996264-1.305106 1.334994-1.305106c.18929 0 .537983 .089664 .537983 .667497c0 .308842-.169365 .976339-.537983 2.371108c-.159402 .617684-.508095 1.036115-.946451 1.036115c-.059776 0-.288917 0-.498132-.129514c.249066-.049813 .468244-.259029 .468244-.537983c0-.268991-.219178-.348692-.368618-.348692c-.298879 0-.547945 .259029-.547945 .577833c0 .458281 .498132 .657534 .936488 .657534c.657534 0 1.016189-.697385 1.046077-.757161c.119552 .368618 .478207 .757161 1.075965 .757161c1.026152 0 1.594022-1.285181 1.594022-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.089664 0-.109589 .039851-.129514 .109589c-.328767 1.066002-1.006227 1.305106-1.325031 1.305106c-.388543 0-.547945-.318804-.547945-.657534c0-.219178 .059776-.438356 .169365-.876712l.33873-1.364882z%27/%3E%0A%3Cpath id=%27g1-43%27 d=%27m4.07472-2.291407h2.779577c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.328767-.199253h-2.779577v-2.789539c0-.139477 0-.328767-.199253-.328767s-.199253 .18929-.199253 .328767v2.789539h-2.789539c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .328767 .199253h2.789539v2.789539c0 .139477 0 .328767 .199253 .328767s.199253-.18929 .199253-.328767v-2.789539z%27/%3E%0A%3Cpath id=%27g1-48%27 d=%27m4.582814-3.188045c0-.797011-.049813-1.594022-.398506-2.331258c-.458281-.956413-1.275218-1.115816-1.693649-1.115816c-.597758 0-1.325031 .259029-1.733499 1.185554c-.318804 .687422-.368618 1.464508-.368618 2.261519c0 .747198 .039851 1.643836 .448319 2.400996c.428394 .806974 1.155666 1.006227 1.643836 1.006227c.537983 0 1.295143-.209215 1.733499-1.155666c.318804-.687422 .368618-1.464508 .368618-2.251557zm-2.102117 3.188045c-.388543 0-.976339-.249066-1.155666-1.205479c-.109589-.597758-.109589-1.514321-.109589-2.102117c0-.637609 0-1.295143 .079701-1.833126c.18929-1.185554 .936488-1.275218 1.185554-1.275218c.328767 0 .986301 .179328 1.175592 1.165629c.099626 .557908 .099626 1.315068 .099626 1.942715c0 .747198 0 1.424658-.109589 2.062267c-.14944 .946451-.71731 1.24533-1.165629 1.24533z%27/%3E%0A%3Cpath id=%27g1-61%27 d=%27m6.844334-3.257783c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.967621c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h5.947696zm.009963 1.932752c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.33873-.199253h-5.947696c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.967621z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page3%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g1-48%27/%3E%0A%3Cuse x=%277.195205%27 y=%270%27 xlink:href=%27%23g1-43%27/%3E%0A%3Cuse x=%2717.157819%27 y=%270%27 xlink:href=%27%23g8-120%27/%3E%0A%3Cuse x=%2725.619083%27 y=%270%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%2736.135163%27 y=%270%27 xlink:href=%27%23g8-120%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( 0 + x = x \)" style="height: 0.8116em; vertical-align: -0.1309em; display: inline-block" class="org-latex org-latex-inline" />)</li>
<li>Has a multiplicative identity. (<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2740.061652pt%27 height=%277.42037pt%27 viewBox=%27-.500002 -6.920368 40.061652 7.42037%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-120%27 d=%27m3.327522-3.008717c.059776-.259029 .288917-1.175592 .986301-1.175592c.049813 0 .288917 0 .498132 .129514c-.278954 .049813-.478207 .298879-.478207 .537983c0 .159402 .109589 .348692 .37858 .348692c.219178 0 .537983-.179328 .537983-.577833c0-.518057-.587796-.657534-.926526-.657534c-.577833 0-.926526 .52802-1.046077 .757161c-.249066-.657534-.787049-.757161-1.075965-.757161c-1.036115 0-1.603985 1.285181-1.603985 1.534247c0 .099626 .099626 .099626 .119552 .099626c.079701 0 .109589-.019925 .129514-.109589c.33873-1.05604 .996264-1.305106 1.334994-1.305106c.18929 0 .537983 .089664 .537983 .667497c0 .308842-.169365 .976339-.537983 2.371108c-.159402 .617684-.508095 1.036115-.946451 1.036115c-.059776 0-.288917 0-.498132-.129514c.249066-.049813 .468244-.259029 .468244-.537983c0-.268991-.219178-.348692-.368618-.348692c-.298879 0-.547945 .259029-.547945 .577833c0 .458281 .498132 .657534 .936488 .657534c.657534 0 1.016189-.697385 1.046077-.757161c.119552 .368618 .478207 .757161 1.075965 .757161c1.026152 0 1.594022-1.285181 1.594022-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.089664 0-.109589 .039851-.129514 .109589c-.328767 1.066002-1.006227 1.305106-1.325031 1.305106c-.388543 0-.547945-.318804-.547945-.657534c0-.219178 .059776-.438356 .169365-.876712l.33873-1.364882z%27/%3E%0A%3Cpath id=%27g5-3%27 d=%27m2.739726-4.254047c.009963-.139477 .009963-.37858-.249066-.37858c-.159402 0-.288917 .129514-.259029 .259029v.129514l.139477 1.544209l-1.275218-.926526c-.089664-.049813-.109589-.069738-.179328-.069738c-.139477 0-.268991 .139477-.268991 .278954c0 .159402 .099626 .199253 .199253 .249066l1.414695 .67746l-1.374844 .667497c-.159402 .079701-.239103 .119552-.239103 .268991s.129514 .278954 .268991 .278954c.069738 0 .089664 0 .33873-.18929l1.115816-.806974l-.14944 1.673724c0 .209215 .179328 .259029 .259029 .259029c.119552 0 .268991-.069738 .268991-.259029l-.14944-1.673724l1.275218 .926526c.089664 .049813 .109589 .069738 .179328 .069738c.139477 0 .268991-.139477 .268991-.278954c0-.14944-.089664-.199253-.209215-.259029c-.597758-.298879-.617684-.298879-1.404732-.667497l1.374844-.667497c.159402-.079701 .239103-.119552 .239103-.268991s-.129514-.278954-.268991-.278954c-.069738 0-.089664 0-.33873 .18929l-1.115816 .806974l.139477-1.554172z%27/%3E%0A%3Cpath id=%27g1-49%27 d=%27m2.929016-6.37609c0-.239103 0-.259029-.229141-.259029c-.617684 .637609-1.494396 .637609-1.8132 .637609v.308842c.199253 0 .787049 0 1.305106-.259029v5.160648c0 .358655-.029888 .478207-.926526 .478207h-.318804v.308842c.348692-.029888 1.215442-.029888 1.613948-.029888s1.265255 0 1.613948 .029888v-.308842h-.318804c-.896638 0-.926526-.109589-.926526-.478207v-5.589041z%27/%3E%0A%3Cpath id=%27g1-61%27 d=%27m6.844334-3.257783c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.967621c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h5.947696zm.009963 1.932752c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.33873-.199253h-5.947696c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.967621z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page4%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g1-49%27/%3E%0A%3Cuse x=%277.195205%27 y=%270%27 xlink:href=%27%23g5-3%27/%3E%0A%3Cuse x=%2714.39041%27 y=%270%27 xlink:href=%27%23g8-120%27/%3E%0A%3Cuse x=%2722.851675%27 y=%270%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%2733.367755%27 y=%270%27 xlink:href=%27%23g8-120%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( 1 * x = x \)" style="height: 0.7299em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />)</li>
<li>Multiplication distributes over addition. (<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27107.584762pt%27 height=%2710.962644pt%27 viewBox=%27-.500002 -7.971982 107.584762 10.962644%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g1-43%27 d=%27m4.07472-2.291407h2.779577c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.328767-.199253h-2.779577v-2.789539c0-.139477 0-.328767-.199253-.328767s-.199253 .18929-.199253 .328767v2.789539h-2.789539c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .328767 .199253h2.789539v2.789539c0 .139477 0 .328767 .199253 .328767s.199253-.18929 .199253-.328767v-2.789539z%27/%3E%0A%3Cpath id=%27g1-61%27 d=%27m6.844334-3.257783c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.967621c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h5.947696zm.009963 1.932752c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.33873-.199253h-5.947696c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.967621z%27/%3E%0A%3Cpath id=%27g5-3%27 d=%27m2.739726-4.254047c.009963-.139477 .009963-.37858-.249066-.37858c-.159402 0-.288917 .129514-.259029 .259029v.129514l.139477 1.544209l-1.275218-.926526c-.089664-.049813-.109589-.069738-.179328-.069738c-.139477 0-.268991 .139477-.268991 .278954c0 .159402 .099626 .199253 .199253 .249066l1.414695 .67746l-1.374844 .667497c-.159402 .079701-.239103 .119552-.239103 .268991s.129514 .278954 .268991 .278954c.069738 0 .089664 0 .33873-.18929l1.115816-.806974l-.14944 1.673724c0 .209215 .179328 .259029 .259029 .259029c.119552 0 .268991-.069738 .268991-.259029l-.14944-1.673724l1.275218 .926526c.089664 .049813 .109589 .069738 .179328 .069738c.139477 0 .268991-.139477 .268991-.278954c0-.14944-.089664-.199253-.209215-.259029c-.597758-.298879-.617684-.298879-1.404732-.667497l1.374844-.667497c.159402-.079701 .239103-.119552 .239103-.268991s-.129514-.278954-.268991-.278954c-.069738 0-.089664 0-.33873 .18929l-1.115816 .806974l.139477-1.554172z%27/%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3Cpath id=%27g8-99%27 d=%27m3.945205-3.785803c-.159402 0-.298879 0-.438356 .139477c-.159402 .14944-.179328 .318804-.179328 .388543c0 .239103 .179328 .348692 .368618 .348692c.288917 0 .557908-.239103 .557908-.637609c0-.488169-.468244-.856787-1.175592-.856787c-1.344956 0-2.669988 1.424658-2.669988 2.82939c0 .896638 .577833 1.683686 1.613948 1.683686c1.424658 0 2.261519-1.05604 2.261519-1.175592c0-.059776-.059776-.129514-.119552-.129514c-.049813 0-.069738 .019925-.129514 .099626c-.787049 .986301-1.872976 .986301-1.992528 .986301c-.627646 0-.896638-.488169-.896638-1.085928c0-.408468 .199253-1.374844 .537983-1.992528c.308842-.56787 .856787-.996264 1.404732-.996264c.33873 0 .71731 .129514 .856787 .398506z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page5%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%277.48002%27 y=%270%27 xlink:href=%27%23g5-3%27/%3E%0A%3Cuse x=%2714.675225%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2718.549599%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3Cuse x=%2725.039099%27 y=%270%27 xlink:href=%27%23g1-43%27/%3E%0A%3Cuse x=%2735.001712%27 y=%270%27 xlink:href=%27%23g8-99%27/%3E%0A%3Cuse x=%2739.313109%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%2745.954815%27 y=%270%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%2756.470895%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%2763.950915%27 y=%270%27 xlink:href=%27%23g5-3%27/%3E%0A%3Cuse x=%2771.14612%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3Cuse x=%2777.63562%27 y=%270%27 xlink:href=%27%23g1-43%27/%3E%0A%3Cuse x=%2787.598234%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%2795.078254%27 y=%270%27 xlink:href=%27%23g5-3%27/%3E%0A%3Cuse x=%27102.273459%27 y=%270%27 xlink:href=%27%23g8-99%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( a * (b + c) = a * b + a * c \)" style="height: 1.0784em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" />)</li>
</ol>

<p>
In Julia, the functions that give use the zero and the one associated to a type
are respectively <code>zero</code> and <code>one</code>. The addition and multiplication operations are <code>+</code>
and <code>*</code> like you would expect.
</p>
</div>
</div>
<div id="outline-container-orgc3d993f" class="outline-2">
<h2 id="orgc3d993f"><span class="section-number-2">2.</span> Dynamic programming problems as graph traversal</h2>
<div class="outline-text-2" id="text-2">
<p>
Very often, dynamic programming problems can be framed as nearest neighbor
problems in some appropriate abstract graph. Let&rsquo;s look, as an example, at the
editing distance.
</p>

<p>
What we mean by edit distance is the following. Given two strings <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.266144pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.266144 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page40%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( a \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> and <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%275.275627pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 5.275627 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page27%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(
b \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />, their edit distance is the smallest weight of editing operations such that
applying them on <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.266144pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.266144 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page40%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( a \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> gives you <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%275.275627pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 5.275627 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page41%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( b \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />. Available operations are the
following:
</p>

<ol class="org-ol">
<li>Inserting a character.</li>
<li>Removing a character.</li>
<li>Keeping a character.</li>
</ol>

<p>
For instance, the sequence of operations &ldquo;keep(c), keep(a), keep(r), delete(p),
insert(v), insert(e)&rdquo; edits the string &ldquo;carp&rdquo; into the string &ldquo;carve&rdquo;.
</p>

<p>
For this specific problem, the abstract graph would have, as nodes, pairs of
strings. The edges of this graph would be those editing operations.
</p>

<p>
the state (&ldquo;car&rdquo;, &ldquo;car) would be connected to the state (&rdquo;carp&ldquo;, &rdquo;car&ldquo;) through
the &rdquo;delete(p)" edge, for instance.
</p>

<p>
If we use as a starting node the state (&ldquo;&rdquo;, &ldquo;&rdquo;) (two empty strings), every path
the finished at the state (&ldquo;carp&rdquo;, &ldquo;carve&rdquo;) corresponds to a specific way to
modify the first string to turn it into the second.
</p>

<p>
Now that the problem is properly set up, let us move on to the way we will
compare different paths through the graph: weights.
</p>

<p>
Then, we will choose some semi ring <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%277.683254pt%27 height=%277.807787pt%27 viewBox=%27-.500002 -7.307786 7.683254 7.807787%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-83%27 d=%27m6.425903-6.924035c0-.029888-.019925-.099626-.109589-.099626c-.049813 0-.059776 .009963-.179328 .14944l-.478207 .56787c-.259029-.468244-.777086-.71731-1.424658-.71731c-1.265255 0-2.460772 1.145704-2.460772 2.351183c0 .806974 .52802 1.265255 1.036115 1.414695l1.066002 .278954c.368618 .089664 .916563 .239103 .916563 1.05604c0 .896638-.816936 1.833126-1.793275 1.833126c-.637609 0-1.743462-.219178-1.743462-1.454545c0-.239103 .049813-.478207 .059776-.537983c.009963-.039851 .019925-.049813 .019925-.069738c0-.099626-.069738-.109589-.119552-.109589s-.069738 .009963-.099626 .039851c-.039851 .039851-.597758 2.311333-.597758 2.34122c0 .059776 .049813 .099626 .109589 .099626c.049813 0 .059776-.009963 .179328-.14944l.488169-.56787c.428394 .577833 1.105853 .71731 1.683686 .71731c1.354919 0 2.530511-1.325031 2.530511-2.560399c0-.687422-.33873-1.026152-.488169-1.165629c-.229141-.229141-.37858-.268991-1.265255-.498132c-.219178-.059776-.577833-.159402-.667497-.179328c-.268991-.089664-.607721-.37858-.607721-.9066c0-.806974 .797011-1.653798 1.743462-1.653798c.826899 0 1.43462 .428394 1.43462 1.544209c0 .318804-.039851 .498132-.039851 .557908c0 .009963 0 .099626 .119552 .099626c.099626 0 .109589-.029888 .14944-.199253l.537983-2.181818z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page16%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-83%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( S \)" style="height: 0.7680em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> to represent the weights, then a
weight function <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2745.51175pt%27 height=%2711.022402pt%27 viewBox=%27-.500002 -7.971982 45.51175 11.022402%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g5-1%27 d=%27m1.912827-2.49066c0-.288917-.239103-.52802-.52802-.52802s-.52802 .239103-.52802 .52802s.239103 .52802 .52802 .52802s.52802-.239103 .52802-.52802z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g7-83%27 d=%27m4.951432-4.811955c0-.034869-.020922-.09066-.09066-.09066c-.041843 0-.048817 .006974-.139477 .097634l-.341719 .397509c-.265006-.369614-.704359-.495143-1.129763-.495143c-.983313 0-1.855044 .795019-1.855044 1.597011c0 .104608 .020922 .383562 .230137 .641594c.237111 .278954 .495143 .341719 .969365 .4533c.139477 .034869 .488169 .111582 .592777 .139477c.223163 .055791 .648568 .209215 .648568 .732254c0 .564882-.592777 1.227397-1.387796 1.227397c-.613699 0-1.352927-.216189-1.352927-.990286c0-.069738 .013948-.223163 .041843-.348692c.006974-.027895 .006974-.034869 .006974-.041843c0-.09066-.083686-.09066-.111582-.09066c-.097634 0-.104608 .013948-.132503 .139477l-.355666 1.39477c-.006974 .027895-.020922 .069738-.020922 .104608c0 .041843 .027895 .083686 .097634 .083686c.041843 0 .048817-.006974 .139477-.097634c.076712-.083686 .258032-.306849 .334745-.390535c.369614 .404483 .913574 .488169 1.332005 .488169c1.053051 0 1.903861-.9066 1.903861-1.729514c0-.306849-.125529-.585803-.278954-.746202c-.244085-.251059-.348692-.278954-1.248319-.488169c-.146451-.034869-.376588-.09066-.439352-.111582c-.174346-.062765-.467248-.237111-.467248-.63462c0-.550934 .620672-1.108842 1.345953-1.108842c.753176 0 1.115816 .425405 1.115816 1.08792c0 .09066-.027895 .251059-.027895 .313823c0 .097634 .083686 .097634 .118555 .097634c.104608 0 .111582-.034869 .139477-.153425l.36264-1.478456z%27/%3E%0A%3Cpath id=%27g9-50%27 d=%27m4.134496-1.185554c0-.099626-.079701-.119552-.129514-.119552c-.089664 0-.109589 .059776-.129514 .139477c-.348692 1.026152-1.24533 1.026152-1.344956 1.026152c-.498132 0-.896638-.298879-1.125778-.667497c-.298879-.478207-.298879-1.135741-.298879-1.494396h2.779577c.219178 0 .249066 0 .249066-.209215c0-.986301-.537983-1.952677-1.783313-1.952677c-1.155666 0-2.072229 1.026152-2.072229 2.271482c0 1.334994 1.046077 2.30137 2.191781 2.30137c1.215442 0 1.663761-1.105853 1.663761-1.295143zm-.657534-1.325031h-2.361146c.059776-1.484433 .896638-1.733499 1.235367-1.733499c1.026152 0 1.125778 1.344956 1.125778 1.733499z%27/%3E%0A%3Cpath id=%27g9-59%27 d=%27m4.83188-4.024907c0-.169365-.119552-.488169-.508095-.488169c-.199253 0-.637609 .059776-1.05604 .468244c-.418431-.328767-.836862-.358655-1.05604-.358655c-.926526 0-1.613948 .687422-1.613948 1.454545c0 .438356 .219178 .816936 .468244 1.026152c-.129514 .14944-.308842 .478207-.308842 .826899c0 .308842 .129514 .687422 .438356 .886675c-.597758 .169365-.916563 .597758-.916563 .996264c0 .71731 .986301 1.265255 2.201743 1.265255c1.175592 0 2.211706-.508095 2.211706-1.285181c0-.348692-.139477-.856787-.647572-1.135741c-.52802-.278954-1.105853-.278954-1.713574-.278954c-.249066 0-.67746 0-.747198-.009963c-.318804-.039851-.52802-.348692-.52802-.667497c0-.039851 0-.268991 .169365-.468244c.388543 .278954 .797011 .308842 .986301 .308842c.926526 0 1.613948-.687422 1.613948-1.454545c0-.368618-.159402-.737235-.408468-.966376c.358655-.33873 .71731-.388543 .896638-.388543c0 0 .069738 0 .099626 .009963c-.109589 .039851-.159402 .14944-.159402 .268991c0 .169365 .129514 .288917 .288917 .288917c.099626 0 .288917-.069738 .288917-.298879zm-1.753425 1.075965c0 .268991-.009963 .587796-.159402 .836862c-.079701 .119552-.308842 .398506-.707347 .398506c-.86675 0-.86675-.996264-.86675-1.225405c0-.268991 .009963-.587796 .159402-.836862c.079701-.119552 .308842-.398506 .707347-.398506c.86675 0 .86675 .996264 .86675 1.225405zm1.09589 3.73599c0 .537983-.707347 1.036115-1.683686 1.036115c-1.006227 0-1.693649-.508095-1.693649-1.036115c0-.458281 .37858-.826899 .816936-.856787h.587796c.856787 0 1.972603 0 1.972603 .856787z%27/%3E%0A%3Cpath id=%27g9-63%27 d=%27m5.330012 0v-.308842c-.518057 0-.767123 0-.777086-.298879v-1.902864c0-.856787 0-1.165629-.308842-1.524284c-.139477-.169365-.468244-.368618-1.046077-.368618c-.836862 0-1.275218 .597758-1.43462 .956413h-.009963v-3.466999l-1.43462 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v5.180573c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888v-.308842c-.667497 0-.777086 0-.777086-.448319v-1.833126c0-1.036115 .707347-1.594022 1.344956-1.594022c.627646 0 .737235 .537983 .737235 1.105853v2.321295c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888z%27/%3E%0A%3Cpath id=%27g9-66%27 d=%27m2.460772 0v-.308842c-.657534 0-.697385-.049813-.697385-.438356v-3.656289l-1.39477 .109589v.308842c.647572 0 .737235 .059776 .737235 .547945v2.67995c0 .448319-.109589 .448319-.777086 .448319v.308842l1.09589-.029888c.348692 0 .697385 .019925 1.036115 .029888zm-.547945-6.017435c0-.268991-.229141-.52802-.52802-.52802c-.33873 0-.537983 .278954-.537983 .52802c0 .268991 .229141 .52802 .52802 .52802c.33873 0 .537983-.278954 .537983-.52802z%27/%3E%0A%3Cpath id=%27g9-105%27 d=%27m3.307597-1.235367v-.56787h-.249066v.547945c0 .737235-.298879 1.115816-.667497 1.115816c-.667497 0-.667497-.9066-.667497-1.075965v-2.769614h1.424658v-.308842h-1.424658v-1.833126h-.249066c-.009963 .816936-.308842 1.882939-1.285181 1.92279v.219178h.846824v2.749689c0 1.225405 .926526 1.344956 1.285181 1.344956c.707347 0 .986301-.707347 .986301-1.344956z%27/%3E%0A%3Cpath id=%27g9-114%27 d=%27m7.003736-3.985056v-.308842c-.219178 .019925-.508095 .029888-.727273 .029888l-.926526-.029888v.308842c.358655 .009963 .577833 .18929 .577833 .478207c0 .059776 0 .079701-.049813 .209215l-.9066 2.550436l-.986301-2.779577c-.039851-.119552-.049813-.139477-.049813-.18929c0-.268991 .388543-.268991 .587796-.268991v-.308842l-1.036115 .029888c-.298879 0-.587796-.009963-.886675-.029888v.308842c.368618 0 .52802 .019925 .627646 .14944c.049813 .059776 .159402 .358655 .229141 .547945l-.856787 2.410959l-.946451-2.660025c-.049813-.119552-.049813-.139477-.049813-.179328c0-.268991 .388543-.268991 .587796-.268991v-.308842l-1.085928 .029888l-.926526-.029888v.308842c.498132 0 .617684 .029888 .737235 .348692l1.255293 3.526775c.049813 .139477 .079701 .219178 .209215 .219178s.14944-.059776 .199253-.199253l1.006227-2.819427l1.016189 2.82939c.039851 .109589 .069738 .18929 .199253 .18929s.159402-.089664 .199253-.18929l1.165629-3.267746c.179328-.498132 .488169-.627646 .836862-.637609z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page11%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g9-114%27/%3E%0A%3Cuse x=%276.914073%27 y=%270%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%2711.337486%27 y=%270%27 xlink:href=%27%23g9-66%27/%3E%0A%3Cuse x=%2714.1071%27 y=%270%27 xlink:href=%27%23g9-59%27/%3E%0A%3Cuse x=%2719.08842%27 y=%270%27 xlink:href=%27%23g9-63%27/%3E%0A%3Cuse x=%2724.348695%27 y=%270%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%2728.224161%27 y=%272.550418%27 xlink:href=%27%23g7-83%27/%3E%0A%3Cuse x=%2733.995594%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2737.869968%27 y=%270%27 xlink:href=%27%23g5-1%27/%3E%0A%3Cuse x=%2740.637376%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( \text{weight}_S(\cdot) \)" style="height: 1.0842em; vertical-align: -0.3001em; display: inline-block" class="org-latex org-latex-inline" /> that will give such a weight to each
transition in the graph.
</p>

<p>
Finally, we will enumerate all the paths between the states of interest and
compute the weight of these paths through summing (across all paths) the
products (across transitions in a single path) of the weights of the
transitions.<sup><a id="fnr.2" class="footref" href="#fn.2" role="doc-backlink">2</a></sup>
</p>


<p>
<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27613.000002pt%27 height=%2715.445832pt%27 viewBox=%27-.500002 -14.94583 613.000002 15.445832%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g1-61%27 d=%27m6.844334-3.257783c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.967621c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h5.947696zm.009963 1.932752c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.33873-.199253h-5.947696c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.967621z%27/%3E%0A%3Cpath id=%27g9-28%27 d=%27m4.811955-.886675v-.557908h-.249066v.557908c0 .577833-.249066 .637609-.358655 .637609c-.328767 0-.368618-.448319-.368618-.498132v-1.992528c0-.418431 0-.806974-.358655-1.175592c-.388543-.388543-.886675-.547945-1.364882-.547945c-.816936 0-1.504359 .468244-1.504359 1.125778c0 .298879 .199253 .468244 .458281 .468244c.278954 0 .458281-.199253 .458281-.458281c0-.119552-.049813-.448319-.508095-.458281c.268991-.348692 .757161-.458281 1.075965-.458281c.488169 0 1.05604 .388543 1.05604 1.275218v.368618c-.508095 .029888-1.205479 .059776-1.833126 .358655c-.747198 .33873-.996264 .856787-.996264 1.295143c0 .806974 .966376 1.05604 1.594022 1.05604c.657534 0 1.115816-.398506 1.305106-.86675c.039851 .398506 .308842 .816936 .777086 .816936c.209215 0 .816936-.139477 .816936-.946451zm-1.663761-.508095c0 .946451-.71731 1.285181-1.165629 1.285181c-.488169 0-.896638-.348692-.896638-.846824c0-.547945 .418431-1.374844 2.062267-1.43462v.996264z%27/%3E%0A%3Cpath id=%27g9-43%27 d=%27m4.134496-1.185554c0-.099626-.099626-.099626-.129514-.099626c-.089664 0-.109589 .039851-.129514 .099626c-.288917 .926526-.936488 1.046077-1.305106 1.046077c-.52802 0-1.404732-.428394-1.404732-2.032379c0-1.62391 .816936-2.042341 1.344956-2.042341c.089664 0 .71731 .009963 1.066002 .368618c-.408468 .029888-.468244 .328767-.468244 .458281c0 .259029 .179328 .458281 .458281 .458281c.259029 0 .458281-.169365 .458281-.468244c0-.67746-.757161-1.066002-1.524284-1.066002c-1.24533 0-2.161893 1.075965-2.161893 2.311333c0 1.275218 .986301 2.261519 2.141968 2.261519c1.334994 0 1.653798-1.195517 1.653798-1.295143z%27/%3E%0A%3Cpath id=%27g9-47%27 d=%27m5.250311 0v-.308842c-.697385 0-.777086-.069738-.777086-.557908v-6.047323l-1.43462 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v2.15193c-.288917-.358655-.71731-.617684-1.255293-.617684c-1.175592 0-2.221669 .976339-2.221669 2.261519c0 1.265255 .976339 2.251557 2.11208 2.251557c.637609 0 1.085928-.33873 1.334994-.657534v.657534l1.464508-.109589zm-1.464508-1.175592c0 .179328 0 .199253-.109589 .368618c-.298879 .478207-.747198 .697385-1.175592 .697385c-.448319 0-.806974-.259029-1.046077-.637609c-.259029-.408468-.288917-.976339-.288917-1.384807c0-.368618 .019925-.966376 .308842-1.414695c.209215-.308842 .587796-.637609 1.125778-.637609c.348692 0 .767123 .14944 1.075965 .597758c.109589 .169365 .109589 .18929 .109589 .368618v2.042341z%27/%3E%0A%3Cpath id=%27g9-50%27 d=%27m4.134496-1.185554c0-.099626-.079701-.119552-.129514-.119552c-.089664 0-.109589 .059776-.129514 .139477c-.348692 1.026152-1.24533 1.026152-1.344956 1.026152c-.498132 0-.896638-.298879-1.125778-.667497c-.298879-.478207-.298879-1.135741-.298879-1.494396h2.779577c.219178 0 .249066 0 .249066-.209215c0-.986301-.537983-1.952677-1.783313-1.952677c-1.155666 0-2.072229 1.026152-2.072229 2.271482c0 1.334994 1.046077 2.30137 2.191781 2.30137c1.215442 0 1.663761-1.105853 1.663761-1.295143zm-.657534-1.325031h-2.361146c.059776-1.484433 .896638-1.733499 1.235367-1.733499c1.026152 0 1.125778 1.344956 1.125778 1.733499z%27/%3E%0A%3Cpath id=%27g9-55%27 d=%27m3.556663-6.326276c0-.368618-.368618-.697385-.896638-.697385c-.697385 0-1.544209 .52802-1.544209 1.58406v1.145704h-.787049v.308842h.787049v3.227895c0 .448319-.109589 .448319-.777086 .448319v.308842l1.135741-.029888c.398506 0 .86675 0 1.265255 .029888v-.308842h-.209215c-.737235 0-.757161-.109589-.757161-.468244v-3.20797h1.135741v-.308842h-1.165629v-1.155666c0-.876712 .478207-1.354919 .916563-1.354919c.029888 0 .179328 0 .328767 .069738c-.119552 .039851-.298879 .169365-.298879 .418431c0 .229141 .159402 .428394 .428394 .428394c.288917 0 .438356-.199253 .438356-.438356z%27/%3E%0A%3Cpath id=%27g9-63%27 d=%27m5.330012 0v-.308842c-.518057 0-.767123 0-.777086-.298879v-1.902864c0-.856787 0-1.165629-.308842-1.524284c-.139477-.169365-.468244-.368618-1.046077-.368618c-.836862 0-1.275218 .597758-1.43462 .956413h-.009963v-3.466999l-1.43462 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v5.180573c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888v-.308842c-.667497 0-.777086 0-.777086-.448319v-1.833126c0-1.036115 .707347-1.594022 1.344956-1.594022c.627646 0 .737235 .537983 .737235 1.105853v2.321295c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888z%27/%3E%0A%3Cpath id=%27g9-66%27 d=%27m2.460772 0v-.308842c-.657534 0-.697385-.049813-.697385-.438356v-3.656289l-1.39477 .109589v.308842c.647572 0 .737235 .059776 .737235 .547945v2.67995c0 .448319-.109589 .448319-.777086 .448319v.308842l1.09589-.029888c.348692 0 .697385 .019925 1.036115 .029888zm-.547945-6.017435c0-.268991-.229141-.52802-.52802-.52802c-.33873 0-.537983 .278954-.537983 .52802c0 .268991 .229141 .52802 .52802 .52802c.33873 0 .537983-.278954 .537983-.52802z%27/%3E%0A%3Cpath id=%27g9-77%27 d=%27m5.330012 0v-.308842c-.518057 0-.767123 0-.777086-.298879v-1.902864c0-.856787 0-1.165629-.308842-1.524284c-.139477-.169365-.468244-.368618-1.046077-.368618c-.727273 0-1.195517 .428394-1.474471 1.046077v-1.046077l-1.404732 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v2.669988c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888v-.308842c-.667497 0-.777086 0-.777086-.448319v-1.833126c0-1.036115 .707347-1.594022 1.344956-1.594022c.627646 0 .737235 .537983 .737235 1.105853v2.321295c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888z%27/%3E%0A%3Cpath id=%27g9-81%27 d=%27m4.692403-2.132005c0-1.275218-.996264-2.331258-2.201743-2.331258c-1.24533 0-2.211706 1.085928-2.211706 2.331258c0 1.285181 1.036115 2.241594 2.201743 2.241594c1.205479 0 2.211706-.976339 2.211706-2.241594zm-.826899-.079701c0 .358655 0 .896638-.219178 1.334994c-.219178 .448319-.657534 .737235-1.155666 .737235c-.428394 0-.86675-.209215-1.135741-.667497c-.249066-.438356-.249066-1.046077-.249066-1.404732c0-.388543 0-.926526 .239103-1.364882c.268991-.458281 .737235-.667497 1.135741-.667497c.438356 0 .86675 .219178 1.125778 .647572s.259029 1.006227 .259029 1.384807z%27/%3E%0A%3Cpath id=%27g9-83%27 d=%27m6.216687-4.951432c0-.976339-.986301-1.853051-2.351183-1.853051h-3.516812v.308842h.239103c.767123 0 .787049 .109589 .787049 .468244v5.250311c0 .358655-.019925 .468244-.787049 .468244h-.239103v.308842c.348692-.029888 1.085928-.029888 1.464508-.029888s1.125778 0 1.474471 .029888v-.308842h-.239103c-.767123 0-.787049-.109589-.787049-.468244v-2.371108h1.683686c1.195517 0 2.271482-.806974 2.271482-1.803238zm-1.026152 0c0 .468244 0 1.544209-1.58406 1.544209h-1.374844v-2.689913c0-.328767 .019925-.398506 .488169-.398506h.886675c1.58406 0 1.58406 1.05604 1.58406 1.544209z%27/%3E%0A%3Cpath id=%27g9-91%27 d=%27m5.250311 1.932752v-.308842c-.667497 0-.777086 0-.777086-.448319v-5.579078h-.219178l-.37858 .9066c-.129514-.278954-.537983-.9066-1.334994-.9066c-1.155666 0-2.201743 .966376-2.201743 2.261519c0 1.24533 .966376 2.251557 2.122042 2.251557c.697385 0 1.105853-.428394 1.325031-.71731v1.783313c0 .448319-.109589 .448319-.777086 .448319v.308842l1.115816-.029888l1.125778 .029888zm-1.43462-3.287671c0 .318804-.179328 .597758-.398506 .836862c-.129514 .139477-.448319 .408468-.916563 .408468c-.727273 0-1.334994-.886675-1.334994-2.032379c0-1.185554 .697385-2.012453 1.43462-2.012453c.797011 0 1.215442 .86675 1.215442 1.39477v1.404732z%27/%3E%0A%3Cpath id=%27g9-96%27 d=%27m3.626401-3.795766c0-.318804-.308842-.607721-.737235-.607721c-.727273 0-1.085928 .667497-1.225405 1.09589v-1.09589l-1.384807 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v2.669988c0 .448319-.109589 .448319-.777086 .448319v.308842l1.135741-.029888c.398506 0 .86675 0 1.265255 .029888v-.308842h-.209215c-.737235 0-.757161-.109589-.757161-.468244v-1.534247c0-.986301 .418431-1.872976 1.175592-1.872976c.069738 0 .089664 0 .109589 .009963c-.029888 .009963-.229141 .129514-.229141 .388543c0 .278954 .209215 .428394 .428394 .428394c.179328 0 .428394-.119552 .428394-.438356z%27/%3E%0A%3Cpath id=%27g9-98%27 d=%27m3.58655-1.275218c0-.52802-.298879-.826899-.418431-.946451c-.328767-.318804-.71731-.398506-1.135741-.478207c-.557908-.109589-1.225405-.239103-1.225405-.816936c0-.348692 .259029-.757161 1.115816-.757161c1.09589 0 1.145704 .896638 1.165629 1.205479c.009963 .089664 .119552 .089664 .119552 .089664c.129514 0 .129514-.049813 .129514-.239103v-1.006227c0-.169365 0-.239103-.109589-.239103c-.049813 0-.069738 0-.199253 .119552c-.029888 .039851-.129514 .129514-.169365 .159402c-.37858-.278954-.787049-.278954-.936488-.278954c-1.215442 0-1.594022 .667497-1.594022 1.225405c0 .348692 .159402 .627646 .428394 .846824c.318804 .259029 .597758 .318804 1.315068 .458281c.219178 .039851 1.036115 .199253 1.036115 .916563c0 .508095-.348692 .9066-1.125778 .9066c-.836862 0-1.195517-.56787-1.384807-1.414695c-.029888-.129514-.039851-.169365-.139477-.169365c-.129514 0-.129514 .069738-.129514 .249066v1.315068c0 .169365 0 .239103 .109589 .239103c.049813 0 .059776-.009963 .249066-.199253c.019925-.019925 .019925-.039851 .199253-.229141c.438356 .418431 .886675 .428394 1.09589 .428394c1.145704 0 1.603985-.667497 1.603985-1.384807z%27/%3E%0A%3Cpath id=%27g9-105%27 d=%27m3.307597-1.235367v-.56787h-.249066v.547945c0 .737235-.298879 1.115816-.667497 1.115816c-.667497 0-.667497-.9066-.667497-1.075965v-2.769614h1.424658v-.308842h-1.424658v-1.833126h-.249066c-.009963 .816936-.308842 1.882939-1.285181 1.92279v.219178h.846824v2.749689c0 1.225405 .926526 1.344956 1.285181 1.344956c.707347 0 .986301-.707347 .986301-1.344956z%27/%3E%0A%3Cpath id=%27g9-109%27 d=%27m5.330012 0v-.308842c-.697385 0-.777086-.069738-.777086-.557908v-3.536737l-1.464508 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v1.77335c0 .86675-.478207 1.544209-1.205479 1.544209c-.836862 0-.876712-.468244-.876712-.986301v-3.307597l-1.464508 .109589v.308842c.777086 0 .777086 .029888 .777086 .916563v1.494396c0 .777086 0 1.683686 1.514321 1.683686c.557908 0 .996264-.278954 1.285181-.896638v.896638l1.43462-.109589z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page12%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%27145.078195%27 y=%27-2.49066%27 xlink:href=%27%23g9-83%27/%3E%0A%3Cuse x=%27151.5838%27 y=%27-2.49066%27 xlink:href=%27%23g9-28%27/%3E%0A%3Cuse x=%27156.56512%27 y=%27-2.49066%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27160.440587%27 y=%27-2.49066%27 xlink:href=%27%23g9-63%27/%3E%0A%3Cuse x=%27165.979815%27 y=%27-2.49066%27 xlink:href=%27%23g9-98%27/%3E%0A%3Cuse x=%27169.905092%27 y=%27-2.49066%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27173.779466%27 y=%27-2.49066%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%27179.04562%27 y=%27-2.49066%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%27183.473428%27 y=%27-2.49066%27 xlink:href=%27%23g8-98%27/%3E%0A%3Cuse x=%27187.749062%27 y=%27-2.49066%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%27194.390768%27 y=%27-2.49066%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%27204.906848%27 y=%27-2.49066%27 xlink:href=%27%23g9-28%27/%3E%0A%3Cuse x=%27213.205729%27 y=%27-2.49066%27 xlink:href=%27%23g9-98%27/%3E%0A%3Cuse x=%27217.13101%27 y=%27-2.49066%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%27221.554422%27 y=%27-2.49066%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27228.74745%27 y=%27-2.49066%27 xlink:href=%27%23g9-81%27/%3E%0A%3Cuse x=%27233.72877%27 y=%27-2.49066%27 xlink:href=%27%23g9-55%27/%3E%0A%3Cuse x=%27240.094899%27 y=%27-2.49066%27 xlink:href=%27%23g9-98%27/%3E%0A%3Cuse x=%27244.020179%27 y=%27-2.49066%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%27248.443591%27 y=%27-2.49066%27 xlink:href=%27%23g9-91%27/%3E%0A%3Cuse x=%27253.703865%27 y=%27-2.49066%27 xlink:href=%27%23g9-109%27/%3E%0A%3Cuse x=%27259.243093%27 y=%27-2.49066%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%27263.666505%27 y=%27-2.49066%27 xlink:href=%27%23g9-77%27/%3E%0A%3Cuse x=%27269.205733%27 y=%27-2.49066%27 xlink:href=%27%23g9-43%27/%3E%0A%3Cuse x=%27273.629145%27 y=%27-2.49066%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%27278.052558%27 y=%27-2.49066%27 xlink:href=%27%23g9-98%27/%3E%0A%3Cuse x=%27285.295399%27 y=%27-2.49066%27 xlink:href=%27%23g9-81%27/%3E%0A%3Cuse x=%27290.276719%27 y=%27-2.49066%27 xlink:href=%27%23g9-55%27/%3E%0A%3Cuse x=%27296.642848%27 y=%27-2.49066%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27300.518315%27 y=%27-2.49066%27 xlink:href=%27%23g9-96%27/%3E%0A%3Cuse x=%27304.423669%27 y=%27-2.49066%27 xlink:href=%27%23g9-28%27/%3E%0A%3Cuse x=%27309.40499%27 y=%27-2.49066%27 xlink:href=%27%23g9-77%27/%3E%0A%3Cuse x=%27314.944217%27 y=%27-2.49066%27 xlink:href=%27%23g9-98%27/%3E%0A%3Cuse x=%27318.869498%27 y=%27-2.49066%27 xlink:href=%27%23g9-66%27/%3E%0A%3Cuse x=%27321.639112%27 y=%27-2.49066%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27325.514579%27 y=%27-2.49066%27 xlink:href=%27%23g9-66%27/%3E%0A%3Cuse x=%27328.284193%27 y=%27-2.49066%27 xlink:href=%27%23g9-81%27/%3E%0A%3Cuse x=%27333.265513%27 y=%27-2.49066%27 xlink:href=%27%23g9-77%27/%3E%0A%3Cuse x=%27338.80474%27 y=%27-2.49066%27 xlink:href=%27%23g9-98%27/%3E%0A%3Cuse x=%27346.047582%27 y=%27-2.49066%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27349.923049%27 y=%27-2.49066%27 xlink:href=%27%23g9-63%27/%3E%0A%3Cuse x=%27355.462277%27 y=%27-2.49066%27 xlink:href=%27%23g9-28%27/%3E%0A%3Cuse x=%27360.443597%27 y=%27-2.49066%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27367.636625%27 y=%27-2.49066%27 xlink:href=%27%23g9-98%27/%3E%0A%3Cuse x=%27371.561905%27 y=%27-2.49066%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27375.437372%27 y=%27-2.49066%27 xlink:href=%27%23g9-28%27/%3E%0A%3Cuse x=%27380.418692%27 y=%27-2.49066%27 xlink:href=%27%23g9-96%27/%3E%0A%3Cuse x=%27384.324047%27 y=%27-2.49066%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27391.517075%27 y=%27-2.49066%27 xlink:href=%27%23g9-28%27/%3E%0A%3Cuse x=%27396.498395%27 y=%27-2.49066%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27403.691423%27 y=%27-2.49066%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%27412.275138%27 y=%27-2.49066%27 xlink:href=%27%23g9-28%27/%3E%0A%3Cuse x=%27417.256458%27 y=%27-2.49066%27 xlink:href=%27%23g9-77%27/%3E%0A%3Cuse x=%27422.795686%27 y=%27-2.49066%27 xlink:href=%27%23g9-47%27/%3E%0A%3Cuse x=%27431.652474%27 y=%27-2.49066%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%27436.075887%27 y=%27-2.49066%27 xlink:href=%27%23g9-77%27/%3E%0A%3Cuse x=%27441.615115%27 y=%27-2.49066%27 xlink:href=%27%23g9-47%27/%3E%0A%3Cuse x=%27450.471903%27 y=%27-2.49066%27 xlink:href=%27%23g9-28%27/%3E%0A%3Cuse x=%27455.453224%27 y=%27-2.49066%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27462.646251%27 y=%27-2.49066%27 xlink:href=%27%23g8-98%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\[ \text{Paths}(a,b) = \text{a set of sequences of transitions that start at \(
a \) and end at \( b \)}\]" style="height: 1.5194em; display: block" class="org-latex org-latex-block" />
</p>


<p>
<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27613.000002pt%27 height=%2732.666061pt%27 viewBox=%27-.500002 -32.166059 613.000002 32.666061%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-49%27 d=%27m2.336239-4.435367c0-.188294-.013948-.195268-.209215-.195268c-.446326 .439352-1.080946 .446326-1.366874 .446326v.251059c.167372 0 .627646 0 1.011208-.195268v3.556663c0 .230137 0 .320797-.697385 .320797h-.265006v.251059c.125529-.006974 .983313-.027895 1.241345-.027895c.216189 0 1.094894 .020922 1.248319 .027895v-.251059h-.265006c-.697385 0-.697385-.09066-.697385-.320797v-3.863512z%27/%3E%0A%3Cpath id=%27g0-61%27 d=%27m5.355915-2.343213c.104608 0 .265006 0 .265006-.174346c0-.167372-.167372-.167372-.258032-.167372h-4.616687c-.09066 0-.258032 0-.258032 .167372c0 .174346 .160399 .174346 .265006 .174346h4.60274zm.006974 1.534247c.09066 0 .258032 0 .258032-.167372c0-.174346-.160399-.174346-.265006-.174346h-4.60274c-.104608 0-.265006 0-.265006 .174346c0 .167372 .167372 .167372 .258032 .167372h4.616687z%27/%3E%0A%3Cpath id=%27g6-105%27 d=%27m1.972603-3.108344c0-.119552-.089664-.214197-.219178-.214197c-.139477 0-.303861 .134496-.303861 .298879c0 .139477 .109589 .214197 .214197 .214197c.164384 0 .308842-.14944 .308842-.298879zm.234122 2.391034c0-.069738-.084682-.069738-.104608-.069738c-.084682 0-.089664 .019925-.119552 .11457c-.084682 .273973-.308842 .557908-.557908 .557908c-.11457 0-.14944-.079701-.14944-.18929c0-.104608 .024907-.159402 .064757-.254047c.039851-.099626 .079701-.199253 .104608-.268991c.019925-.044832 .214197-.508095 .283935-.687422c.039851-.099626 .069738-.164384 .069738-.249066c0-.239103-.229141-.438356-.542964-.438356c-.523039 0-.801993 .637609-.801993 .772105c0 .069738 .079701 .069738 .104608 .069738c.084682 0 .089664-.024907 .11457-.099626c.109589-.353674 .348692-.572852 .562889-.572852c.094645 0 .14944 .054795 .14944 .18929c0 .019925 0 .084682-.029888 .179328c-.034869 .089664-.259029 .622665-.328767 .79203c-.034869 .084682-.034869 .094645-.109589 .26401c-.024907 .069738-.054795 .139477-.054795 .224159c0 .259029 .244085 .438356 .542964 .438356c.523039 0 .801993-.647572 .801993-.772105z%27/%3E%0A%3Cpath id=%27g3-88%27 d=%27m12.612702 13.947696l1.205479-3.188045h-.249066c-.388543 1.036115-1.444583 1.713574-2.590286 2.012453c-.209215 .049813-1.185554 .308842-3.098381 .308842h-6.007472l5.070984-5.947696c.069738-.079701 .089664-.109589 .089664-.159402c0-.019925 0-.049813-.069738-.14944l-4.64259-6.346202h5.459527c1.334994 0 2.241594 .139477 2.331258 .159402c.537983 .079701 1.404732 .249066 2.191781 .747198c.249066 .159402 .926526 .607721 1.265255 1.414695h.249066l-1.205479-2.799502h-11.775841c-.229141 0-.239103 .009963-.268991 .069738c-.009963 .029888-.009963 .219178-.009963 .328767l5.270237 7.212951l-5.160648 6.047323c-.099626 .119552-.099626 .169365-.099626 .179328c0 .109589 .089664 .109589 .268991 .109589h11.775841z%27/%3E%0A%3Cpath id=%27g3-89%27 d=%27m12.164384 13.947696v-.537983c-1.325031 0-1.633873-.458281-1.633873-1.09589v-10.67995c0-.647572 .318804-1.09589 1.633873-1.09589v-.537983h-11.606476v.537983c1.325031 0 1.633873 .458281 1.633873 1.09589v10.67995c0 .647572-.318804 1.09589-1.633873 1.09589v.537983h4.79203v-.537983c-1.325031 0-1.633873-.458281-1.633873-1.09589v-11.775841h5.290162v11.775841c0 .647572-.318804 1.09589-1.633873 1.09589v.537983h4.79203z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g1-61%27 d=%27m6.844334-3.257783c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.967621c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h5.947696zm.009963 1.932752c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.33873-.199253h-5.947696c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.967621z%27/%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3Cpath id=%27g7-83%27 d=%27m4.951432-4.811955c0-.034869-.020922-.09066-.09066-.09066c-.041843 0-.048817 .006974-.139477 .097634l-.341719 .397509c-.265006-.369614-.704359-.495143-1.129763-.495143c-.983313 0-1.855044 .795019-1.855044 1.597011c0 .104608 .020922 .383562 .230137 .641594c.237111 .278954 .495143 .341719 .969365 .4533c.139477 .034869 .488169 .111582 .592777 .139477c.223163 .055791 .648568 .209215 .648568 .732254c0 .564882-.592777 1.227397-1.387796 1.227397c-.613699 0-1.352927-.216189-1.352927-.990286c0-.069738 .013948-.223163 .041843-.348692c.006974-.027895 .006974-.034869 .006974-.041843c0-.09066-.083686-.09066-.111582-.09066c-.097634 0-.104608 .013948-.132503 .139477l-.355666 1.39477c-.006974 .027895-.020922 .069738-.020922 .104608c0 .041843 .027895 .083686 .097634 .083686c.041843 0 .048817-.006974 .139477-.097634c.076712-.083686 .258032-.306849 .334745-.390535c.369614 .404483 .913574 .488169 1.332005 .488169c1.053051 0 1.903861-.9066 1.903861-1.729514c0-.306849-.125529-.585803-.278954-.746202c-.244085-.251059-.348692-.278954-1.248319-.488169c-.146451-.034869-.376588-.09066-.439352-.111582c-.174346-.062765-.467248-.237111-.467248-.63462c0-.550934 .620672-1.108842 1.345953-1.108842c.753176 0 1.115816 .425405 1.115816 1.08792c0 .09066-.027895 .251059-.027895 .313823c0 .097634 .083686 .097634 .118555 .097634c.104608 0 .111582-.034869 .139477-.153425l.36264-1.478456z%27/%3E%0A%3Cpath id=%27g7-105%27 d=%27m2.259527-4.358655c0-.111582-.083686-.265006-.278954-.265006c-.188294 0-.390535 .18132-.390535 .383562c0 .118555 .09066 .265006 .278954 .265006c.202242 0 .390535-.195268 .390535-.383562zm-1.422665 3.542715c-.027895 .09066-.062765 .174346-.062765 .292902c0 .327771 .278954 .592777 .662516 .592777c.697385 0 1.004234-.962391 1.004234-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .041843-.132503 .118555c-.160399 .557908-.467248 .843836-.739228 .843836c-.139477 0-.174346-.09066-.174346-.244085c0-.160399 .048817-.292902 .111582-.446326c.069738-.188294 .146451-.376588 .223163-.557908c.062765-.167372 .313823-.801993 .341719-.885679c.020922-.069738 .041843-.153425 .041843-.223163c0-.327771-.278954-.592777-.662516-.592777c-.690411 0-1.011208 .948443-1.011208 1.066999c0 .09066 .097634 .09066 .118555 .09066c.097634 0 .104608-.034869 .125529-.111582c.18132-.599751 .488169-.850809 .746202-.850809c.111582 0 .174346 .055791 .174346 .244085c0 .160399-.041843 .265006-.216189 .697385l-.439352 1.12279z%27/%3E%0A%3Cpath id=%27g7-106%27 d=%27m3.061519-4.358655c0-.118555-.09066-.265006-.278954-.265006c-.202242 0-.390535 .195268-.390535 .383562c0 .111582 .083686 .265006 .278954 .265006c.188294 0 .390535-.18132 .390535-.383562zm-1.478456 4.700374c-.118555 .481196-.488169 .885679-.899626 .885679c-.09066 0-.174346-.013948-.251059-.041843c.18132-.083686 .237111-.251059 .237111-.355666c0-.167372-.132503-.258032-.27198-.258032c-.216189 0-.397509 .188294-.397509 .411457c0 .265006 .27198 .439352 .690411 .439352s1.234371-.251059 1.45056-1.101868l.627646-2.496638c.020922-.076712 .034869-.139477 .034869-.244085c0-.383562-.327771-.655542-.746202-.655542c-.774097 0-1.220423 .969365-1.220423 1.066999c0 .09066 .097634 .09066 .118555 .09066c.083686 0 .09066-.020922 .139477-.125529c.174346-.404483 .536986-.836862 .941469-.836862c.174346 0 .237111 .118555 .237111 .341719c0 .076712-.013948 .174346-.020922 .209215l-.669489 2.670984z%27/%3E%0A%3Cpath id=%27g7-110%27 d=%27m.850809-.439352c-.027895 .09066-.069738 .265006-.069738 .285928c0 .153425 .125529 .223163 .237111 .223163c.125529 0 .237111-.09066 .27198-.153425s.09066-.285928 .125529-.432379c.034869-.132503 .111582-.4533 .153425-.627646c.041843-.153425 .083686-.306849 .118555-.467248c.076712-.285928 .09066-.341719 .292902-.627646c.195268-.278954 .523039-.641594 1.046077-.641594c.404483 0 .411457 .355666 .411457 .488169c0 .418431-.299875 1.192528-.411457 1.48543c-.076712 .195268-.104608 .258032-.104608 .376588c0 .369614 .306849 .599751 .662516 .599751c.697385 0 1.004234-.962391 1.004234-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .041843-.132503 .118555c-.160399 .557908-.460274 .843836-.739228 .843836c-.146451 0-.174346-.097634-.174346-.244085c0-.160399 .034869-.251059 .160399-.564882c.083686-.216189 .369614-.955417 .369614-1.345953c0-.676463-.536986-.795019-.9066-.795019c-.578829 0-.969365 .355666-1.17858 .63462c-.048817-.481196-.460274-.63462-.746202-.63462c-.299875 0-.460274 .216189-.550934 .376588c-.153425 .258032-.251059 .655542-.251059 .690411c0 .09066 .097634 .09066 .118555 .09066c.097634 0 .104608-.020922 .153425-.209215c.104608-.411457 .237111-.753176 .509091-.753176c.18132 0 .230137 .153425 .230137 .341719c0 .132503-.062765 .390535-.111582 .578829s-.118555 .474222-.153425 .627646l-.223163 .892653z%27/%3E%0A%3Cpath id=%27g9-28%27 d=%27m4.811955-.886675v-.557908h-.249066v.557908c0 .577833-.249066 .637609-.358655 .637609c-.328767 0-.368618-.448319-.368618-.498132v-1.992528c0-.418431 0-.806974-.358655-1.175592c-.388543-.388543-.886675-.547945-1.364882-.547945c-.816936 0-1.504359 .468244-1.504359 1.125778c0 .298879 .199253 .468244 .458281 .468244c.278954 0 .458281-.199253 .458281-.458281c0-.119552-.049813-.448319-.508095-.458281c.268991-.348692 .757161-.458281 1.075965-.458281c.488169 0 1.05604 .388543 1.05604 1.275218v.368618c-.508095 .029888-1.205479 .059776-1.833126 .358655c-.747198 .33873-.996264 .856787-.996264 1.295143c0 .806974 .966376 1.05604 1.594022 1.05604c.657534 0 1.115816-.398506 1.305106-.86675c.039851 .398506 .308842 .816936 .777086 .816936c.209215 0 .816936-.139477 .816936-.946451zm-1.663761-.508095c0 .946451-.71731 1.285181-1.165629 1.285181c-.488169 0-.896638-.348692-.896638-.846824c0-.547945 .418431-1.374844 2.062267-1.43462v.996264z%27/%3E%0A%3Cpath id=%27g9-50%27 d=%27m4.134496-1.185554c0-.099626-.079701-.119552-.129514-.119552c-.089664 0-.109589 .059776-.129514 .139477c-.348692 1.026152-1.24533 1.026152-1.344956 1.026152c-.498132 0-.896638-.298879-1.125778-.667497c-.298879-.478207-.298879-1.135741-.298879-1.494396h2.779577c.219178 0 .249066 0 .249066-.209215c0-.986301-.537983-1.952677-1.783313-1.952677c-1.155666 0-2.072229 1.026152-2.072229 2.271482c0 1.334994 1.046077 2.30137 2.191781 2.30137c1.215442 0 1.663761-1.105853 1.663761-1.295143zm-.657534-1.325031h-2.361146c.059776-1.484433 .896638-1.733499 1.235367-1.733499c1.026152 0 1.125778 1.344956 1.125778 1.733499z%27/%3E%0A%3Cpath id=%27g9-59%27 d=%27m4.83188-4.024907c0-.169365-.119552-.488169-.508095-.488169c-.199253 0-.637609 .059776-1.05604 .468244c-.418431-.328767-.836862-.358655-1.05604-.358655c-.926526 0-1.613948 .687422-1.613948 1.454545c0 .438356 .219178 .816936 .468244 1.026152c-.129514 .14944-.308842 .478207-.308842 .826899c0 .308842 .129514 .687422 .438356 .886675c-.597758 .169365-.916563 .597758-.916563 .996264c0 .71731 .986301 1.265255 2.201743 1.265255c1.175592 0 2.211706-.508095 2.211706-1.285181c0-.348692-.139477-.856787-.647572-1.135741c-.52802-.278954-1.105853-.278954-1.713574-.278954c-.249066 0-.67746 0-.747198-.009963c-.318804-.039851-.52802-.348692-.52802-.667497c0-.039851 0-.268991 .169365-.468244c.388543 .278954 .797011 .308842 .986301 .308842c.926526 0 1.613948-.687422 1.613948-1.454545c0-.368618-.159402-.737235-.408468-.966376c.358655-.33873 .71731-.388543 .896638-.388543c0 0 .069738 0 .099626 .009963c-.109589 .039851-.159402 .14944-.159402 .268991c0 .169365 .129514 .288917 .288917 .288917c.099626 0 .288917-.069738 .288917-.298879zm-1.753425 1.075965c0 .268991-.009963 .587796-.159402 .836862c-.079701 .119552-.308842 .398506-.707347 .398506c-.86675 0-.86675-.996264-.86675-1.225405c0-.268991 .009963-.587796 .159402-.836862c.079701-.119552 .308842-.398506 .707347-.398506c.86675 0 .86675 .996264 .86675 1.225405zm1.09589 3.73599c0 .537983-.707347 1.036115-1.683686 1.036115c-1.006227 0-1.693649-.508095-1.693649-1.036115c0-.458281 .37858-.826899 .816936-.856787h.587796c.856787 0 1.972603 0 1.972603 .856787z%27/%3E%0A%3Cpath id=%27g9-63%27 d=%27m5.330012 0v-.308842c-.518057 0-.767123 0-.777086-.298879v-1.902864c0-.856787 0-1.165629-.308842-1.524284c-.139477-.169365-.468244-.368618-1.046077-.368618c-.836862 0-1.275218 .597758-1.43462 .956413h-.009963v-3.466999l-1.43462 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v5.180573c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888v-.308842c-.667497 0-.777086 0-.777086-.448319v-1.833126c0-1.036115 .707347-1.594022 1.344956-1.594022c.627646 0 .737235 .537983 .737235 1.105853v2.321295c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888z%27/%3E%0A%3Cpath id=%27g9-66%27 d=%27m2.460772 0v-.308842c-.657534 0-.697385-.049813-.697385-.438356v-3.656289l-1.39477 .109589v.308842c.647572 0 .737235 .059776 .737235 .547945v2.67995c0 .448319-.109589 .448319-.777086 .448319v.308842l1.09589-.029888c.348692 0 .697385 .019925 1.036115 .029888zm-.547945-6.017435c0-.268991-.229141-.52802-.52802-.52802c-.33873 0-.537983 .278954-.537983 .52802c0 .268991 .229141 .52802 .52802 .52802c.33873 0 .537983-.278954 .537983-.52802z%27/%3E%0A%3Cpath id=%27g9-83%27 d=%27m6.216687-4.951432c0-.976339-.986301-1.853051-2.351183-1.853051h-3.516812v.308842h.239103c.767123 0 .787049 .109589 .787049 .468244v5.250311c0 .358655-.019925 .468244-.787049 .468244h-.239103v.308842c.348692-.029888 1.085928-.029888 1.464508-.029888s1.125778 0 1.474471 .029888v-.308842h-.239103c-.767123 0-.787049-.109589-.787049-.468244v-2.371108h1.683686c1.195517 0 2.271482-.806974 2.271482-1.803238zm-1.026152 0c0 .468244 0 1.544209-1.58406 1.544209h-1.374844v-2.689913c0-.328767 .019925-.398506 .488169-.398506h.886675c1.58406 0 1.58406 1.05604 1.58406 1.544209z%27/%3E%0A%3Cpath id=%27g9-98%27 d=%27m3.58655-1.275218c0-.52802-.298879-.826899-.418431-.946451c-.328767-.318804-.71731-.398506-1.135741-.478207c-.557908-.109589-1.225405-.239103-1.225405-.816936c0-.348692 .259029-.757161 1.115816-.757161c1.09589 0 1.145704 .896638 1.165629 1.205479c.009963 .089664 .119552 .089664 .119552 .089664c.129514 0 .129514-.049813 .129514-.239103v-1.006227c0-.169365 0-.239103-.109589-.239103c-.049813 0-.069738 0-.199253 .119552c-.029888 .039851-.129514 .129514-.169365 .159402c-.37858-.278954-.787049-.278954-.936488-.278954c-1.215442 0-1.594022 .667497-1.594022 1.225405c0 .348692 .159402 .627646 .428394 .846824c.318804 .259029 .597758 .318804 1.315068 .458281c.219178 .039851 1.036115 .199253 1.036115 .916563c0 .508095-.348692 .9066-1.125778 .9066c-.836862 0-1.195517-.56787-1.384807-1.414695c-.029888-.129514-.039851-.169365-.139477-.169365c-.129514 0-.129514 .069738-.129514 .249066v1.315068c0 .169365 0 .239103 .109589 .239103c.049813 0 .059776-.009963 .249066-.199253c.019925-.019925 .019925-.039851 .199253-.229141c.438356 .418431 .886675 .428394 1.09589 .428394c1.145704 0 1.603985-.667497 1.603985-1.384807z%27/%3E%0A%3Cpath id=%27g9-105%27 d=%27m3.307597-1.235367v-.56787h-.249066v.547945c0 .737235-.298879 1.115816-.667497 1.115816c-.667497 0-.667497-.9066-.667497-1.075965v-2.769614h1.424658v-.308842h-1.424658v-1.833126h-.249066c-.009963 .816936-.308842 1.882939-1.285181 1.92279v.219178h.846824v2.749689c0 1.225405 .926526 1.344956 1.285181 1.344956c.707347 0 .986301-.707347 .986301-1.344956z%27/%3E%0A%3Cpath id=%27g9-113%27 d=%27m10.052304-6.495641v-.308842c-.298879 .019925-.607721 .029888-.9066 .029888l-1.185554-.029888v.308842c.667497 .009963 .86675 .33873 .86675 .52802c0 .059776-.029888 .139477-.049813 .199253l-1.494396 4.60274l-1.594022-4.881694c-.009963-.039851-.029888-.099626-.029888-.14944c0-.298879 .577833-.298879 .836862-.298879v-.308842c-.358655 .029888-1.036115 .029888-1.414695 .029888l-1.215442-.029888v.308842c.56787 0 .777086 0 .896638 .358655l.219178 .697385l-1.384807 4.273973l-1.603985-4.901619c-.009963-.029888-.019925-.099626-.019925-.129514c0-.298879 .577833-.298879 .836862-.298879v-.308842c-.358655 .029888-1.036115 .029888-1.414695 .029888l-1.215442-.029888v.308842c.747198 0 .787049 .049813 .9066 .418431l1.992528 6.107098c.029888 .089664 .059776 .18929 .18929 .18929c.139477 0 .159402-.069738 .199253-.199253l1.643836-5.061021l1.653798 5.070984c.029888 .089664 .059776 .18929 .18929 .18929c.139477 0 .159402-.069738 .199253-.199253l1.902864-5.84807c.179328-.56787 .607721-.667497 .996264-.667497z%27/%3E%0A%3Cpath id=%27g9-114%27 d=%27m7.003736-3.985056v-.308842c-.219178 .019925-.508095 .029888-.727273 .029888l-.926526-.029888v.308842c.358655 .009963 .577833 .18929 .577833 .478207c0 .059776 0 .079701-.049813 .209215l-.9066 2.550436l-.986301-2.779577c-.039851-.119552-.049813-.139477-.049813-.18929c0-.268991 .388543-.268991 .587796-.268991v-.308842l-1.036115 .029888c-.298879 0-.587796-.009963-.886675-.029888v.308842c.368618 0 .52802 .019925 .627646 .14944c.049813 .059776 .159402 .358655 .229141 .547945l-.856787 2.410959l-.946451-2.660025c-.049813-.119552-.049813-.139477-.049813-.179328c0-.268991 .388543-.268991 .587796-.268991v-.308842l-1.085928 .029888l-.926526-.029888v.308842c.498132 0 .617684 .029888 .737235 .348692l1.255293 3.526775c.049813 .139477 .079701 .219178 .209215 .219178s.14944-.059776 .199253-.199253l1.006227-2.819427l1.016189 2.82939c.039851 .109589 .069738 .18929 .199253 .18929s.159402-.089664 .199253-.18929l1.165629-3.267746c.179328-.498132 .488169-.627646 .836862-.637609z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page13%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%27202.725452%27 y=%27-14.106844%27 xlink:href=%27%23g9-113%27/%3E%0A%3Cuse x=%27212.140145%27 y=%27-14.106844%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%27216.563557%27 y=%27-14.106844%27 xlink:href=%27%23g9-66%27/%3E%0A%3Cuse x=%27219.333171%27 y=%27-14.106844%27 xlink:href=%27%23g9-59%27/%3E%0A%3Cuse x=%27224.314491%27 y=%27-14.106844%27 xlink:href=%27%23g9-63%27/%3E%0A%3Cuse x=%27229.574766%27 y=%27-14.106844%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27233.45023%27 y=%27-11.556425%27 xlink:href=%27%23g7-83%27/%3E%0A%3Cuse x=%27239.221663%27 y=%27-14.106844%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27243.096036%27 y=%27-14.106844%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%27248.36219%27 y=%27-14.106844%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%27252.789998%27 y=%27-14.106844%27 xlink:href=%27%23g8-98%27/%3E%0A%3Cuse x=%27257.065633%27 y=%27-14.106844%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%27263.707339%27 y=%27-14.106844%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%27274.223419%27 y=%27-23.571413%27 xlink:href=%27%23g3-88%27/%3E%0A%3Cuse x=%27280.009324%27 y=%27-2.352278%27 xlink:href=%27%23g7-105%27/%3E%0A%3Cuse x=%27293.127352%27 y=%27-26.670904%27 xlink:href=%27%23g7-110%27/%3E%0A%3Cuse x=%27298.052215%27 y=%27-25.67464%27 xlink:href=%27%23g6-105%27/%3E%0A%3Cuse x=%27290.802756%27 y=%27-23.571413%27 xlink:href=%27%23g3-89%27/%3E%0A%3Cuse x=%27290.274327%27 y=%27-2.352278%27 xlink:href=%27%23g7-106%27/%3E%0A%3Cuse x=%27293.974016%27 y=%27-2.352278%27 xlink:href=%27%23g0-61%27/%3E%0A%3Cuse x=%27300.09%27 y=%27-2.352278%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27305.721634%27 y=%27-14.106844%27 xlink:href=%27%23g9-114%27/%3E%0A%3Cuse x=%27312.635707%27 y=%27-14.106844%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%27317.059119%27 y=%27-14.106844%27 xlink:href=%27%23g9-66%27/%3E%0A%3Cuse x=%27319.828733%27 y=%27-14.106844%27 xlink:href=%27%23g9-59%27/%3E%0A%3Cuse x=%27324.810053%27 y=%27-14.106844%27 xlink:href=%27%23g9-63%27/%3E%0A%3Cuse x=%27330.070328%27 y=%27-14.106844%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27333.945795%27 y=%27-11.556425%27 xlink:href=%27%23g7-83%27/%3E%0A%3Cuse x=%27339.717227%27 y=%27-14.106844%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27343.591601%27 y=%27-14.106844%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27347.465975%27 y=%27-14.106844%27 xlink:href=%27%23g9-83%27/%3E%0A%3Cuse x=%27353.97158%27 y=%27-14.106844%27 xlink:href=%27%23g9-28%27/%3E%0A%3Cuse x=%27358.9529%27 y=%27-14.106844%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%27362.828367%27 y=%27-14.106844%27 xlink:href=%27%23g9-63%27/%3E%0A%3Cuse x=%27368.367595%27 y=%27-14.106844%27 xlink:href=%27%23g9-98%27/%3E%0A%3Cuse x=%27372.292872%27 y=%27-14.106844%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27376.167246%27 y=%27-14.106844%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%27381.4334%27 y=%27-14.106844%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%27385.861208%27 y=%27-14.106844%27 xlink:href=%27%23g8-98%27/%3E%0A%3Cuse x=%27390.136842%27 y=%27-14.106844%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%27394.011216%27 y=%27-12.612463%27 xlink:href=%27%23g7-105%27/%3E%0A%3Cuse x=%27397.328063%27 y=%27-14.106844%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%27401.202436%27 y=%27-12.612463%27 xlink:href=%27%23g7-106%27/%3E%0A%3Cuse x=%27405.400256%27 y=%27-14.106844%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\[ \text{Weight}_S(a,b) = \sum_i \prod_{j=1}^{n_i}
\text{weight}_S((\text{Paths}(a,b)_{i})_{j})\]" style="height: 3.2133em; display: block" class="org-latex org-latex-block" />
</p>


<p>
Through this very general framework that looks a lot like simply computing the
&ldquo;weighted sum&rdquo; of a subgraph, we can implement diverse algorithms.
</p>
</div>
</div>
<div id="outline-container-org210242a" class="outline-2">
<h2 id="org210242a"><span class="section-number-2">3.</span> Implementation of edit distance.</h2>
<div class="outline-text-2" id="text-3">
<p>
Let&rsquo;s write a concrete implementation of this &ldquo;algebraic dynamic programming&rdquo;
idea in julia. Again, we will be using the string editing distance as a toy
problem. Here are the definitions of the string operations:
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">abstract type</span> <span style="color: #531ab6; font-weight: bold;">Op</span> <span style="color: #005e8b; font-weight: bold;">end</span>
<span style="color: #005e8b; font-weight: bold;">struct</span> <span style="color: #531ab6; font-weight: bold;">Ins</span> &lt;: <span style="color: #531ab6; font-weight: bold;">Op</span>
    c::<span style="color: #531ab6; font-weight: bold;">Char</span>
<span style="color: #005e8b; font-weight: bold;">end</span>
<span style="color: #005e8b; font-weight: bold;">struct</span> <span style="color: #531ab6; font-weight: bold;">Del</span> &lt;: <span style="color: #531ab6; font-weight: bold;">Op</span>
    c::<span style="color: #531ab6; font-weight: bold;">Char</span>
<span style="color: #005e8b; font-weight: bold;">end</span>
<span style="color: #005e8b; font-weight: bold;">struct</span> <span style="color: #531ab6; font-weight: bold;">Keep</span> &lt;: <span style="color: #531ab6; font-weight: bold;">Op</span>
    c::<span style="color: #531ab6; font-weight: bold;">Char</span>
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<p>
In many cases, it is complicated (and expensive!) to enumerate all possible
paths from source to destination, but in this specific case, the graph generated
by the edit distance problem is easy to write down.
</p>

<p>
Here, we compute <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2759.21453pt%27 height=%2711.022402pt%27 viewBox=%27-.500002 -7.971982 59.21453 11.022402%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3Cpath id=%27g7-83%27 d=%27m4.951432-4.811955c0-.034869-.020922-.09066-.09066-.09066c-.041843 0-.048817 .006974-.139477 .097634l-.341719 .397509c-.265006-.369614-.704359-.495143-1.129763-.495143c-.983313 0-1.855044 .795019-1.855044 1.597011c0 .104608 .020922 .383562 .230137 .641594c.237111 .278954 .495143 .341719 .969365 .4533c.139477 .034869 .488169 .111582 .592777 .139477c.223163 .055791 .648568 .209215 .648568 .732254c0 .564882-.592777 1.227397-1.387796 1.227397c-.613699 0-1.352927-.216189-1.352927-.990286c0-.069738 .013948-.223163 .041843-.348692c.006974-.027895 .006974-.034869 .006974-.041843c0-.09066-.083686-.09066-.111582-.09066c-.097634 0-.104608 .013948-.132503 .139477l-.355666 1.39477c-.006974 .027895-.020922 .069738-.020922 .104608c0 .041843 .027895 .083686 .097634 .083686c.041843 0 .048817-.006974 .139477-.097634c.076712-.083686 .258032-.306849 .334745-.390535c.369614 .404483 .913574 .488169 1.332005 .488169c1.053051 0 1.903861-.9066 1.903861-1.729514c0-.306849-.125529-.585803-.278954-.746202c-.244085-.251059-.348692-.278954-1.248319-.488169c-.146451-.034869-.376588-.09066-.439352-.111582c-.174346-.062765-.467248-.237111-.467248-.63462c0-.550934 .620672-1.108842 1.345953-1.108842c.753176 0 1.115816 .425405 1.115816 1.08792c0 .09066-.027895 .251059-.027895 .313823c0 .097634 .083686 .097634 .118555 .097634c.104608 0 .111582-.034869 .139477-.153425l.36264-1.478456z%27/%3E%0A%3Cpath id=%27g9-50%27 d=%27m4.134496-1.185554c0-.099626-.079701-.119552-.129514-.119552c-.089664 0-.109589 .059776-.129514 .139477c-.348692 1.026152-1.24533 1.026152-1.344956 1.026152c-.498132 0-.896638-.298879-1.125778-.667497c-.298879-.478207-.298879-1.135741-.298879-1.494396h2.779577c.219178 0 .249066 0 .249066-.209215c0-.986301-.537983-1.952677-1.783313-1.952677c-1.155666 0-2.072229 1.026152-2.072229 2.271482c0 1.334994 1.046077 2.30137 2.191781 2.30137c1.215442 0 1.663761-1.105853 1.663761-1.295143zm-.657534-1.325031h-2.361146c.059776-1.484433 .896638-1.733499 1.235367-1.733499c1.026152 0 1.125778 1.344956 1.125778 1.733499z%27/%3E%0A%3Cpath id=%27g9-59%27 d=%27m4.83188-4.024907c0-.169365-.119552-.488169-.508095-.488169c-.199253 0-.637609 .059776-1.05604 .468244c-.418431-.328767-.836862-.358655-1.05604-.358655c-.926526 0-1.613948 .687422-1.613948 1.454545c0 .438356 .219178 .816936 .468244 1.026152c-.129514 .14944-.308842 .478207-.308842 .826899c0 .308842 .129514 .687422 .438356 .886675c-.597758 .169365-.916563 .597758-.916563 .996264c0 .71731 .986301 1.265255 2.201743 1.265255c1.175592 0 2.211706-.508095 2.211706-1.285181c0-.348692-.139477-.856787-.647572-1.135741c-.52802-.278954-1.105853-.278954-1.713574-.278954c-.249066 0-.67746 0-.747198-.009963c-.318804-.039851-.52802-.348692-.52802-.667497c0-.039851 0-.268991 .169365-.468244c.388543 .278954 .797011 .308842 .986301 .308842c.926526 0 1.613948-.687422 1.613948-1.454545c0-.368618-.159402-.737235-.408468-.966376c.358655-.33873 .71731-.388543 .896638-.388543c0 0 .069738 0 .099626 .009963c-.109589 .039851-.159402 .14944-.159402 .268991c0 .169365 .129514 .288917 .288917 .288917c.099626 0 .288917-.069738 .288917-.298879zm-1.753425 1.075965c0 .268991-.009963 .587796-.159402 .836862c-.079701 .119552-.308842 .398506-.707347 .398506c-.86675 0-.86675-.996264-.86675-1.225405c0-.268991 .009963-.587796 .159402-.836862c.079701-.119552 .308842-.398506 .707347-.398506c.86675 0 .86675 .996264 .86675 1.225405zm1.09589 3.73599c0 .537983-.707347 1.036115-1.683686 1.036115c-1.006227 0-1.693649-.508095-1.693649-1.036115c0-.458281 .37858-.826899 .816936-.856787h.587796c.856787 0 1.972603 0 1.972603 .856787z%27/%3E%0A%3Cpath id=%27g9-63%27 d=%27m5.330012 0v-.308842c-.518057 0-.767123 0-.777086-.298879v-1.902864c0-.856787 0-1.165629-.308842-1.524284c-.139477-.169365-.468244-.368618-1.046077-.368618c-.836862 0-1.275218 .597758-1.43462 .956413h-.009963v-3.466999l-1.43462 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v5.180573c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888v-.308842c-.667497 0-.777086 0-.777086-.448319v-1.833126c0-1.036115 .707347-1.594022 1.344956-1.594022c.627646 0 .737235 .537983 .737235 1.105853v2.321295c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888z%27/%3E%0A%3Cpath id=%27g9-66%27 d=%27m2.460772 0v-.308842c-.657534 0-.697385-.049813-.697385-.438356v-3.656289l-1.39477 .109589v.308842c.647572 0 .737235 .059776 .737235 .547945v2.67995c0 .448319-.109589 .448319-.777086 .448319v.308842l1.09589-.029888c.348692 0 .697385 .019925 1.036115 .029888zm-.547945-6.017435c0-.268991-.229141-.52802-.52802-.52802c-.33873 0-.537983 .278954-.537983 .52802c0 .268991 .229141 .52802 .52802 .52802c.33873 0 .537983-.278954 .537983-.52802z%27/%3E%0A%3Cpath id=%27g9-105%27 d=%27m3.307597-1.235367v-.56787h-.249066v.547945c0 .737235-.298879 1.115816-.667497 1.115816c-.667497 0-.667497-.9066-.667497-1.075965v-2.769614h1.424658v-.308842h-1.424658v-1.833126h-.249066c-.009963 .816936-.308842 1.882939-1.285181 1.92279v.219178h.846824v2.749689c0 1.225405 .926526 1.344956 1.285181 1.344956c.707347 0 .986301-.707347 .986301-1.344956z%27/%3E%0A%3Cpath id=%27g9-113%27 d=%27m10.052304-6.495641v-.308842c-.298879 .019925-.607721 .029888-.9066 .029888l-1.185554-.029888v.308842c.667497 .009963 .86675 .33873 .86675 .52802c0 .059776-.029888 .139477-.049813 .199253l-1.494396 4.60274l-1.594022-4.881694c-.009963-.039851-.029888-.099626-.029888-.14944c0-.298879 .577833-.298879 .836862-.298879v-.308842c-.358655 .029888-1.036115 .029888-1.414695 .029888l-1.215442-.029888v.308842c.56787 0 .777086 0 .896638 .358655l.219178 .697385l-1.384807 4.273973l-1.603985-4.901619c-.009963-.029888-.019925-.099626-.019925-.129514c0-.298879 .577833-.298879 .836862-.298879v-.308842c-.358655 .029888-1.036115 .029888-1.414695 .029888l-1.215442-.029888v.308842c.747198 0 .787049 .049813 .9066 .418431l1.992528 6.107098c.029888 .089664 .059776 .18929 .18929 .18929c.139477 0 .159402-.069738 .199253-.199253l1.643836-5.061021l1.653798 5.070984c.029888 .089664 .059776 .18929 .18929 .18929c.139477 0 .159402-.069738 .199253-.199253l1.902864-5.84807c.179328-.56787 .607721-.667497 .996264-.667497z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page14%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g9-113%27/%3E%0A%3Cuse x=%279.414693%27 y=%270%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%2713.838105%27 y=%270%27 xlink:href=%27%23g9-66%27/%3E%0A%3Cuse x=%2716.607719%27 y=%270%27 xlink:href=%27%23g9-59%27/%3E%0A%3Cuse x=%2721.589039%27 y=%270%27 xlink:href=%27%23g9-63%27/%3E%0A%3Cuse x=%2726.849314%27 y=%270%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%2730.724778%27 y=%272.550418%27 xlink:href=%27%23g7-83%27/%3E%0A%3Cuse x=%2736.496211%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2740.370585%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%2745.636739%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2750.064547%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3Cuse x=%2754.340181%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( \text{Weight}_S(a,b) \)" style="height: 1.0842em; vertical-align: -0.3001em; display: inline-block" class="org-latex org-latex-inline" /> recursively by using the weight of
sub strings.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">Note: for this function to be efficient, you would ideally use
</span><span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">memoisation. I don't here, because there is no builting way to do
</span><span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">this.
</span><span style="color: #005e8b; font-weight: bold;">function</span> <span style="color: #8f0075;">Weight</span>(T::<span style="color: #531ab6; font-weight: bold;">Type</span>{&lt;:<span style="color: #531ab6; font-weight: bold;">Semiring</span>}, s1, s2)
    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">We will be computing a sum, so it makes sense to initialize this
</span>    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">with zero. Notice we pass the semiring type to the zero
</span>    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">function. This is not your garden variety zero, but the one from
</span>    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">your chosen semiring!
</span>    o = zero(T)

    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">From a modification that transforms s1[2:end] into s2, we can
</span>    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">create a transformation that transforms s1 into s2 by appending
</span>    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">Del(s1[1]) at the start of the transformations sequence.
</span>    <span style="color: #005e8b; font-weight: bold;">if</span> length(s1) != 0
        o += weight(T, Del(s1[1])) * Weight(T, s1[2:<span style="color: #005e8b; font-weight: bold;">end</span>], s2)
    <span style="color: #005e8b; font-weight: bold;">end</span>

    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">Same thing, but for insertion.
</span>    <span style="color: #005e8b; font-weight: bold;">if</span> length(s2) != 0
        o += weight(T, Ins(s2[1])) * Weight(T, s1, s2[2:<span style="color: #005e8b; font-weight: bold;">end</span>])
    <span style="color: #005e8b; font-weight: bold;">end</span>

    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">When the first character of both strings are the same, we can
</span>    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">keep it by adding Keep(c) at the front of the operations
</span>    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">sequnce.
</span>    <span style="color: #005e8b; font-weight: bold;">if</span> length(s1) != 0 &amp;&amp; length(s2) != 0 &amp;&amp; s1[1] == s2[1]
        o += weight(T, Keep(s1[1])) * Weight(T, s1[2:<span style="color: #005e8b; font-weight: bold;">end</span>], s2[2:<span style="color: #005e8b; font-weight: bold;">end</span>])
    <span style="color: #005e8b; font-weight: bold;">end</span>

    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">Finally, if both strings are empty, we denote triviality by
</span>    <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">adding the multiplicative identity.
</span>    <span style="color: #005e8b; font-weight: bold;">if</span> length(s1) == 0 &amp;&amp; length(s2) == 0
        o += one(T)
    <span style="color: #005e8b; font-weight: bold;">end</span>
    o
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<p>
Now that the function that computes the weight of our subgraph <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2759.21453pt%27 height=%2711.022402pt%27 viewBox=%27-.500002 -7.971982 59.21453 11.022402%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3Cpath id=%27g7-83%27 d=%27m4.951432-4.811955c0-.034869-.020922-.09066-.09066-.09066c-.041843 0-.048817 .006974-.139477 .097634l-.341719 .397509c-.265006-.369614-.704359-.495143-1.129763-.495143c-.983313 0-1.855044 .795019-1.855044 1.597011c0 .104608 .020922 .383562 .230137 .641594c.237111 .278954 .495143 .341719 .969365 .4533c.139477 .034869 .488169 .111582 .592777 .139477c.223163 .055791 .648568 .209215 .648568 .732254c0 .564882-.592777 1.227397-1.387796 1.227397c-.613699 0-1.352927-.216189-1.352927-.990286c0-.069738 .013948-.223163 .041843-.348692c.006974-.027895 .006974-.034869 .006974-.041843c0-.09066-.083686-.09066-.111582-.09066c-.097634 0-.104608 .013948-.132503 .139477l-.355666 1.39477c-.006974 .027895-.020922 .069738-.020922 .104608c0 .041843 .027895 .083686 .097634 .083686c.041843 0 .048817-.006974 .139477-.097634c.076712-.083686 .258032-.306849 .334745-.390535c.369614 .404483 .913574 .488169 1.332005 .488169c1.053051 0 1.903861-.9066 1.903861-1.729514c0-.306849-.125529-.585803-.278954-.746202c-.244085-.251059-.348692-.278954-1.248319-.488169c-.146451-.034869-.376588-.09066-.439352-.111582c-.174346-.062765-.467248-.237111-.467248-.63462c0-.550934 .620672-1.108842 1.345953-1.108842c.753176 0 1.115816 .425405 1.115816 1.08792c0 .09066-.027895 .251059-.027895 .313823c0 .097634 .083686 .097634 .118555 .097634c.104608 0 .111582-.034869 .139477-.153425l.36264-1.478456z%27/%3E%0A%3Cpath id=%27g9-50%27 d=%27m4.134496-1.185554c0-.099626-.079701-.119552-.129514-.119552c-.089664 0-.109589 .059776-.129514 .139477c-.348692 1.026152-1.24533 1.026152-1.344956 1.026152c-.498132 0-.896638-.298879-1.125778-.667497c-.298879-.478207-.298879-1.135741-.298879-1.494396h2.779577c.219178 0 .249066 0 .249066-.209215c0-.986301-.537983-1.952677-1.783313-1.952677c-1.155666 0-2.072229 1.026152-2.072229 2.271482c0 1.334994 1.046077 2.30137 2.191781 2.30137c1.215442 0 1.663761-1.105853 1.663761-1.295143zm-.657534-1.325031h-2.361146c.059776-1.484433 .896638-1.733499 1.235367-1.733499c1.026152 0 1.125778 1.344956 1.125778 1.733499z%27/%3E%0A%3Cpath id=%27g9-59%27 d=%27m4.83188-4.024907c0-.169365-.119552-.488169-.508095-.488169c-.199253 0-.637609 .059776-1.05604 .468244c-.418431-.328767-.836862-.358655-1.05604-.358655c-.926526 0-1.613948 .687422-1.613948 1.454545c0 .438356 .219178 .816936 .468244 1.026152c-.129514 .14944-.308842 .478207-.308842 .826899c0 .308842 .129514 .687422 .438356 .886675c-.597758 .169365-.916563 .597758-.916563 .996264c0 .71731 .986301 1.265255 2.201743 1.265255c1.175592 0 2.211706-.508095 2.211706-1.285181c0-.348692-.139477-.856787-.647572-1.135741c-.52802-.278954-1.105853-.278954-1.713574-.278954c-.249066 0-.67746 0-.747198-.009963c-.318804-.039851-.52802-.348692-.52802-.667497c0-.039851 0-.268991 .169365-.468244c.388543 .278954 .797011 .308842 .986301 .308842c.926526 0 1.613948-.687422 1.613948-1.454545c0-.368618-.159402-.737235-.408468-.966376c.358655-.33873 .71731-.388543 .896638-.388543c0 0 .069738 0 .099626 .009963c-.109589 .039851-.159402 .14944-.159402 .268991c0 .169365 .129514 .288917 .288917 .288917c.099626 0 .288917-.069738 .288917-.298879zm-1.753425 1.075965c0 .268991-.009963 .587796-.159402 .836862c-.079701 .119552-.308842 .398506-.707347 .398506c-.86675 0-.86675-.996264-.86675-1.225405c0-.268991 .009963-.587796 .159402-.836862c.079701-.119552 .308842-.398506 .707347-.398506c.86675 0 .86675 .996264 .86675 1.225405zm1.09589 3.73599c0 .537983-.707347 1.036115-1.683686 1.036115c-1.006227 0-1.693649-.508095-1.693649-1.036115c0-.458281 .37858-.826899 .816936-.856787h.587796c.856787 0 1.972603 0 1.972603 .856787z%27/%3E%0A%3Cpath id=%27g9-63%27 d=%27m5.330012 0v-.308842c-.518057 0-.767123 0-.777086-.298879v-1.902864c0-.856787 0-1.165629-.308842-1.524284c-.139477-.169365-.468244-.368618-1.046077-.368618c-.836862 0-1.275218 .597758-1.43462 .956413h-.009963v-3.466999l-1.43462 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v5.180573c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888v-.308842c-.667497 0-.777086 0-.777086-.448319v-1.833126c0-1.036115 .707347-1.594022 1.344956-1.594022c.627646 0 .737235 .537983 .737235 1.105853v2.321295c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888z%27/%3E%0A%3Cpath id=%27g9-66%27 d=%27m2.460772 0v-.308842c-.657534 0-.697385-.049813-.697385-.438356v-3.656289l-1.39477 .109589v.308842c.647572 0 .737235 .059776 .737235 .547945v2.67995c0 .448319-.109589 .448319-.777086 .448319v.308842l1.09589-.029888c.348692 0 .697385 .019925 1.036115 .029888zm-.547945-6.017435c0-.268991-.229141-.52802-.52802-.52802c-.33873 0-.537983 .278954-.537983 .52802c0 .268991 .229141 .52802 .52802 .52802c.33873 0 .537983-.278954 .537983-.52802z%27/%3E%0A%3Cpath id=%27g9-105%27 d=%27m3.307597-1.235367v-.56787h-.249066v.547945c0 .737235-.298879 1.115816-.667497 1.115816c-.667497 0-.667497-.9066-.667497-1.075965v-2.769614h1.424658v-.308842h-1.424658v-1.833126h-.249066c-.009963 .816936-.308842 1.882939-1.285181 1.92279v.219178h.846824v2.749689c0 1.225405 .926526 1.344956 1.285181 1.344956c.707347 0 .986301-.707347 .986301-1.344956z%27/%3E%0A%3Cpath id=%27g9-113%27 d=%27m10.052304-6.495641v-.308842c-.298879 .019925-.607721 .029888-.9066 .029888l-1.185554-.029888v.308842c.667497 .009963 .86675 .33873 .86675 .52802c0 .059776-.029888 .139477-.049813 .199253l-1.494396 4.60274l-1.594022-4.881694c-.009963-.039851-.029888-.099626-.029888-.14944c0-.298879 .577833-.298879 .836862-.298879v-.308842c-.358655 .029888-1.036115 .029888-1.414695 .029888l-1.215442-.029888v.308842c.56787 0 .777086 0 .896638 .358655l.219178 .697385l-1.384807 4.273973l-1.603985-4.901619c-.009963-.029888-.019925-.099626-.019925-.129514c0-.298879 .577833-.298879 .836862-.298879v-.308842c-.358655 .029888-1.036115 .029888-1.414695 .029888l-1.215442-.029888v.308842c.747198 0 .787049 .049813 .9066 .418431l1.992528 6.107098c.029888 .089664 .059776 .18929 .18929 .18929c.139477 0 .159402-.069738 .199253-.199253l1.643836-5.061021l1.653798 5.070984c.029888 .089664 .059776 .18929 .18929 .18929c.139477 0 .159402-.069738 .199253-.199253l1.902864-5.84807c.179328-.56787 .607721-.667497 .996264-.667497z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page15%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g9-113%27/%3E%0A%3Cuse x=%279.414693%27 y=%270%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%2713.838105%27 y=%270%27 xlink:href=%27%23g9-66%27/%3E%0A%3Cuse x=%2716.607719%27 y=%270%27 xlink:href=%27%23g9-59%27/%3E%0A%3Cuse x=%2721.589039%27 y=%270%27 xlink:href=%27%23g9-63%27/%3E%0A%3Cuse x=%2726.849314%27 y=%270%27 xlink:href=%27%23g9-105%27/%3E%0A%3Cuse x=%2730.724778%27 y=%272.550418%27 xlink:href=%27%23g7-83%27/%3E%0A%3Cuse x=%2736.496211%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2740.370585%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%2745.636739%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2750.064547%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3Cuse x=%2754.340181%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(
\text{Weight}_S(a,b) \)" style="height: 1.0842em; vertical-align: -0.3001em; display: inline-block" class="org-latex org-latex-inline" /> is done, we can test it on different choices of <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%277.683254pt%27 height=%277.807787pt%27 viewBox=%27-.500002 -7.307786 7.683254 7.807787%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-83%27 d=%27m6.425903-6.924035c0-.029888-.019925-.099626-.109589-.099626c-.049813 0-.059776 .009963-.179328 .14944l-.478207 .56787c-.259029-.468244-.777086-.71731-1.424658-.71731c-1.265255 0-2.460772 1.145704-2.460772 2.351183c0 .806974 .52802 1.265255 1.036115 1.414695l1.066002 .278954c.368618 .089664 .916563 .239103 .916563 1.05604c0 .896638-.816936 1.833126-1.793275 1.833126c-.637609 0-1.743462-.219178-1.743462-1.454545c0-.239103 .049813-.478207 .059776-.537983c.009963-.039851 .019925-.049813 .019925-.069738c0-.099626-.069738-.109589-.119552-.109589s-.069738 .009963-.099626 .039851c-.039851 .039851-.597758 2.311333-.597758 2.34122c0 .059776 .049813 .099626 .109589 .099626c.049813 0 .059776-.009963 .179328-.14944l.488169-.56787c.428394 .577833 1.105853 .71731 1.683686 .71731c1.354919 0 2.530511-1.325031 2.530511-2.560399c0-.687422-.33873-1.026152-.488169-1.165629c-.229141-.229141-.37858-.268991-1.265255-.498132c-.219178-.059776-.577833-.159402-.667497-.179328c-.268991-.089664-.607721-.37858-.607721-.9066c0-.806974 .797011-1.653798 1.743462-1.653798c.826899 0 1.43462 .428394 1.43462 1.544209c0 .318804-.039851 .498132-.039851 .557908c0 .009963 0 .099626 .119552 .099626c.099626 0 .109589-.029888 .14944-.199253l.537983-2.181818z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page16%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-83%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( S \)" style="height: 0.7680em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />.
</p>
</div>
<div id="outline-container-org226fe95" class="outline-3">
<h3 id="org226fe95"><span class="section-number-3">3.1.</span> Tropical semiring (minimum cost)</h3>
<div class="outline-text-3" id="text-3-1">
<p>
One very exotic semiring is the tropical semiring. At first glance, it looks a
lot like usual real number, but it really is not.
</p>

<ol class="org-ol">
<li>The carrier set of the semiring is the set of real numbers <b>plus</b> infinity
(which isn&rsquo;t part of the reals).</li>
<li>The semiring addition <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2722.718243pt%27 height=%278.748717pt%27 viewBox=%27-.500002 -7.4185 22.718243 8.748717%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g5-8%27 d=%27m7.193026-2.49066c0-1.833126-1.494396-3.317559-3.317559-3.317559c-1.853051 0-3.327522 1.504359-3.327522 3.317559c0 1.833126 1.494396 3.317559 3.317559 3.317559c1.853051 0 3.327522-1.504359 3.327522-3.317559zm-6.396015-.129514c.099626-1.673724 1.39477-2.859278 2.948941-2.938979v2.938979h-2.948941zm3.198007-2.938979c1.564134 .079701 2.849315 1.275218 2.948941 2.938979h-2.948941v-2.938979zm-.249066 6.136986c-1.544209-.079701-2.849315-1.24533-2.948941-2.948941h2.948941v2.948941zm3.198007-2.948941c-.099626 1.703611-1.414695 2.86924-2.948941 2.948941v-2.948941h2.948941z%27/%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page17%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%277.48002%27 y=%270%27 xlink:href=%27%23g5-8%27/%3E%0A%3Cuse x=%2717.442633%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( a \oplus b \)" style="height: 0.8606em; vertical-align: -0.1309em; display: inline-block" class="org-latex org-latex-inline" /> on two elements is the <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2739.326038pt%27 height=%2710.962644pt%27 viewBox=%27-.500002 -7.971982 39.326038 10.962644%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g9-66%27 d=%27m2.460772 0v-.308842c-.657534 0-.697385-.049813-.697385-.438356v-3.656289l-1.39477 .109589v.308842c.647572 0 .737235 .059776 .737235 .547945v2.67995c0 .448319-.109589 .448319-.777086 .448319v.308842l1.09589-.029888c.348692 0 .697385 .019925 1.036115 .029888zm-.547945-6.017435c0-.268991-.229141-.52802-.52802-.52802c-.33873 0-.537983 .278954-.537983 .52802c0 .268991 .229141 .52802 .52802 .52802c.33873 0 .537983-.278954 .537983-.52802z%27/%3E%0A%3Cpath id=%27g9-75%27 d=%27m8.099626 0v-.308842c-.518057 0-.767123 0-.777086-.298879v-1.902864c0-.856787 0-1.165629-.308842-1.524284c-.139477-.169365-.468244-.368618-1.046077-.368618c-.836862 0-1.275218 .597758-1.444583 .976339c-.139477-.86675-.876712-.976339-1.325031-.976339c-.727273 0-1.195517 .428394-1.474471 1.046077v-1.046077l-1.404732 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v2.669988c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888v-.308842c-.667497 0-.777086 0-.777086-.448319v-1.833126c0-1.036115 .707347-1.594022 1.344956-1.594022c.627646 0 .737235 .537983 .737235 1.105853v2.321295c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888v-.308842c-.667497 0-.777086 0-.777086-.448319v-1.833126c0-1.036115 .707347-1.594022 1.344956-1.594022c.627646 0 .737235 .537983 .737235 1.105853v2.321295c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888z%27/%3E%0A%3Cpath id=%27g9-77%27 d=%27m5.330012 0v-.308842c-.518057 0-.767123 0-.777086-.298879v-1.902864c0-.856787 0-1.165629-.308842-1.524284c-.139477-.169365-.468244-.368618-1.046077-.368618c-.727273 0-1.195517 .428394-1.474471 1.046077v-1.046077l-1.404732 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v2.669988c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888v-.308842c-.667497 0-.777086 0-.777086-.448319v-1.833126c0-1.036115 .707347-1.594022 1.344956-1.594022c.627646 0 .737235 .537983 .737235 1.105853v2.321295c0 .448319-.109589 .448319-.777086 .448319v.308842l1.125778-.029888l1.115816 .029888z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page18%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g9-75%27/%3E%0A%3Cuse x=%278.298879%27 y=%270%27 xlink:href=%27%23g9-66%27/%3E%0A%3Cuse x=%2711.068493%27 y=%270%27 xlink:href=%27%23g9-77%27/%3E%0A%3Cuse x=%2716.607719%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2720.482093%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%2725.748247%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2730.176055%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3Cuse x=%2734.451689%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( \min(a,b) \)" style="height: 1.0784em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" />
operation on two reals.</li>
<li>Multiplication of semiring elements is addition of reals.</li>
<li>The neutral element under addition is plus infinity.</li>
<li>The neutral element under multiplication is zero.</li>
<li>Verify that the other properties are respected.</li>
</ol>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">struct</span> <span style="color: #531ab6; font-weight: bold;">MinCost</span> &lt;: <span style="color: #531ab6; font-weight: bold;">Semiring</span>
    cost
<span style="color: #005e8b; font-weight: bold;">end</span>

Base.<span style="color: #8f0075;">zero</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{MinCost}) = MinCost(<span style="color: #531ab6;">Inf</span>)
Base.<span style="color: #8f0075;">one</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{MinCost}) = MinCost(0)

Base.:*(a::<span style="color: #531ab6; font-weight: bold;">MinCost</span>, b::<span style="color: #531ab6; font-weight: bold;">MinCost</span>) = MinCost(a.cost + b.cost)
Base.:+(a::<span style="color: #531ab6; font-weight: bold;">MinCost</span>, b::<span style="color: #531ab6; font-weight: bold;">MinCost</span>) = MinCost(min(a.cost, b.cost))
</code></pre>
</div>


<p>
Here, our weights are defined in the following manner: inserting or deleting a
character costs 1 unit, whereas keeping an already existing character is free.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #8f0075;">weight</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{MinCost}, ::<span style="color: #531ab6; font-weight: bold;">Ins</span>) = MinCost(1)
<span style="color: #8f0075;">weight</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{MinCost}, ::<span style="color: #531ab6; font-weight: bold;">Del</span>) = MinCost(1)
<span style="color: #8f0075;">weight</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{MinCost}, ::<span style="color: #531ab6; font-weight: bold;">Keep</span>) = MinCost(0)
</code></pre>
</div>

<p>
It is easy to see that if we combine sequentially two operations (through
multiplication), then their cost will be summed whereas if we take the sum
(combine horizontally two operations), then we will keep the minimum of the two
costs.
</p>

<p>
If we evaluate the graph weight function on &ldquo;carp&rdquo; and &ldquo;carve&rdquo;, we should get
something that is at least as cheap as the three operations we used earlier.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code>Weight(MinCost, <span style="color: #a0132f;">"carp"</span>, <span style="color: #a0132f;">"carve"</span>)
</code></pre>
</div>

<pre class="example">
MinCost(3.0)
</pre>

<p>
It works! However, it is not very useful to only see the cost of the best
solution, we also want the solution itself!
</p>
</div>
</div>
<div id="outline-container-org2992839" class="outline-3">
<h3 id="org2992839"><span class="section-number-3">3.2.</span> The free semi ring</h3>
<div class="outline-text-3" id="text-3-2">
<p>
We would really like to access to the optimal sequence implicitly computed by
the algorithm of which the <code>MinCost</code> is the cost. Before we do that, however, we
will need to be able to extract from the <code>Weight</code> procedure the entire set of
possible paths. This is what the free semiring is for.
</p>

<p>
In algebra, the &ldquo;free X generated by the alphabe <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%278.471999pt%27 height=%277.807787pt%27 viewBox=%27-.500002 -7.307786 8.471999 7.807787%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-65%27 d=%27m1.783313-1.145704c-.398506 .667497-.787049 .806974-1.225405 .836862c-.119552 .009963-.209215 .009963-.209215 .199253c0 .059776 .049813 .109589 .129514 .109589c.268991 0 .577833-.029888 .856787-.029888c.328767 0 .67746 .029888 .996264 .029888c.059776 0 .18929 0 .18929-.18929c0-.109589-.089664-.119552-.159402-.119552c-.229141-.019925-.468244-.099626-.468244-.348692c0-.119552 .059776-.229141 .139477-.368618l.757161-1.275218h2.500623c.019925 .209215 .159402 1.564134 .159402 1.663761c0 .298879-.518057 .328767-.71731 .328767c-.139477 0-.239103 0-.239103 .199253c0 .109589 .119552 .109589 .139477 .109589c.408468 0 .836862-.029888 1.24533-.029888c.249066 0 .876712 .029888 1.125778 .029888c.059776 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.229141-.109589c-.617684 0-.617684-.069738-.647572-.358655l-.607721-6.22665c-.019925-.199253-.019925-.239103-.18929-.239103c-.159402 0-.199253 .069738-.259029 .169365l-3.466999 5.818182zm1.195517-1.464508l1.96264-3.287671l.318804 3.287671h-2.281445z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page60%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-65%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( A \)" style="height: 0.7680em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />&rdquo; is a very standard
construction where we take the <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%278.471999pt%27 height=%277.807787pt%27 viewBox=%27-.500002 -7.307786 8.471999 7.807787%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-65%27 d=%27m1.783313-1.145704c-.398506 .667497-.787049 .806974-1.225405 .836862c-.119552 .009963-.209215 .009963-.209215 .199253c0 .059776 .049813 .109589 .129514 .109589c.268991 0 .577833-.029888 .856787-.029888c.328767 0 .67746 .029888 .996264 .029888c.059776 0 .18929 0 .18929-.18929c0-.109589-.089664-.119552-.159402-.119552c-.229141-.019925-.468244-.099626-.468244-.348692c0-.119552 .059776-.229141 .139477-.368618l.757161-1.275218h2.500623c.019925 .209215 .159402 1.564134 .159402 1.663761c0 .298879-.518057 .328767-.71731 .328767c-.139477 0-.239103 0-.239103 .199253c0 .109589 .119552 .109589 .139477 .109589c.408468 0 .836862-.029888 1.24533-.029888c.249066 0 .876712 .029888 1.125778 .029888c.059776 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.229141-.109589c-.617684 0-.617684-.069738-.647572-.358655l-.607721-6.22665c-.019925-.199253-.019925-.239103-.18929-.239103c-.159402 0-.199253 .069738-.259029 .169365l-3.466999 5.818182zm1.195517-1.464508l1.96264-3.287671l.318804 3.287671h-2.281445z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page60%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-65%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( A \)" style="height: 0.7680em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> set, then add just enough elements and
equalities such that <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2711.267075pt%27 height=%278.489739pt%27 viewBox=%27-.500002 -7.989738 11.267075 8.489739%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g4-48%27 d=%27m2.022416-3.291656c.055791-.118555 .062765-.174346 .062765-.223163c0-.216189-.195268-.383562-.411457-.383562c-.265006 0-.348692 .216189-.383562 .327771l-.920548 3.019676c-.006974 .013948-.034869 .104608-.034869 .111582c0 .083686 .216189 .153425 .27198 .153425c.048817 0 .055791-.013948 .104608-.118555l1.311083-2.887173z%27/%3E%0A%3Cpath id=%27g8-65%27 d=%27m1.783313-1.145704c-.398506 .667497-.787049 .806974-1.225405 .836862c-.119552 .009963-.209215 .009963-.209215 .199253c0 .059776 .049813 .109589 .129514 .109589c.268991 0 .577833-.029888 .856787-.029888c.328767 0 .67746 .029888 .996264 .029888c.059776 0 .18929 0 .18929-.18929c0-.109589-.089664-.119552-.159402-.119552c-.229141-.019925-.468244-.099626-.468244-.348692c0-.119552 .059776-.229141 .139477-.368618l.757161-1.275218h2.500623c.019925 .209215 .159402 1.564134 .159402 1.663761c0 .298879-.518057 .328767-.71731 .328767c-.139477 0-.239103 0-.239103 .199253c0 .109589 .119552 .109589 .139477 .109589c.408468 0 .836862-.029888 1.24533-.029888c.249066 0 .876712 .029888 1.125778 .029888c.059776 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.229141-.109589c-.617684 0-.617684-.069738-.647572-.358655l-.607721-6.22665c-.019925-.199253-.019925-.239103-.18929-.239103c-.159402 0-.199253 .069738-.259029 .169365l-3.466999 5.818182zm1.195517-1.464508l1.96264-3.287671l.318804 3.287671h-2.281445z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page21%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-65%27/%3E%0A%3Cuse x=%277.471999%27 y=%27-3.615364%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( A' \)" style="height: 0.8351em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> becomes an X. In the case of semi rings, this
means we must make the elements multiply, add, contain a neutral element for
those two operations et cetera. It turns out that once we have done that, what
we end up with is a semi ring where:
</p>

<ol class="org-ol">
<li>Each element of <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2734.651627pt%27 height=%2710.962644pt%27 viewBox=%27-.500002 -7.971982 34.651627 10.962644%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-65%27 d=%27m1.783313-1.145704c-.398506 .667497-.787049 .806974-1.225405 .836862c-.119552 .009963-.209215 .009963-.209215 .199253c0 .059776 .049813 .109589 .129514 .109589c.268991 0 .577833-.029888 .856787-.029888c.328767 0 .67746 .029888 .996264 .029888c.059776 0 .18929 0 .18929-.18929c0-.109589-.089664-.119552-.159402-.119552c-.229141-.019925-.468244-.099626-.468244-.348692c0-.119552 .059776-.229141 .139477-.368618l.757161-1.275218h2.500623c.019925 .209215 .159402 1.564134 .159402 1.663761c0 .298879-.518057 .328767-.71731 .328767c-.139477 0-.239103 0-.239103 .199253c0 .109589 .119552 .109589 .139477 .109589c.408468 0 .836862-.029888 1.24533-.029888c.249066 0 .876712 .029888 1.125778 .029888c.059776 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.229141-.109589c-.617684 0-.617684-.069738-.647572-.358655l-.607721-6.22665c-.019925-.199253-.019925-.239103-.18929-.239103c-.159402 0-.199253 .069738-.259029 .169365l-3.466999 5.818182zm1.195517-1.464508l1.96264-3.287671l.318804 3.287671h-2.281445z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g9-50%27 d=%27m4.134496-1.185554c0-.099626-.079701-.119552-.129514-.119552c-.089664 0-.109589 .059776-.129514 .139477c-.348692 1.026152-1.24533 1.026152-1.344956 1.026152c-.498132 0-.896638-.298879-1.125778-.667497c-.298879-.478207-.298879-1.135741-.298879-1.494396h2.779577c.219178 0 .249066 0 .249066-.209215c0-.986301-.537983-1.952677-1.783313-1.952677c-1.155666 0-2.072229 1.026152-2.072229 2.271482c0 1.334994 1.046077 2.30137 2.191781 2.30137c1.215442 0 1.663761-1.105853 1.663761-1.295143zm-.657534-1.325031h-2.361146c.059776-1.484433 .896638-1.733499 1.235367-1.733499c1.026152 0 1.125778 1.344956 1.125778 1.733499z%27/%3E%0A%3Cpath id=%27g9-54%27 d=%27m6.07721-4.533001l-.278954-2.241594h-5.469489v.308842h.239103c.767123 0 .787049 .109589 .787049 .468244v5.220423c0 .358655-.019925 .468244-.787049 .468244h-.239103v.308842c.348692-.029888 1.125778-.029888 1.514321-.029888c.408468 0 1.315068 0 1.673724 .029888v-.308842h-.328767c-.946451 0-.946451-.129514-.946451-.478207v-2.450809h.856787c.956413 0 1.05604 .318804 1.05604 1.165629h.249066v-2.6401h-.249066c0 .836862-.099626 1.165629-1.05604 1.165629h-.856787v-2.520548c0-.328767 .019925-.398506 .488169-.398506h1.195517c1.494396 0 1.743462 .557908 1.902864 1.932752h.249066z%27/%3E%0A%3Cpath id=%27g9-96%27 d=%27m3.626401-3.795766c0-.318804-.308842-.607721-.737235-.607721c-.727273 0-1.085928 .667497-1.225405 1.09589v-1.09589l-1.384807 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v2.669988c0 .448319-.109589 .448319-.777086 .448319v.308842l1.135741-.029888c.398506 0 .86675 0 1.265255 .029888v-.308842h-.209215c-.737235 0-.757161-.109589-.757161-.468244v-1.534247c0-.986301 .418431-1.872976 1.175592-1.872976c.069738 0 .089664 0 .109589 .009963c-.029888 .009963-.229141 .129514-.229141 .388543c0 .278954 .209215 .428394 .428394 .428394c.179328 0 .428394-.119552 .428394-.438356z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page22%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g9-54%27/%3E%0A%3Cuse x=%275.678703%27 y=%270%27 xlink:href=%27%23g9-96%27/%3E%0A%3Cuse x=%279.584058%27 y=%270%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%2714.00747%27 y=%270%27 xlink:href=%27%23g9-50%27/%3E%0A%3Cuse x=%2718.430884%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2722.305258%27 y=%270%27 xlink:href=%27%23g8-65%27/%3E%0A%3Cuse x=%2729.777257%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( \text{Free}(A) \)" style="height: 1.0784em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" /> is a set of sequences of <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%278.471999pt%27 height=%277.807787pt%27 viewBox=%27-.500002 -7.307786 8.471999 7.807787%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-65%27 d=%27m1.783313-1.145704c-.398506 .667497-.787049 .806974-1.225405 .836862c-.119552 .009963-.209215 .009963-.209215 .199253c0 .059776 .049813 .109589 .129514 .109589c.268991 0 .577833-.029888 .856787-.029888c.328767 0 .67746 .029888 .996264 .029888c.059776 0 .18929 0 .18929-.18929c0-.109589-.089664-.119552-.159402-.119552c-.229141-.019925-.468244-.099626-.468244-.348692c0-.119552 .059776-.229141 .139477-.368618l.757161-1.275218h2.500623c.019925 .209215 .159402 1.564134 .159402 1.663761c0 .298879-.518057 .328767-.71731 .328767c-.139477 0-.239103 0-.239103 .199253c0 .109589 .119552 .109589 .139477 .109589c.408468 0 .836862-.029888 1.24533-.029888c.249066 0 .876712 .029888 1.125778 .029888c.059776 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.229141-.109589c-.617684 0-.617684-.069738-.647572-.358655l-.607721-6.22665c-.019925-.199253-.019925-.239103-.18929-.239103c-.159402 0-.199253 .069738-.259029 .169365l-3.466999 5.818182zm1.195517-1.464508l1.96264-3.287671l.318804 3.287671h-2.281445z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page60%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-65%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( A \)" style="height: 0.7680em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />&rsquo;s.</li>
<li>Addition is union of sets of sequences.</li>
<li>Multiplication is concatenation of every left sequence with every right
sequence.</li>
<li>Additive identity is the empty set.</li>
<li>Multiplicative identity is the set that only contains the empty sequence.</li>
</ol>

<p>
Implemented in Julia, those operations look like this:
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">struct</span> <span style="color: #531ab6; font-weight: bold;">Free</span>{A} &lt;: <span style="color: #531ab6; font-weight: bold;">Semiring</span>
    choices::<span style="color: #531ab6; font-weight: bold;">Set</span>{Vector{A}}
<span style="color: #005e8b; font-weight: bold;">end</span>

<span style="color: #8f0075;">Free</span>(s::<span style="color: #531ab6; font-weight: bold;">Set</span>{Vector{A}}) <span style="color: #005e8b; font-weight: bold;">where</span> A = Free{A}(s)

Base.<span style="color: #8f0075;">zero</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{Free{A}}) <span style="color: #005e8b; font-weight: bold;">where</span> A = Free{A}(Set([]))

Base.<span style="color: #8f0075;">one</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{Free{A}}) <span style="color: #005e8b; font-weight: bold;">where</span> A = Free{A}(Set([[]]))

Base.:+(a::<span style="color: #531ab6; font-weight: bold;">Free</span>{A}, b::<span style="color: #531ab6; font-weight: bold;">Free</span>{A}) <span style="color: #005e8b; font-weight: bold;">where</span> A = Free{A}(a.choices &#8746; b.choices)
Base.:*(a::<span style="color: #531ab6; font-weight: bold;">Free</span>{A}, b::<span style="color: #531ab6; font-weight: bold;">Free</span>{A}) <span style="color: #005e8b; font-weight: bold;">where</span> A = Free{A}(
    Set([vcat(parta, partb)
         <span style="color: #005e8b; font-weight: bold;">for</span> parta <span style="color: #005e8b; font-weight: bold;">in</span> a.choices
         <span style="color: #005e8b; font-weight: bold;">for</span> partb <span style="color: #005e8b; font-weight: bold;">in</span> b.choices]))
</code></pre>
</div>

<p>
What is interesting here, is that we can generate a free semi ring from every
single possible alphabet set. What this suggests with regards to the operation
weight function is that we should just embed each operation in the free semi
ring generated by the operations.
</p>

<p>
We do that by mapping every transition to the singleton set that contains a
sequence containing only that thing.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #8f0075;">weight</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{Free{Op}}, o::<span style="color: #531ab6; font-weight: bold;">Op</span>) = Free{Op}(Set([[o]]))
</code></pre>
</div>

<p>
What happens next will might surprise you. Each time the <code>Weight</code> function
combines the weights of two half paths into a single big path weight, it will
actually be combining all left possible paths with all right possible paths.
When two possible paths from <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.266144pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.266144 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page40%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( a \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> to <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%275.275627pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 5.275627 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page41%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( b \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> are added, the two sets of
possible paths are unioned. At the end of the function&rsquo;s execution, it returns
us a set of all possible operation sequences that start at <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.266144pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.266144 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page40%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( a \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> and end at <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%275.275627pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 5.275627 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page27%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(
b \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />.
</p>

<p>
Let&rsquo;s see what those look like in the case of &ldquo;carp&rdquo; and &ldquo;carve&rdquo;:
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">(Il y en a vraiment beaucoup)
</span><span style="color: #005e8b; font-weight: bold;">for</span> seq <span style="color: #005e8b; font-weight: bold;">in</span> Iterators.take(Weight(Free{Op}, <span style="color: #a0132f;">"carp"</span>, <span style="color: #a0132f;">"carve"</span>).choices, 10)
    println(seq)
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<pre class="example" id="orga082041">
Op[Ins('c'), Del('c'), Ins('a'), Del('a'), Keep('r'), Ins('v'), Del('p'), Ins('e')]
Op[Del('c'), Del('a'), Ins('c'), Ins('a'), Ins('r'), Del('r'), Ins('v'), Del('p'), Ins('e')]
Op[Ins('c'), Ins('a'), Del('c'), Ins('r'), Del('a'), Ins('v'), Ins('e'), Del('r'), Del('p')]
Op[Ins('c'), Ins('a'), Del('c'), Del('a'), Del('r'), Ins('r'), Ins('v'), Del('p'), Ins('e')]
Op[Ins('c'), Ins('a'), Ins('r'), Del('c'), Del('a'), Ins('v'), Ins('e'), Del('r'), Del('p')]
Op[Keep('c'), Ins('a'), Del('a'), Keep('r'), Del('p'), Ins('v'), Ins('e')]
Op[Del('c'), Ins('c'), Ins('a'), Ins('r'), Del('a'), Del('r'), Del('p'), Ins('v'), Ins('e')]
Op[Keep('c'), Ins('a'), Del('a'), Del('r'), Del('p'), Ins('r'), Ins('v'), Ins('e')]
Op[Keep('c'), Ins('a'), Ins('r'), Del('a'), Ins('v'), Del('r'), Del('p'), Ins('e')]
Op[Ins('c'), Del('c'), Del('a'), Ins('a'), Del('r'), Ins('r'), Ins('v'), Del('p'), Ins('e')]
</pre>

<p>
Even though the two words are quite similar, there are a lot of ways to turn one
into the other and enumerating all of them (especially the longer ones) is
really not the point of this exercise. Where the free semi ring shines is when
we use it in combination with other semi rings as we will be doing soon.
</p>

<p>
Before we go there, however, how would we go about counting the number of
distinct paths, if we did not want to construct them in the process?
</p>
</div>
</div>
<div id="outline-container-orgea0e159" class="outline-3">
<h3 id="orgea0e159"><span class="section-number-3">3.3.</span> Count semi ring</h3>
<div class="outline-text-3" id="text-3-3">
<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">struct</span> <span style="color: #531ab6; font-weight: bold;">Count</span> &lt;: <span style="color: #531ab6; font-weight: bold;">Semiring</span>
    n::<span style="color: #531ab6; font-weight: bold;">Int</span>
<span style="color: #005e8b; font-weight: bold;">end</span>

Base.<span style="color: #8f0075;">zero</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{Count}) = Count(0)

Base.<span style="color: #8f0075;">one</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{Count}) = Count(1)

Base.:+(a::<span style="color: #531ab6; font-weight: bold;">Count</span>, b::<span style="color: #531ab6; font-weight: bold;">Count</span>) = Count(a.n + b.n)
Base.:*(a::<span style="color: #531ab6; font-weight: bold;">Count</span>, b::<span style="color: #531ab6; font-weight: bold;">Count</span>) = Count(a.n * b.n)

<span style="color: #8f0075;">weight</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{Count}, ::<span style="color: #531ab6; font-weight: bold;">Op</span>) = Count(1)
</code></pre>
</div>

<p>
What the &ldquo;counting semi ring&rdquo;, really is, is the good old natural numbers. Let&rsquo;s
use it on the Weight function, for a laugh
</p>

<div class="org-src-container">
<pre class="src src-julia"><code>println(Weight(Count,<span style="color: #a0132f;">"carp"</span>, <span style="color: #a0132f;">"carve"</span>))
</code></pre>
</div>

<p>
let&rsquo;s compare to what the free semiring gives us
</p>

<div class="org-src-container">
<pre class="src src-julia"><code>println(length(Weight(Free{Op}, <span style="color: #a0132f;">"carp"</span>, <span style="color: #a0132f;">"carve"</span>).choices))
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org88c9d64" class="outline-3">
<h3 id="org88c9d64"><span class="section-number-3">3.4.</span> Selector semi ring</h3>
<div class="outline-text-3" id="text-3-4">
<p>
If we have two semi rings, a very standard algebraic construction is to consider
the <b>product</b> of those two semi rings. However, to make something useful, we will
also be asking for the first semi ring to have the structure of an order.
</p>

<p>
We can construct a semi ring of pairs where the first component is kind of like
a &ldquo;cost&rdquo; and the second, a &ldquo;payload&rdquo;. Here is how it goes:
</p>

<ol class="org-ol">
<li>Addition of <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2731.439141pt%27 height=%2710.962644pt%27 viewBox=%27-.500002 -7.971982 31.439141 10.962644%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-49%27 d=%27m2.336239-4.435367c0-.188294-.013948-.195268-.209215-.195268c-.446326 .439352-1.080946 .446326-1.366874 .446326v.251059c.167372 0 .627646 0 1.011208-.195268v3.556663c0 .230137 0 .320797-.697385 .320797h-.265006v.251059c.125529-.006974 .983313-.027895 1.241345-.027895c.216189 0 1.094894 .020922 1.248319 .027895v-.251059h-.265006c-.697385 0-.697385-.09066-.697385-.320797v-3.863512z%27/%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-99%27 d=%27m3.945205-3.785803c-.159402 0-.298879 0-.438356 .139477c-.159402 .14944-.179328 .318804-.179328 .388543c0 .239103 .179328 .348692 .368618 .348692c.288917 0 .557908-.239103 .557908-.637609c0-.488169-.468244-.856787-1.175592-.856787c-1.344956 0-2.669988 1.424658-2.669988 2.82939c0 .896638 .577833 1.683686 1.613948 1.683686c1.424658 0 2.261519-1.05604 2.261519-1.175592c0-.059776-.059776-.129514-.119552-.129514c-.049813 0-.069738 .019925-.129514 .099626c-.787049 .986301-1.872976 .986301-1.992528 .986301c-.627646 0-.896638-.488169-.896638-1.085928c0-.408468 .199253-1.374844 .537983-1.992528c.308842-.56787 .856787-.996264 1.404732-.996264c.33873 0 .71731 .129514 .856787 .398506z%27/%3E%0A%3Cpath id=%27g8-112%27 d=%27m.448319 1.215442c-.079701 .33873-.099626 .408468-.537983 .408468c-.119552 0-.229141 0-.229141 .18929c0 .079701 .049813 .119552 .129514 .119552c.268991 0 .557908-.029888 .836862-.029888c.328767 0 .667497 .029888 .986301 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.239103-.109589c-.498132 0-.498132-.069738-.498132-.159402c0-.119552 .418431-1.743462 .488169-1.992528c.129514 .288917 .408468 .637609 .916563 .637609c1.155666 0 2.400996-1.454545 2.400996-2.919054c0-.936488-.56787-1.594022-1.325031-1.594022c-.498132 0-.976339 .358655-1.305106 .747198c-.099626-.537983-.52802-.747198-.896638-.747198c-.458281 0-.647572 .388543-.737235 .56787c-.179328 .33873-.308842 .936488-.308842 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.169365 0 .308842 .079701 .308842 .458281c0 .229141-.029888 .33873-.069738 .508095l-1.115816 4.433375zm1.753425-4.323786c.069738-.268991 .33873-.547945 .518057-.697385c.348692-.308842 .637609-.37858 .806974-.37858c.398506 0 .637609 .348692 .637609 .936488s-.328767 1.733499-.508095 2.11208c-.33873 .697385-.816936 1.026152-1.185554 1.026152c-.657534 0-.787049-.826899-.787049-.886675c0-.019925 0-.039851 .029888-.159402l.488169-1.952677z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page28%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%273.874374%27 y=%270%27 xlink:href=%27%23g8-99%27/%3E%0A%3Cuse x=%278.18577%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%2712.65514%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2717.082948%27 y=%270%27 xlink:href=%27%23g8-112%27/%3E%0A%3Cuse x=%2722.095413%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%2726.564782%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( (c_1, p_1) \)" style="height: 1.0784em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" /> and <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2731.439141pt%27 height=%2710.962644pt%27 viewBox=%27-.500002 -7.971982 31.439141 10.962644%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-50%27 d=%27m3.521793-1.26924h-.237111c-.020922 .153425-.09066 .564882-.18132 .63462c-.055791 .041843-.592777 .041843-.690411 .041843h-1.283188c.732254-.648568 .976339-.843836 1.39477-1.171606c.516065-.411457 .99726-.843836 .99726-1.506351c0-.843836-.739228-1.3599-1.63188-1.3599c-.864757 0-1.45056 .606725-1.45056 1.248319c0 .355666 .299875 .390535 .369614 .390535c.167372 0 .369614-.118555 .369614-.369614c0-.125529-.048817-.369614-.411457-.369614c.216189-.495143 .690411-.648568 1.018182-.648568c.697385 0 1.060025 .54396 1.060025 1.108842c0 .606725-.432379 1.08792-.655542 1.338979l-1.680697 1.659776c-.069738 .062765-.069738 .076712-.069738 .27198h2.873225l.209215-1.26924z%27/%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-99%27 d=%27m3.945205-3.785803c-.159402 0-.298879 0-.438356 .139477c-.159402 .14944-.179328 .318804-.179328 .388543c0 .239103 .179328 .348692 .368618 .348692c.288917 0 .557908-.239103 .557908-.637609c0-.488169-.468244-.856787-1.175592-.856787c-1.344956 0-2.669988 1.424658-2.669988 2.82939c0 .896638 .577833 1.683686 1.613948 1.683686c1.424658 0 2.261519-1.05604 2.261519-1.175592c0-.059776-.059776-.129514-.119552-.129514c-.049813 0-.069738 .019925-.129514 .099626c-.787049 .986301-1.872976 .986301-1.992528 .986301c-.627646 0-.896638-.488169-.896638-1.085928c0-.408468 .199253-1.374844 .537983-1.992528c.308842-.56787 .856787-.996264 1.404732-.996264c.33873 0 .71731 .129514 .856787 .398506z%27/%3E%0A%3Cpath id=%27g8-112%27 d=%27m.448319 1.215442c-.079701 .33873-.099626 .408468-.537983 .408468c-.119552 0-.229141 0-.229141 .18929c0 .079701 .049813 .119552 .129514 .119552c.268991 0 .557908-.029888 .836862-.029888c.328767 0 .667497 .029888 .986301 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.239103-.109589c-.498132 0-.498132-.069738-.498132-.159402c0-.119552 .418431-1.743462 .488169-1.992528c.129514 .288917 .408468 .637609 .916563 .637609c1.155666 0 2.400996-1.454545 2.400996-2.919054c0-.936488-.56787-1.594022-1.325031-1.594022c-.498132 0-.976339 .358655-1.305106 .747198c-.099626-.537983-.52802-.747198-.896638-.747198c-.458281 0-.647572 .388543-.737235 .56787c-.179328 .33873-.308842 .936488-.308842 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.169365 0 .308842 .079701 .308842 .458281c0 .229141-.029888 .33873-.069738 .508095l-1.115816 4.433375zm1.753425-4.323786c.069738-.268991 .33873-.547945 .518057-.697385c.348692-.308842 .637609-.37858 .806974-.37858c.398506 0 .637609 .348692 .637609 .936488s-.328767 1.733499-.508095 2.11208c-.33873 .697385-.816936 1.026152-1.185554 1.026152c-.657534 0-.787049-.826899-.787049-.886675c0-.019925 0-.039851 .029888-.159402l.488169-1.952677z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page29%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%273.874374%27 y=%270%27 xlink:href=%27%23g8-99%27/%3E%0A%3Cuse x=%278.18577%27 y=%271.494381%27 xlink:href=%27%23g0-50%27/%3E%0A%3Cuse x=%2712.65514%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2717.082948%27 y=%270%27 xlink:href=%27%23g8-112%27/%3E%0A%3Cuse x=%2722.095413%27 y=%271.494381%27 xlink:href=%27%23g0-50%27/%3E%0A%3Cuse x=%2726.564782%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( (c_2, p_2) \)" style="height: 1.0784em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" /> compares <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%279.780766pt%27 height=%276.783841pt%27 viewBox=%27-.500002 -4.789458 9.780766 6.783841%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-49%27 d=%27m2.336239-4.435367c0-.188294-.013948-.195268-.209215-.195268c-.446326 .439352-1.080946 .446326-1.366874 .446326v.251059c.167372 0 .627646 0 1.011208-.195268v3.556663c0 .230137 0 .320797-.697385 .320797h-.265006v.251059c.125529-.006974 .983313-.027895 1.241345-.027895c.216189 0 1.094894 .020922 1.248319 .027895v-.251059h-.265006c-.697385 0-.697385-.09066-.697385-.320797v-3.863512z%27/%3E%0A%3Cpath id=%27g8-99%27 d=%27m3.945205-3.785803c-.159402 0-.298879 0-.438356 .139477c-.159402 .14944-.179328 .318804-.179328 .388543c0 .239103 .179328 .348692 .368618 .348692c.288917 0 .557908-.239103 .557908-.637609c0-.488169-.468244-.856787-1.175592-.856787c-1.344956 0-2.669988 1.424658-2.669988 2.82939c0 .896638 .577833 1.683686 1.613948 1.683686c1.424658 0 2.261519-1.05604 2.261519-1.175592c0-.059776-.059776-.129514-.119552-.129514c-.049813 0-.069738 .019925-.129514 .099626c-.787049 .986301-1.872976 .986301-1.992528 .986301c-.627646 0-.896638-.488169-.896638-1.085928c0-.408468 .199253-1.374844 .537983-1.992528c.308842-.56787 .856787-.996264 1.404732-.996264c.33873 0 .71731 .129514 .856787 .398506z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page30%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-99%27/%3E%0A%3Cuse x=%274.311397%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( c_1 \)" style="height: 0.6673em; vertical-align: -0.1962em; display: inline-block" class="org-latex org-latex-inline" /> and <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%279.780766pt%27 height=%276.783841pt%27 viewBox=%27-.500002 -4.789458 9.780766 6.783841%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-50%27 d=%27m3.521793-1.26924h-.237111c-.020922 .153425-.09066 .564882-.18132 .63462c-.055791 .041843-.592777 .041843-.690411 .041843h-1.283188c.732254-.648568 .976339-.843836 1.39477-1.171606c.516065-.411457 .99726-.843836 .99726-1.506351c0-.843836-.739228-1.3599-1.63188-1.3599c-.864757 0-1.45056 .606725-1.45056 1.248319c0 .355666 .299875 .390535 .369614 .390535c.167372 0 .369614-.118555 .369614-.369614c0-.125529-.048817-.369614-.411457-.369614c.216189-.495143 .690411-.648568 1.018182-.648568c.697385 0 1.060025 .54396 1.060025 1.108842c0 .606725-.432379 1.08792-.655542 1.338979l-1.680697 1.659776c-.069738 .062765-.069738 .076712-.069738 .27198h2.873225l.209215-1.26924z%27/%3E%0A%3Cpath id=%27g8-99%27 d=%27m3.945205-3.785803c-.159402 0-.298879 0-.438356 .139477c-.159402 .14944-.179328 .318804-.179328 .388543c0 .239103 .179328 .348692 .368618 .348692c.288917 0 .557908-.239103 .557908-.637609c0-.488169-.468244-.856787-1.175592-.856787c-1.344956 0-2.669988 1.424658-2.669988 2.82939c0 .896638 .577833 1.683686 1.613948 1.683686c1.424658 0 2.261519-1.05604 2.261519-1.175592c0-.059776-.059776-.129514-.119552-.129514c-.049813 0-.069738 .019925-.129514 .099626c-.787049 .986301-1.872976 .986301-1.992528 .986301c-.627646 0-.896638-.488169-.896638-1.085928c0-.408468 .199253-1.374844 .537983-1.992528c.308842-.56787 .856787-.996264 1.404732-.996264c.33873 0 .71731 .129514 .856787 .398506z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page31%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-99%27/%3E%0A%3Cuse x=%274.311397%27 y=%271.494381%27 xlink:href=%27%23g0-50%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(
   c_2 \)" style="height: 0.6673em; vertical-align: -0.1962em; display: inline-block" class="org-latex org-latex-inline" />. If they are equal, return <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2753.097439pt%27 height=%2710.962644pt%27 viewBox=%27-.500002 -7.971982 53.097439 10.962644%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-49%27 d=%27m2.336239-4.435367c0-.188294-.013948-.195268-.209215-.195268c-.446326 .439352-1.080946 .446326-1.366874 .446326v.251059c.167372 0 .627646 0 1.011208-.195268v3.556663c0 .230137 0 .320797-.697385 .320797h-.265006v.251059c.125529-.006974 .983313-.027895 1.241345-.027895c.216189 0 1.094894 .020922 1.248319 .027895v-.251059h-.265006c-.697385 0-.697385-.09066-.697385-.320797v-3.863512z%27/%3E%0A%3Cpath id=%27g0-50%27 d=%27m3.521793-1.26924h-.237111c-.020922 .153425-.09066 .564882-.18132 .63462c-.055791 .041843-.592777 .041843-.690411 .041843h-1.283188c.732254-.648568 .976339-.843836 1.39477-1.171606c.516065-.411457 .99726-.843836 .99726-1.506351c0-.843836-.739228-1.3599-1.63188-1.3599c-.864757 0-1.45056 .606725-1.45056 1.248319c0 .355666 .299875 .390535 .369614 .390535c.167372 0 .369614-.118555 .369614-.369614c0-.125529-.048817-.369614-.411457-.369614c.216189-.495143 .690411-.648568 1.018182-.648568c.697385 0 1.060025 .54396 1.060025 1.108842c0 .606725-.432379 1.08792-.655542 1.338979l-1.680697 1.659776c-.069738 .062765-.069738 .076712-.069738 .27198h2.873225l.209215-1.26924z%27/%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-99%27 d=%27m3.945205-3.785803c-.159402 0-.298879 0-.438356 .139477c-.159402 .14944-.179328 .318804-.179328 .388543c0 .239103 .179328 .348692 .368618 .348692c.288917 0 .557908-.239103 .557908-.637609c0-.488169-.468244-.856787-1.175592-.856787c-1.344956 0-2.669988 1.424658-2.669988 2.82939c0 .896638 .577833 1.683686 1.613948 1.683686c1.424658 0 2.261519-1.05604 2.261519-1.175592c0-.059776-.059776-.129514-.119552-.129514c-.049813 0-.069738 .019925-.129514 .099626c-.787049 .986301-1.872976 .986301-1.992528 .986301c-.627646 0-.896638-.488169-.896638-1.085928c0-.408468 .199253-1.374844 .537983-1.992528c.308842-.56787 .856787-.996264 1.404732-.996264c.33873 0 .71731 .129514 .856787 .398506z%27/%3E%0A%3Cpath id=%27g8-112%27 d=%27m.448319 1.215442c-.079701 .33873-.099626 .408468-.537983 .408468c-.119552 0-.229141 0-.229141 .18929c0 .079701 .049813 .119552 .129514 .119552c.268991 0 .557908-.029888 .836862-.029888c.328767 0 .667497 .029888 .986301 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.239103-.109589c-.498132 0-.498132-.069738-.498132-.159402c0-.119552 .418431-1.743462 .488169-1.992528c.129514 .288917 .408468 .637609 .916563 .637609c1.155666 0 2.400996-1.454545 2.400996-2.919054c0-.936488-.56787-1.594022-1.325031-1.594022c-.498132 0-.976339 .358655-1.305106 .747198c-.099626-.537983-.52802-.747198-.896638-.747198c-.458281 0-.647572 .388543-.737235 .56787c-.179328 .33873-.308842 .936488-.308842 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.169365 0 .308842 .079701 .308842 .458281c0 .229141-.029888 .33873-.069738 .508095l-1.115816 4.433375zm1.753425-4.323786c.069738-.268991 .33873-.547945 .518057-.697385c.348692-.308842 .637609-.37858 .806974-.37858c.398506 0 .637609 .348692 .637609 .936488s-.328767 1.733499-.508095 2.11208c-.33873 .697385-.816936 1.026152-1.185554 1.026152c-.657534 0-.787049-.826899-.787049-.886675c0-.019925 0-.039851 .029888-.159402l.488169-1.952677z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g1-43%27 d=%27m4.07472-2.291407h2.779577c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.328767-.199253h-2.779577v-2.789539c0-.139477 0-.328767-.199253-.328767s-.199253 .18929-.199253 .328767v2.789539h-2.789539c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .328767 .199253h2.789539v2.789539c0 .139477 0 .328767 .199253 .328767s.199253-.18929 .199253-.328767v-2.789539z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page32%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%273.874374%27 y=%270%27 xlink:href=%27%23g8-99%27/%3E%0A%3Cuse x=%278.18577%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%2712.65514%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2717.082948%27 y=%270%27 xlink:href=%27%23g8-112%27/%3E%0A%3Cuse x=%2722.095413%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%2728.778648%27 y=%270%27 xlink:href=%27%23g1-43%27/%3E%0A%3Cuse x=%2738.741262%27 y=%270%27 xlink:href=%27%23g8-112%27/%3E%0A%3Cuse x=%2743.753726%27 y=%271.494381%27 xlink:href=%27%23g0-50%27/%3E%0A%3Cuse x=%2748.223096%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( (c_1, p_1 + p_2) \)" style="height: 1.0784em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" />. If they are not,
return the pair with the lowest cost.</li>
<li>Multiplication is component-wise multiplication.</li>
<li>Additive identity is the pair of additive identities.</li>
<li>Multiplicative identities is the pair of multiplicative identities.</li>
</ol>

<p>
Here is how the implementation looks:
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">struct</span> <span style="color: #531ab6; font-weight: bold;">Sel</span>{A,B} &lt;: <span style="color: #531ab6; font-weight: bold;">Semiring</span>
    a::<span style="color: #531ab6; font-weight: bold;">A</span>
    b::<span style="color: #531ab6; font-weight: bold;">B</span>
<span style="color: #005e8b; font-weight: bold;">end</span>

Base.<span style="color: #8f0075;">zero</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{Sel{A,B}}) <span style="color: #005e8b; font-weight: bold;">where</span> {A,B} = Sel{A,B}(zero(A), zero(B))
Base.<span style="color: #8f0075;">one</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{Sel{A,B}}) <span style="color: #005e8b; font-weight: bold;">where</span> {A,B} = Sel{A,B}(one(A), one(B))

Base.:*(l::<span style="color: #531ab6; font-weight: bold;">Sel</span>{A,B},r::<span style="color: #531ab6; font-weight: bold;">Sel</span>{A,B}) <span style="color: #005e8b; font-weight: bold;">where</span> {A,B} = Sel{A,B}(l.a * r.a, l.b * r.b)
Base.:+(l::<span style="color: #531ab6; font-weight: bold;">Sel</span>{A,B},r::<span style="color: #531ab6; font-weight: bold;">Sel</span>{A,B}) <span style="color: #005e8b; font-weight: bold;">where</span> {A,B} =
    <span style="color: #005e8b; font-weight: bold;">if</span> l.a == r.a
        Sel{A,B}(l.a, l.b + r.b)
    <span style="color: #005e8b; font-weight: bold;">elseif</span> l.a &lt; r.a
        l
    <span style="color: #005e8b; font-weight: bold;">elseif</span> l.a &gt; r.a
        r
    <span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<p>
What is interesting is that because this semi ring essentially inherits its
structure from two other semi rings, we can also inherit our weight functions
from the two semi rings.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #8f0075;">weight</span>(::<span style="color: #531ab6; font-weight: bold;">Type</span>{Sel{A,B}}, x) <span style="color: #005e8b; font-weight: bold;">where</span> {A,B} = Sel(weight(A, x), weight(B, x))
</code></pre>
</div>

<p>
It is this construction that lets us compute the best candidate while
remembering which is the best candidate.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">Il faut au pr&#233;alable d&#233;finir une relation d'ordre pour la composante
</span><span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">gauche.
</span>Base.<span style="color: #8f0075;">isless</span>(a::<span style="color: #531ab6; font-weight: bold;">MinCost</span>, b::<span style="color: #531ab6; font-weight: bold;">MinCost</span>) = a.cost &lt; b.cost

r = Weight(Sel{MinCost, Free{Op}}, <span style="color: #a0132f;">"carp"</span>, <span style="color: #a0132f;">"carve"</span>)
println(<span style="color: #a0132f;">"co&#251;t: $(r.a)"</span>)
<span style="color: #005e8b; font-weight: bold;">for</span> elem <span style="color: #005e8b; font-weight: bold;">in</span> r.b.choices
    println(<span style="color: #a0132f;">"s&#233;quence: $(elem)"</span>)
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<pre class="example">
co√ªt: MinCost(3)
s√©quence: Op[Keep('c'), Keep('a'), Keep('r'), Ins('v'), Del('p'), Ins('e')]
s√©quence: Op[Keep('c'), Keep('a'), Keep('r'), Del('p'), Ins('v'), Ins('e')]
s√©quence: Op[Keep('c'), Keep('a'), Keep('r'), Ins('v'), Ins('e'), Del('p')]
</pre>

<p>
It looks like there are three optimal ways to edit &ldquo;carp&rdquo; into &ldquo;carve&rdquo;.
</p>
</div>
</div>
</div>
<div id="outline-container-org6e47b70" class="outline-2">
<h2 id="org6e47b70"><span class="section-number-2">4.</span> Generalized Floyd-Warshall algorithm</h2>
<div class="outline-text-2" id="text-4">
<p>
Since the beginning, we have framed in graph terms problems that aren&rsquo;t
intrinsically graph problems. What about graph-native stuff, like shortest
path problems?
</p>
</div>
<div id="outline-container-orgedd59e4" class="outline-3">
<h3 id="orgedd59e4"><span class="section-number-3">4.1.</span> Matrix product, deconstructed</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Let there be two matrices that we can multiply
</p>

<p>
<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27613.000002pt%27 height=%2712.955172pt%27 viewBox=%27-.500002 -12.45517 613.000002 12.955172%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g4-2%27 d=%27m4.881694-3.270735c.076712-.076712 .097634-.118555 .097634-.167372c0-.111582-.09066-.174346-.167372-.174346c-.069738 0-.09066 .020922-.174346 .104608l-1.527273 1.520299l-1.534247-1.527273c-.069738-.069738-.097634-.097634-.160399-.097634c-.097634 0-.174346 .076712-.174346 .174346c0 .062765 .020922 .083686 .104608 .167372l1.520299 1.520299l-1.520299 1.520299c-.097634 .097634-.104608 .132503-.104608 .174346c0 .097634 .076712 .174346 .174346 .174346c.062765 0 .083686-.020922 .160399-.097634l1.534247-1.527273l1.590037 1.590037c.034869 .020922 .069738 .034869 .111582 .034869c.076712 0 .167372-.062765 .167372-.174346c0-.055791-.013948-.069738-.034869-.09066c-.013948-.027895-1.366874-1.380822-1.590037-1.597011l1.527273-1.527273z%27/%3E%0A%3Cpath id=%27g1-58%27 d=%27m1.912827-3.765878c0-.288917-.239103-.52802-.52802-.52802s-.52802 .239103-.52802 .52802s.239103 .52802 .52802 .52802s.52802-.239103 .52802-.52802zm0 3.237858c0-.288917-.239103-.52802-.52802-.52802s-.52802 .239103-.52802 .52802s.239103 .52802 .52802 .52802s.52802-.239103 .52802-.52802z%27/%3E%0A%3Cpath id=%27g7-97%27 d=%27m2.942964-2.66401c-.146451-.230137-.383562-.411457-.718306-.411457c-.892653 0-1.799253 .983313-1.799253 1.987547c0 .676463 .4533 1.157659 1.053051 1.157659c.376588 0 .711333-.216189 .990286-.488169c.132503 .418431 .536986 .488169 .718306 .488169c.251059 0 .425405-.153425 .550934-.369614c.153425-.27198 .244085-.669489 .244085-.697385c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .027895-.153425 .216189c-.083686 .334745-.216189 .746202-.509091 .746202c-.18132 0-.230137-.153425-.230137-.341719c0-.118555 .055791-.369614 .104608-.550934c.048817-.188294 .118555-.474222 .153425-.627646l.139477-.530012c.041843-.18132 .125529-.509091 .125529-.54396c0-.153425-.125529-.223163-.237111-.223163c-.118555 0-.278954 .083686-.320797 .278954zm-.446326 1.792279c-.048817 .195268-.202242 .334745-.355666 .467248c-.062765 .055791-.341719 .278954-.641594 .278954c-.258032 0-.509091-.18132-.509091-.676463c0-.369614 .202242-1.136737 .36264-1.415691c.320797-.557908 .676463-.662516 .871731-.662516c.488169 0 .620672 .530012 .620672 .606725c0 .027895-.013948 .076712-.020922 .097634l-.327771 1.30411z%27/%3E%0A%3Cpath id=%27g7-98%27 d=%27m1.841096-4.630635c.006974-.013948 .027895-.104608 .027895-.111582c0-.034869-.027895-.097634-.111582-.097634c-.139477 0-.718306 .055791-.892653 .069738c-.055791 .006974-.153425 .013948-.153425 .160399c0 .097634 .097634 .097634 .18132 .097634c.334745 0 .334745 .048817 .334745 .104608c0 .048817-.069738 .327771-.111582 .488169l-.160399 .641594c-.062765 .237111-.446326 1.764384-.460274 1.855044c-.034869 .167372-.034869 .258032-.034869 .341719c0 .704359 .446326 1.150685 1.025156 1.150685c.871731 0 1.799253-.948443 1.799253-1.980573c0-.81594-.564882-1.164633-1.046077-1.164633c-.36264 0-.669489 .202242-.878705 .383562l.481196-1.93873zm-.348692 4.505106c-.341719 0-.536986-.299875-.536986-.711333c0-.258032 .062765-.495143 .258032-1.283188c.041843-.132503 .041843-.146451 .174346-.299875c.265006-.306849 .578829-.460274 .829888-.460274c.27198 0 .509091 .202242 .509091 .676463c0 .285928-.153425 .99726-.36264 1.401743c-.167372 .341719-.516065 .676463-.871731 .676463z%27/%3E%0A%3Cpath id=%27g2-82%27 d=%27m2.669988-3.128269h.358655l1.494396 2.311333c.099626 .159402 .33873 .547945 .448319 .697385c.069738 .119552 .099626 .119552 .328767 .119552h1.374844c.179328 0 .328767 0 .328767-.179328c0-.079701-.059776-.14944-.14944-.169365c-.368618-.079701-.856787-.737235-1.09589-1.05604c-.069738-.099626-.56787-.757161-1.235367-1.833126c.886675-.159402 1.743462-.537983 1.743462-1.723537c0-1.384807-1.464508-1.863014-2.6401-1.863014h-3.128269c-.179328 0-.33873 0-.33873 .179328c0 .169365 .18929 .169365 .268991 .169365c.56787 0 .617684 .069738 .617684 .56787v4.991283c0 .498132-.049813 .56787-.617684 .56787c-.079701 0-.268991 0-.268991 .169365c0 .179328 .159402 .179328 .33873 .179328h2.729763c.179328 0 .328767 0 .328767-.179328c0-.169365-.169365-.169365-.278954-.169365c-.56787 0-.607721-.079701-.607721-.56787v-2.211706zm1.92279-.488169c.278954-.368618 .308842-.896638 .308842-1.334994c0-.478207-.059776-1.006227-.37858-1.414695c.408468 .089664 1.39477 .398506 1.39477 1.404732c0 .647572-.298879 1.155666-1.325031 1.344956zm-1.92279-2.321295c0-.209215 0-.537983 .617684-.537983c.846824 0 1.265255 .348692 1.265255 1.524284c0 1.285181-.308842 1.474471-1.882939 1.474471v-2.460772zm-1.354919 5.589041c.079701-.179328 .079701-.458281 .079701-.547945v-5.031133c0-.099626 0-.368618-.079701-.547945h1.135741c-.129514 .159402-.129514 .358655-.129514 .508095v5.070984c0 .099626 0 .368618 .079701 .547945h-1.085928zm2.122042-2.779577c.069738-.009963 .109589-.019925 .18929-.019925c.14944 0 .368618-.019925 .518057-.039851c.14944 .239103 1.225405 2.012453 2.052304 2.839352h-.966376l-1.793275-2.779577z%27/%3E%0A%3Cpath id=%27g8-77%27 d=%27m9.225405-6.03736c.089664-.358655 .109589-.458281 .856787-.458281c.229141 0 .318804 0 .318804-.199253c0-.109589-.099626-.109589-.268991-.109589h-1.315068c-.259029 0-.268991 0-.388543 .18929l-3.636364 5.678705l-.777086-5.638854c-.029888-.229141-.049813-.229141-.308842-.229141h-1.364882c-.18929 0-.298879 0-.298879 .18929c0 .119552 .089664 .119552 .288917 .119552c.129514 0 .308842 .009963 .428394 .019925c.159402 .019925 .219178 .049813 .219178 .159402c0 .039851-.009963 .069738-.039851 .18929l-1.265255 5.070984c-.099626 .398506-.268991 .71731-1.075965 .747198c-.049813 0-.179328 .009963-.179328 .18929c0 .089664 .059776 .119552 .139477 .119552c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.109589-.109589-.179328-.109589c-.56787-.009963-.67746-.209215-.67746-.438356c0-.069738 .009963-.119552 .039851-.229141l1.354919-5.429639h.009963l.856787 6.176837c.019925 .119552 .029888 .229141 .14944 .229141c.109589 0 .169365-.109589 .219178-.179328l4.024907-6.306351h.009963l-1.424658 5.708593c-.099626 .388543-.119552 .468244-.9066 .468244c-.169365 0-.278954 0-.278954 .18929c0 .119552 .119552 .119552 .14944 .119552c.278954 0 .956413-.029888 1.235367-.029888c.408468 0 .836862 .029888 1.24533 .029888c.059776 0 .18929 0 .18929-.199253c0-.109589-.089664-.109589-.278954-.109589c-.368618 0-.647572 0-.647572-.179328c0-.039851 0-.059776 .049813-.239103l1.325031-5.310087z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page33%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%27285.600796%27 y=%270%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27299.119471%27 y=%270%27 xlink:href=%27%23g1-58%27/%3E%0A%3Cuse x=%27304.654212%27 y=%270%27 xlink:href=%27%23g2-82%27/%3E%0A%3Cuse x=%27311.849472%27 y=%27-4.113496%27 xlink:href=%27%23g7-97%27/%3E%0A%3Cuse x=%27316.170916%27 y=%27-4.113496%27 xlink:href=%27%23g4-2%27/%3E%0A%3Cuse x=%27322.397595%27 y=%27-4.113496%27 xlink:href=%27%23g7-98%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\[ M : \mathbb{R}^{a \times b} \]" style="height: 1.2744em; display: block" class="org-latex org-latex-block" />
</p>

<p>
<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27613.000002pt%27 height=%2712.955172pt%27 viewBox=%27-.500002 -12.45517 613.000002 12.955172%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g4-2%27 d=%27m4.881694-3.270735c.076712-.076712 .097634-.118555 .097634-.167372c0-.111582-.09066-.174346-.167372-.174346c-.069738 0-.09066 .020922-.174346 .104608l-1.527273 1.520299l-1.534247-1.527273c-.069738-.069738-.097634-.097634-.160399-.097634c-.097634 0-.174346 .076712-.174346 .174346c0 .062765 .020922 .083686 .104608 .167372l1.520299 1.520299l-1.520299 1.520299c-.097634 .097634-.104608 .132503-.104608 .174346c0 .097634 .076712 .174346 .174346 .174346c.062765 0 .083686-.020922 .160399-.097634l1.534247-1.527273l1.590037 1.590037c.034869 .020922 .069738 .034869 .111582 .034869c.076712 0 .167372-.062765 .167372-.174346c0-.055791-.013948-.069738-.034869-.09066c-.013948-.027895-1.366874-1.380822-1.590037-1.597011l1.527273-1.527273z%27/%3E%0A%3Cpath id=%27g1-58%27 d=%27m1.912827-3.765878c0-.288917-.239103-.52802-.52802-.52802s-.52802 .239103-.52802 .52802s.239103 .52802 .52802 .52802s.52802-.239103 .52802-.52802zm0 3.237858c0-.288917-.239103-.52802-.52802-.52802s-.52802 .239103-.52802 .52802s.239103 .52802 .52802 .52802s.52802-.239103 .52802-.52802z%27/%3E%0A%3Cpath id=%27g7-98%27 d=%27m1.841096-4.630635c.006974-.013948 .027895-.104608 .027895-.111582c0-.034869-.027895-.097634-.111582-.097634c-.139477 0-.718306 .055791-.892653 .069738c-.055791 .006974-.153425 .013948-.153425 .160399c0 .097634 .097634 .097634 .18132 .097634c.334745 0 .334745 .048817 .334745 .104608c0 .048817-.069738 .327771-.111582 .488169l-.160399 .641594c-.062765 .237111-.446326 1.764384-.460274 1.855044c-.034869 .167372-.034869 .258032-.034869 .341719c0 .704359 .446326 1.150685 1.025156 1.150685c.871731 0 1.799253-.948443 1.799253-1.980573c0-.81594-.564882-1.164633-1.046077-1.164633c-.36264 0-.669489 .202242-.878705 .383562l.481196-1.93873zm-.348692 4.505106c-.341719 0-.536986-.299875-.536986-.711333c0-.258032 .062765-.495143 .258032-1.283188c.041843-.132503 .041843-.146451 .174346-.299875c.265006-.306849 .578829-.460274 .829888-.460274c.27198 0 .509091 .202242 .509091 .676463c0 .285928-.153425 .99726-.36264 1.401743c-.167372 .341719-.516065 .676463-.871731 .676463z%27/%3E%0A%3Cpath id=%27g7-99%27 d=%27m3.054545-2.670984c-.251059 .041843-.355666 .237111-.355666 .390535c0 .188294 .146451 .258032 .27198 .258032c.153425 0 .397509-.111582 .397509-.446326c0-.474222-.54396-.606725-.920548-.606725c-1.046077 0-2.015442 .962391-2.015442 1.931756c0 .599751 .418431 1.21345 1.290162 1.21345c1.17858 0 1.729514-.690411 1.729514-.788045c0-.041843-.062765-.118555-.118555-.118555c-.041843 0-.055791 .013948-.111582 .069738c-.54396 .641594-1.3599 .641594-1.48543 .641594c-.502117 0-.72528-.341719-.72528-.774097c0-.202242 .097634-.962391 .460274-1.443587c.265006-.341719 .627646-.536986 .976339-.536986c.097634 0 .432379 .013948 .606725 .209215z%27/%3E%0A%3Cpath id=%27g2-82%27 d=%27m2.669988-3.128269h.358655l1.494396 2.311333c.099626 .159402 .33873 .547945 .448319 .697385c.069738 .119552 .099626 .119552 .328767 .119552h1.374844c.179328 0 .328767 0 .328767-.179328c0-.079701-.059776-.14944-.14944-.169365c-.368618-.079701-.856787-.737235-1.09589-1.05604c-.069738-.099626-.56787-.757161-1.235367-1.833126c.886675-.159402 1.743462-.537983 1.743462-1.723537c0-1.384807-1.464508-1.863014-2.6401-1.863014h-3.128269c-.179328 0-.33873 0-.33873 .179328c0 .169365 .18929 .169365 .268991 .169365c.56787 0 .617684 .069738 .617684 .56787v4.991283c0 .498132-.049813 .56787-.617684 .56787c-.079701 0-.268991 0-.268991 .169365c0 .179328 .159402 .179328 .33873 .179328h2.729763c.179328 0 .328767 0 .328767-.179328c0-.169365-.169365-.169365-.278954-.169365c-.56787 0-.607721-.079701-.607721-.56787v-2.211706zm1.92279-.488169c.278954-.368618 .308842-.896638 .308842-1.334994c0-.478207-.059776-1.006227-.37858-1.414695c.408468 .089664 1.39477 .398506 1.39477 1.404732c0 .647572-.298879 1.155666-1.325031 1.344956zm-1.92279-2.321295c0-.209215 0-.537983 .617684-.537983c.846824 0 1.265255 .348692 1.265255 1.524284c0 1.285181-.308842 1.474471-1.882939 1.474471v-2.460772zm-1.354919 5.589041c.079701-.179328 .079701-.458281 .079701-.547945v-5.031133c0-.099626 0-.368618-.079701-.547945h1.135741c-.129514 .159402-.129514 .358655-.129514 .508095v5.070984c0 .099626 0 .368618 .079701 .547945h-1.085928zm2.122042-2.779577c.069738-.009963 .109589-.019925 .18929-.019925c.14944 0 .368618-.019925 .518057-.039851c.14944 .239103 1.225405 2.012453 2.052304 2.839352h-.966376l-1.793275-2.779577z%27/%3E%0A%3Cpath id=%27g8-78%27 d=%27m7.531756-5.758406c.099626-.398506 .278954-.707347 1.075965-.737235c.049813 0 .169365-.009963 .169365-.199253c0-.009963 0-.109589-.129514-.109589c-.328767 0-.67746 .029888-1.006227 .029888c-.33873 0-.687422-.029888-1.016189-.029888c-.059776 0-.179328 0-.179328 .199253c0 .109589 .099626 .109589 .179328 .109589c.56787 .009963 .67746 .219178 .67746 .438356c0 .029888-.019925 .179328-.029888 .209215l-1.115816 4.433375l-2.201743-5.200498c-.079701-.179328-.089664-.18929-.318804-.18929h-1.334994c-.199253 0-.288917 0-.288917 .199253c0 .109589 .089664 .109589 .278954 .109589c.049813 0 .67746 0 .67746 .089664l-1.334994 5.349938c-.099626 .398506-.268991 .71731-1.075965 .747198c-.059776 0-.169365 .009963-.169365 .199253c0 .069738 .049813 .109589 .129514 .109589c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.099626-.089664-.109589-.199253-.109589c-.577833-.019925-.657534-.239103-.657534-.438356c0-.069738 .009963-.119552 .039851-.229141l1.315068-5.260274c.039851 .059776 .039851 .079701 .089664 .179328l2.480697 5.867995c.069738 .169365 .099626 .18929 .18929 .18929c.109589 0 .109589-.029888 .159402-.209215l1.39477-5.549191z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page34%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%27286.811542%27 y=%270%27 xlink:href=%27%23g8-78%27/%3E%0A%3Cuse x=%27298.669764%27 y=%270%27 xlink:href=%27%23g1-58%27/%3E%0A%3Cuse x=%27304.204505%27 y=%270%27 xlink:href=%27%23g2-82%27/%3E%0A%3Cuse x=%27311.399765%27 y=%27-4.113496%27 xlink:href=%27%23g7-98%27/%3E%0A%3Cuse x=%27314.903303%27 y=%27-4.113496%27 xlink:href=%27%23g4-2%27/%3E%0A%3Cuse x=%27321.129982%27 y=%27-4.113496%27 xlink:href=%27%23g7-99%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\[ N : \mathbb{R}^{b \times c} \]" style="height: 1.2744em; display: block" class="org-latex org-latex-block" />
</p>

<p>
The formula to evaluate their product is the following:
</p>

<p>
<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27613.000002pt%27 height=%2734.395659pt%27 viewBox=%27-.500002 -33.895657 613.000002 34.395659%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-49%27 d=%27m2.336239-4.435367c0-.188294-.013948-.195268-.209215-.195268c-.446326 .439352-1.080946 .446326-1.366874 .446326v.251059c.167372 0 .627646 0 1.011208-.195268v3.556663c0 .230137 0 .320797-.697385 .320797h-.265006v.251059c.125529-.006974 .983313-.027895 1.241345-.027895c.216189 0 1.094894 .020922 1.248319 .027895v-.251059h-.265006c-.697385 0-.697385-.09066-.697385-.320797v-3.863512z%27/%3E%0A%3Cpath id=%27g0-61%27 d=%27m5.355915-2.343213c.104608 0 .265006 0 .265006-.174346c0-.167372-.167372-.167372-.258032-.167372h-4.616687c-.09066 0-.258032 0-.258032 .167372c0 .174346 .160399 .174346 .265006 .174346h4.60274zm.006974 1.534247c.09066 0 .258032 0 .258032-.167372c0-.174346-.160399-.174346-.265006-.174346h-4.60274c-.104608 0-.265006 0-.265006 .174346c0 .167372 .167372 .167372 .258032 .167372h4.616687z%27/%3E%0A%3Cpath id=%27g3-88%27 d=%27m12.612702 13.947696l1.205479-3.188045h-.249066c-.388543 1.036115-1.444583 1.713574-2.590286 2.012453c-.209215 .049813-1.185554 .308842-3.098381 .308842h-6.007472l5.070984-5.947696c.069738-.079701 .089664-.109589 .089664-.159402c0-.019925 0-.049813-.069738-.14944l-4.64259-6.346202h5.459527c1.334994 0 2.241594 .139477 2.331258 .159402c.537983 .079701 1.404732 .249066 2.191781 .747198c.249066 .159402 .926526 .607721 1.265255 1.414695h.249066l-1.205479-2.799502h-11.775841c-.229141 0-.239103 .009963-.268991 .069738c-.009963 .029888-.009963 .219178-.009963 .328767l5.270237 7.212951l-5.160648 6.047323c-.099626 .119552-.099626 .169365-.099626 .179328c0 .109589 .089664 .109589 .268991 .109589h11.775841z%27/%3E%0A%3Cpath id=%27g7-98%27 d=%27m1.841096-4.630635c.006974-.013948 .027895-.104608 .027895-.111582c0-.034869-.027895-.097634-.111582-.097634c-.139477 0-.718306 .055791-.892653 .069738c-.055791 .006974-.153425 .013948-.153425 .160399c0 .097634 .097634 .097634 .18132 .097634c.334745 0 .334745 .048817 .334745 .104608c0 .048817-.069738 .327771-.111582 .488169l-.160399 .641594c-.062765 .237111-.446326 1.764384-.460274 1.855044c-.034869 .167372-.034869 .258032-.034869 .341719c0 .704359 .446326 1.150685 1.025156 1.150685c.871731 0 1.799253-.948443 1.799253-1.980573c0-.81594-.564882-1.164633-1.046077-1.164633c-.36264 0-.669489 .202242-.878705 .383562l.481196-1.93873zm-.348692 4.505106c-.341719 0-.536986-.299875-.536986-.711333c0-.258032 .062765-.495143 .258032-1.283188c.041843-.132503 .041843-.146451 .174346-.299875c.265006-.306849 .578829-.460274 .829888-.460274c.27198 0 .509091 .202242 .509091 .676463c0 .285928-.153425 .99726-.36264 1.401743c-.167372 .341719-.516065 .676463-.871731 .676463z%27/%3E%0A%3Cpath id=%27g7-105%27 d=%27m2.259527-4.358655c0-.111582-.083686-.265006-.278954-.265006c-.188294 0-.390535 .18132-.390535 .383562c0 .118555 .09066 .265006 .278954 .265006c.202242 0 .390535-.195268 .390535-.383562zm-1.422665 3.542715c-.027895 .09066-.062765 .174346-.062765 .292902c0 .327771 .278954 .592777 .662516 .592777c.697385 0 1.004234-.962391 1.004234-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .041843-.132503 .118555c-.160399 .557908-.467248 .843836-.739228 .843836c-.139477 0-.174346-.09066-.174346-.244085c0-.160399 .048817-.292902 .111582-.446326c.069738-.188294 .146451-.376588 .223163-.557908c.062765-.167372 .313823-.801993 .341719-.885679c.020922-.069738 .041843-.153425 .041843-.223163c0-.327771-.278954-.592777-.662516-.592777c-.690411 0-1.011208 .948443-1.011208 1.066999c0 .09066 .097634 .09066 .118555 .09066c.097634 0 .104608-.034869 .125529-.111582c.18132-.599751 .488169-.850809 .746202-.850809c.111582 0 .174346 .055791 .174346 .244085c0 .160399-.041843 .265006-.216189 .697385l-.439352 1.12279z%27/%3E%0A%3Cpath id=%27g7-106%27 d=%27m3.061519-4.358655c0-.118555-.09066-.265006-.278954-.265006c-.202242 0-.390535 .195268-.390535 .383562c0 .111582 .083686 .265006 .278954 .265006c.188294 0 .390535-.18132 .390535-.383562zm-1.478456 4.700374c-.118555 .481196-.488169 .885679-.899626 .885679c-.09066 0-.174346-.013948-.251059-.041843c.18132-.083686 .237111-.251059 .237111-.355666c0-.167372-.132503-.258032-.27198-.258032c-.216189 0-.397509 .188294-.397509 .411457c0 .265006 .27198 .439352 .690411 .439352s1.234371-.251059 1.45056-1.101868l.627646-2.496638c.020922-.076712 .034869-.139477 .034869-.244085c0-.383562-.327771-.655542-.746202-.655542c-.774097 0-1.220423 .969365-1.220423 1.066999c0 .09066 .097634 .09066 .118555 .09066c.083686 0 .09066-.020922 .139477-.125529c.174346-.404483 .536986-.836862 .941469-.836862c.174346 0 .237111 .118555 .237111 .341719c0 .076712-.013948 .174346-.020922 .209215l-.669489 2.670984z%27/%3E%0A%3Cpath id=%27g7-107%27 d=%27m2.182814-4.630635c.006974-.013948 .027895-.104608 .027895-.111582c0-.034869-.027895-.097634-.111582-.097634c-.139477 0-.718306 .055791-.892653 .069738c-.055791 .006974-.153425 .013948-.153425 .160399c0 .097634 .097634 .097634 .18132 .097634c.334745 0 .334745 .048817 .334745 .104608c0 .048817-.013948 .09066-.027895 .153425l-.983313 3.947198c-.034869 .125529-.034869 .139477-.034869 .153425c0 .104608 .083686 .223163 .237111 .223163c.188294 0 .278954-.139477 .320797-.292902c.013948-.027895 .313823-1.255293 .341719-1.352927c.495143 .048817 .892653 .209215 .892653 .571856c0 .034869 0 .069738-.013948 .139477c-.027895 .104608-.027895 .139477-.027895 .216189c0 .495143 .404483 .718306 .739228 .718306c.676463 0 .885679-1.060025 .885679-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .034869-.139477 .167372c-.083686 .299875-.27198 .795019-.613699 .795019c-.188294 0-.244085-.174346-.244085-.36264c0-.118555 0-.132503 .041843-.313823c.006974-.020922 .034869-.139477 .034869-.216189c0-.620672-.836862-.718306-1.129763-.739228c.202242-.125529 .460274-.355666 .578829-.460274c.355666-.334745 .704359-.662516 1.094894-.662516c.083686 0 .174346 .020922 .230137 .09066c-.299875 .048817-.36264 .285928-.36264 .390535c0 .153425 .118555 .258032 .278954 .258032c.188294 0 .397509-.153425 .397509-.446326c0-.230137-.167372-.488169-.536986-.488169c-.397509 0-.760149 .285928-1.115816 .613699c-.292902 .278954-.523039 .495143-.808966 .613699l.690411-2.782565z%27/%3E%0A%3Cpath id=%27g8-77%27 d=%27m9.225405-6.03736c.089664-.358655 .109589-.458281 .856787-.458281c.229141 0 .318804 0 .318804-.199253c0-.109589-.099626-.109589-.268991-.109589h-1.315068c-.259029 0-.268991 0-.388543 .18929l-3.636364 5.678705l-.777086-5.638854c-.029888-.229141-.049813-.229141-.308842-.229141h-1.364882c-.18929 0-.298879 0-.298879 .18929c0 .119552 .089664 .119552 .288917 .119552c.129514 0 .308842 .009963 .428394 .019925c.159402 .019925 .219178 .049813 .219178 .159402c0 .039851-.009963 .069738-.039851 .18929l-1.265255 5.070984c-.099626 .398506-.268991 .71731-1.075965 .747198c-.049813 0-.179328 .009963-.179328 .18929c0 .089664 .059776 .119552 .139477 .119552c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.109589-.109589-.179328-.109589c-.56787-.009963-.67746-.209215-.67746-.438356c0-.069738 .009963-.119552 .039851-.229141l1.354919-5.429639h.009963l.856787 6.176837c.019925 .119552 .029888 .229141 .14944 .229141c.109589 0 .169365-.109589 .219178-.179328l4.024907-6.306351h.009963l-1.424658 5.708593c-.099626 .388543-.119552 .468244-.9066 .468244c-.169365 0-.278954 0-.278954 .18929c0 .119552 .119552 .119552 .14944 .119552c.278954 0 .956413-.029888 1.235367-.029888c.408468 0 .836862 .029888 1.24533 .029888c.059776 0 .18929 0 .18929-.199253c0-.109589-.089664-.109589-.278954-.109589c-.368618 0-.647572 0-.647572-.179328c0-.039851 0-.059776 .049813-.239103l1.325031-5.310087z%27/%3E%0A%3Cpath id=%27g8-78%27 d=%27m7.531756-5.758406c.099626-.398506 .278954-.707347 1.075965-.737235c.049813 0 .169365-.009963 .169365-.199253c0-.009963 0-.109589-.129514-.109589c-.328767 0-.67746 .029888-1.006227 .029888c-.33873 0-.687422-.029888-1.016189-.029888c-.059776 0-.179328 0-.179328 .199253c0 .109589 .099626 .109589 .179328 .109589c.56787 .009963 .67746 .219178 .67746 .438356c0 .029888-.019925 .179328-.029888 .209215l-1.115816 4.433375l-2.201743-5.200498c-.079701-.179328-.089664-.18929-.318804-.18929h-1.334994c-.199253 0-.288917 0-.288917 .199253c0 .109589 .089664 .109589 .278954 .109589c.049813 0 .67746 0 .67746 .089664l-1.334994 5.349938c-.099626 .398506-.268991 .71731-1.075965 .747198c-.059776 0-.169365 .009963-.169365 .199253c0 .069738 .049813 .109589 .129514 .109589c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.099626-.089664-.109589-.199253-.109589c-.577833-.019925-.657534-.239103-.657534-.438356c0-.069738 .009963-.119552 .039851-.229141l1.315068-5.260274c.039851 .059776 .039851 .079701 .089664 .179328l2.480697 5.867995c.069738 .169365 .099626 .18929 .18929 .18929c.109589 0 .109589-.029888 .159402-.209215l1.39477-5.549191z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g1-61%27 d=%27m6.844334-3.257783c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.967621c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h5.947696zm.009963 1.932752c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.33873-.199253h-5.947696c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.967621z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page35%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%27257.033181%27 y=%27-14.106844%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27260.907554%27 y=%27-14.106844%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27271.658897%27 y=%27-14.106844%27 xlink:href=%27%23g8-78%27/%3E%0A%3Cuse x=%27280.749787%27 y=%27-14.106844%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%27284.624161%27 y=%27-12.612463%27 xlink:href=%27%23g7-105%27/%3E%0A%3Cuse x=%27287.442888%27 y=%27-12.612463%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27295.111992%27 y=%27-14.106844%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%27311.071572%27 y=%27-26.560189%27 xlink:href=%27%23g7-98%27/%3E%0A%3Cuse x=%27305.628072%27 y=%27-23.571413%27 xlink:href=%27%23g3-88%27/%3E%0A%3Cuse x=%27305.929873%27 y=%27-2.352278%27 xlink:href=%27%23g7-106%27/%3E%0A%3Cuse x=%27309.629562%27 y=%27-2.352278%27 xlink:href=%27%23g0-61%27/%3E%0A%3Cuse x=%27315.745546%27 y=%27-2.352278%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27321.678981%27 y=%27-14.106844%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27331.344141%27 y=%27-12.612463%27 xlink:href=%27%23g7-105%27/%3E%0A%3Cuse x=%27334.162868%27 y=%27-12.612463%27 xlink:href=%27%23g7-106%27/%3E%0A%3Cuse x=%27338.360676%27 y=%27-14.106844%27 xlink:href=%27%23g8-78%27/%3E%0A%3Cuse x=%27346.365383%27 y=%27-12.612463%27 xlink:href=%27%23g7-106%27/%3E%0A%3Cuse x=%27350.065072%27 y=%27-12.612463%27 xlink:href=%27%23g7-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\[ (MN)_{ik} = \sum_{j=1}^{b} M_{ij}N_{jk} \]" style="height: 3.3834em; display: block" class="org-latex org-latex-block" />
</p>

<p>
Do you notice anything interesting? What properties should the component of
matrices of something be so that they can be multiplied?
</p>
</div>
</div>
<div id="outline-container-orgd149df6" class="outline-3">
<h3 id="orgd149df6"><span class="section-number-3">4.2.</span> Adjacency matrices, revisited</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Let there be a directed graph with weights on the edges (you can ignore the
weights, for now):
</p>


<div id="orgce4114b" class="figure">
<p><img src="./assets/some-graph.svg" alt="some-graph.svg" class="org-svg" />
</p>
</div>

<p>
You might already know this, but it is very useful to study such a graph through
its adjacency matrix. This matrix is constructed by writing the relationship
between the <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%274.432262pt%27 height=%277.570609pt%27 viewBox=%27-.500002 -7.070607 4.432262 7.570609%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-105%27 d=%27m2.82939-6.22665c0-.199253-.139477-.358655-.368618-.358655c-.268991 0-.537983 .259029-.537983 .52802c0 .18929 .139477 .358655 .37858 .358655c.229141 0 .52802-.229141 .52802-.52802zm-.757161 3.745953c.119552-.288917 .119552-.308842 .219178-.577833c.079701-.199253 .129514-.33873 .129514-.52802c0-.448319-.318804-.816936-.816936-.816936c-.936488 0-1.315068 1.444583-1.315068 1.534247c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.019925 .159402-.179328c.268991-.936488 .667497-1.235367 1.006227-1.235367c.079701 0 .249066 0 .249066 .318804c0 .209215-.069738 .418431-.109589 .518057c-.079701 .259029-.52802 1.414695-.687422 1.843088c-.099626 .259029-.229141 .587796-.229141 .797011c0 .468244 .33873 .816936 .816936 .816936c.936488 0 1.305106-1.444583 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.179328 .627646-.508095 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .059776-.388543 .288917-.996264l.388543-1.046077z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page36%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-105%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( i \)" style="height: 0.7447em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> node and the <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%275.672971pt%27 height=%279.507788pt%27 viewBox=%27-.500002 -7.070607 5.672971 9.507788%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-106%27 d=%27m3.955168-6.22665c0-.18929-.139477-.358655-.37858-.358655c-.229141 0-.52802 .229141-.52802 .52802c0 .199253 .139477 .358655 .368618 .358655c.268991 0 .537983-.259029 .537983-.52802zm-2.002491 6.724782c-.18929 .757161-.667497 1.325031-1.225405 1.325031c-.059776 0-.209215 0-.388543-.089664c.298879-.069738 .448319-.328767 .448319-.52802c0-.159402-.109589-.348692-.37858-.348692c-.249066 0-.537983 .209215-.537983 .56787c0 .398506 .398506 .617684 .876712 .617684c.697385 0 1.62391-.52802 1.872976-1.514321l.916563-3.646326c.049813-.199253 .049813-.33873 .049813-.368618c0-.56787-.418431-.916563-.916563-.916563c-1.016189 0-1.58406 1.444583-1.58406 1.534247c0 .099626 .099626 .099626 .119552 .099626c.089664 0 .099626-.009963 .179328-.199253c.249066-.607721 .707347-1.215442 1.255293-1.215442c.139477 0 .318804 .039851 .318804 .458281c0 .229141-.029888 .33873-.069738 .508095l-.936488 3.716065z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page37%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-106%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( j \)" style="height: 0.9353em; vertical-align: -0.2397em; display: inline-block" class="org-latex org-latex-inline" /> nod at a matrix&rsquo;s <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%279.105229pt%27 height=%279.507788pt%27 viewBox=%27-.500002 -7.070607 9.105229 9.507788%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-105%27 d=%27m2.82939-6.22665c0-.199253-.139477-.358655-.368618-.358655c-.268991 0-.537983 .259029-.537983 .52802c0 .18929 .139477 .358655 .37858 .358655c.229141 0 .52802-.229141 .52802-.52802zm-.757161 3.745953c.119552-.288917 .119552-.308842 .219178-.577833c.079701-.199253 .129514-.33873 .129514-.52802c0-.448319-.318804-.816936-.816936-.816936c-.936488 0-1.315068 1.444583-1.315068 1.534247c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.019925 .159402-.179328c.268991-.936488 .667497-1.235367 1.006227-1.235367c.079701 0 .249066 0 .249066 .318804c0 .209215-.069738 .418431-.109589 .518057c-.079701 .259029-.52802 1.414695-.687422 1.843088c-.099626 .259029-.229141 .587796-.229141 .797011c0 .468244 .33873 .816936 .816936 .816936c.936488 0 1.305106-1.444583 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.179328 .627646-.508095 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .059776-.388543 .288917-.996264l.388543-1.046077z%27/%3E%0A%3Cpath id=%27g8-106%27 d=%27m3.955168-6.22665c0-.18929-.139477-.358655-.37858-.358655c-.229141 0-.52802 .229141-.52802 .52802c0 .199253 .139477 .358655 .368618 .358655c.268991 0 .537983-.259029 .537983-.52802zm-2.002491 6.724782c-.18929 .757161-.667497 1.325031-1.225405 1.325031c-.059776 0-.209215 0-.388543-.089664c.298879-.069738 .448319-.328767 .448319-.52802c0-.159402-.109589-.348692-.37858-.348692c-.249066 0-.537983 .209215-.537983 .56787c0 .398506 .398506 .617684 .876712 .617684c.697385 0 1.62391-.52802 1.872976-1.514321l.916563-3.646326c.049813-.199253 .049813-.33873 .049813-.368618c0-.56787-.418431-.916563-.916563-.916563c-1.016189 0-1.58406 1.444583-1.58406 1.534247c0 .099626 .099626 .099626 .119552 .099626c.089664 0 .099626-.009963 .179328-.199253c.249066-.607721 .707347-1.215442 1.255293-1.215442c.139477 0 .318804 .039851 .318804 .458281c0 .229141-.029888 .33873-.069738 .508095l-.936488 3.716065z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page38%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-105%27/%3E%0A%3Cuse x=%273.432258%27 y=%270%27 xlink:href=%27%23g8-106%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( ij \)" style="height: 0.9353em; vertical-align: -0.2397em; display: inline-block" class="org-latex org-latex-inline" />&rsquo;th
component. Usually, that means putting a one where there is an edge and a zero
otherwise.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code>A = [0  1  0  0  1
     0  0  1  1  0
     0  0  0  1  0
     0  0  0  0  0
     0  0  1  0  0]
</code></pre>
</div>

<p>
On neat computation we can do using this matrix is counting the number <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.979929pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.979929 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page39%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( n
\)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />-length paths from <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.266144pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.266144 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page40%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( a \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> to <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%275.275627pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 5.275627 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page41%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( b \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> by taking the <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.979929pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.979929 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page86%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( n \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />&rsquo;th power of the
adjacency matrix.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code>println(repr(<span style="color: #a0132f;">"text/plain"</span>, A^2))
</code></pre>
</div>

<pre class="example">
5√ó5 Matrix{Int64}:
 0  0  2  1  0
 0  0  0  1  0
 0  0  0  0  0
 0  0  0  0  0
 0  0  0  1  0
</pre>

<p>
We can see that there are two paths of length 2 from node 1 to node 3. But
doesn&rsquo;t this operation seem familiar? It should. The way we use this adjacency
matrix is very similar to how we used the <code>Count</code> semi ring earlier.
</p>
</div>
</div>
<div id="outline-container-orgc0d72a4" class="outline-3">
<h3 id="orgc0d72a4"><span class="section-number-3">4.3.</span> Generalized adjacency matrix</h3>
<div class="outline-text-3" id="text-4-3">
<p>
The two previous remarks&rsquo; purpose were to bring us to the following question:
</p>

<blockquote>
<p>
If we consider a graph where the weights live in some semi ring, and we consider
its adjacency matrix where the components are those weighs, and we observe the
successive powers of this matrix, what do they mean?
</p>
</blockquote>

<p>
In fact, this gives a way to compute the same kind of things the Floyd-Warshall
algorithm would let us compute. Before we understand why, let&rsquo;s do some more
experiments on this construction:
</p>

<p>
Let&rsquo;s take a graph where the weight of each edge is the name of the edge. We
will be using the free semi ring.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">struct</span> <span style="color: #531ab6; font-weight: bold;">Edge</span>
    name::<span style="color: #531ab6; font-weight: bold;">String</span>
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<p>
The adjacency matrix of this graph will look like this:
</p>

<div class="org-src-container">
<pre class="src src-julia"><code>S = Free{Edge}
O = zero(S)
<span style="color: #8f0075;">i</span>(n) = Free{Edge}(Set([[Edge(n)]]))

A = [O  i(<span style="color: #a0132f;">"1&gt;2"</span>)  O         O         i(<span style="color: #a0132f;">"1&gt;5"</span>)
     O  O         i(<span style="color: #a0132f;">"2&gt;3"</span>)  i(<span style="color: #a0132f;">"2&gt;4"</span>)  O
     O  O         O         i(<span style="color: #a0132f;">"3&gt;4"</span>)  O
     O  O         O         O         O
     O  O         i(<span style="color: #a0132f;">"5&gt;3"</span>)  O         O]
</code></pre>
</div>

<p>
Notice here that <code>O</code> means &ldquo;the zero in the appropriate semiring&rdquo; and that <code>i</code>
injects the name into it. The powers of this matrix will generate sets of paths of fixed length.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">using</span> LinearAlgebra

<span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">Necessary for Julia's matrix product to properly use the operations.
</span>Base.<span style="color: #8f0075;">zero</span>(::<span style="color: #531ab6; font-weight: bold;">T</span>) <span style="color: #005e8b; font-weight: bold;">where</span> T &lt;: Semiring = zero(T)


<span style="color: #005e8b; font-weight: bold;">for</span> path <span style="color: #005e8b; font-weight: bold;">in</span> (A^2)[2, 4].choices
    println(path)
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<pre class="example">
Edge[Edge("2&gt;3"), Edge("3&gt;4")]
</pre>

<p>
If we also want to get paths that are length <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2717.496005pt%27 height=%278.690585pt%27 viewBox=%27-.500002 -6.835953 17.496005 8.690585%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3Cpath id=%27g5-20%27 d=%27m6.724782-5.917808c.109589-.049813 .18929-.099626 .18929-.219178c0-.109589-.079701-.199253-.199253-.199253c-.049813 0-.139477 .039851-.179328 .059776l-5.50934 2.600249c-.169365 .079701-.199253 .14944-.199253 .229141c0 .089664 .059776 .159402 .199253 .219178l5.50934 2.590286c.129514 .069738 .14944 .069738 .179328 .069738c.109589 0 .199253-.089664 .199253-.199253c0-.089664-.039851-.14944-.209215-.229141l-5.210461-2.450809l5.230386-2.470735zm-.159402 7.28269c.169365 0 .348692 0 .348692-.199253s-.209215-.199253-.358655-.199253h-5.369863c-.14944 0-.358655 0-.358655 .199253s.179328 .199253 .348692 .199253h5.389788z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page43%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g5-20%27/%3E%0A%3Cuse x=%2710.51608%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( \le n \)" style="height: 0.8549em; vertical-align: -0.1824em; display: inline-block" class="org-latex org-latex-inline" />, we can add ones into the
diagonal of the matrix like this:
</p>


<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">let</span>
    A&#8242; = A + diagm(ones(Free{Edge}, 5))
    <span style="color: #005e8b; font-weight: bold;">for</span> path <span style="color: #005e8b; font-weight: bold;">in</span> (A&#8242;^3)[2,4].choices
        println(path)
    <span style="color: #005e8b; font-weight: bold;">end</span>
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<pre class="example">
Edge[Edge("2&gt;4")]
Edge[Edge("2&gt;3"), Edge("3&gt;4")]
</pre>

<p>
A new path with length 2 that wasn&rsquo;t visible before has appeared.
</p>

<p>
Again, enumerating the set of paths is not very useful. What if we reapply our
earlier trick (using <code>Sel</code>) to do more useful stuff?
</p>

<p>
Again, we fill up the diagonal with ones to consider paths that aren&rsquo;t exactly
<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.979929pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.979929 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page86%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( n \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> edges long.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code>S = Sel{MinCost, Free{Edge}}
O = zero(S)
I = one(S)
<span style="color: #8f0075;">i</span>(c, n) = S(MinCost(c), Free{Edge}(Set([[Edge(n)]])))

A = [I  i(1, <span style="color: #a0132f;">"1&gt;2"</span>)  O           O             i(1, <span style="color: #a0132f;">"1&gt;5"</span>)
     O  I            i(1, <span style="color: #a0132f;">"2&gt;3"</span>)  i(1, <span style="color: #a0132f;">"2&gt;4"</span>)  O
     O  O            I            i(1, <span style="color: #a0132f;">"3&gt;4"</span>)  O
     O  O            O            I            O
     O  O            i(1, <span style="color: #a0132f;">"5&gt;3"</span>)  O            I]

<span style="color: #005e8b; font-weight: bold;">let</span>
    result = (A^5)[1,4]
    println(<span style="color: #a0132f;">"cost: $(result.a)"</span>)
    <span style="color: #005e8b; font-weight: bold;">for</span> path <span style="color: #005e8b; font-weight: bold;">in</span> result.b.choices
        println(<span style="color: #a0132f;">"path: $(path)"</span>)
    <span style="color: #005e8b; font-weight: bold;">end</span>
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<pre class="example">
cost: MinCost(2)
path: Edge[Edge("1&gt;2"), Edge("2&gt;4")]
</pre>

<p>
We found the shortest path!
</p>

<p>
An astute reader might remark, however: &ldquo;Hey, sure, you have found the shortest
path, but it cost you <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2727.074055pt%27 height=%2711.600283pt%27 viewBox=%27-.500002 -8.609621 27.074055 11.600283%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-52%27 d=%27m3.689166-1.143711v-.251059h-.774097v-3.110336c0-.146451 0-.195268-.153425-.195268c-.083686 0-.111582 0-.18132 .097634l-2.308344 3.20797v.251059h2.050311v.571856c0 .237111 0 .320797-.564882 .320797h-.188294v.251059c.348692-.013948 .795019-.027895 1.046077-.027895c.258032 0 .704359 .013948 1.053051 .027895v-.251059h-.188294c-.564882 0-.564882-.083686-.564882-.320797v-.571856h.774097zm-1.318057-2.803487v2.552428h-1.841096l1.841096-2.552428z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g8-79%27 d=%27m7.372354-4.343711c0-1.603985-1.05604-2.67995-2.540473-2.67995c-2.15193 0-4.343711 2.261519-4.343711 4.582814c0 1.653798 1.115816 2.660025 2.550436 2.660025c2.11208 0 4.333748-2.181818 4.333748-4.562889zm-4.273973 4.303861c-.986301 0-1.683686-.806974-1.683686-2.122042c0-.438356 .139477-1.892902 .9066-3.058531c.687422-1.036115 1.663761-1.554172 2.450809-1.554172c.816936 0 1.713574 .557908 1.713574 2.042341c0 .71731-.268991 2.271482-1.255293 3.496887c-.478207 .607721-1.295143 1.195517-2.132005 1.195517z%27/%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page45%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-79%27/%3E%0A%3Cuse x=%277.876015%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2711.750389%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3Cuse x=%2717.730314%27 y=%27-3.615364%27 xlink:href=%27%23g0-52%27/%3E%0A%3Cuse x=%2722.199683%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( O(n^4) \)" style="height: 1.1411em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" /> complexity!&rdquo; Yes. Here, each matrix-matrix
product costs <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2711.449298pt%27 height=%279.109622pt%27 viewBox=%27-.500002 -8.609621 11.449298 9.109622%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-51%27 d=%27m1.903861-2.329265c.54396 0 .934496 .376588 .934496 1.12279c0 .864757-.502117 1.12279-.9066 1.12279c-.278954 0-.892653-.076712-1.185554-.488169c.327771-.013948 .404483-.244085 .404483-.390535c0-.223163-.167372-.383562-.383562-.383562c-.195268 0-.390535 .118555-.390535 .404483c0 .655542 .72528 1.080946 1.569116 1.080946c.969365 0 1.638854-.648568 1.638854-1.345953c0-.54396-.446326-1.08792-1.21345-1.248319c.732254-.265006 .99726-.788045 .99726-1.21345c0-.550934-.63462-.962391-1.408717-.962391s-1.366874 .376588-1.366874 .934496c0 .237111 .153425 .369614 .36264 .369614c.216189 0 .355666-.160399 .355666-.355666c0-.202242-.139477-.348692-.355666-.36264c.244085-.306849 .72528-.383562 .983313-.383562c.313823 0 .753176 .153425 .753176 .760149c0 .292902-.097634 .613699-.278954 .829888c-.230137 .265006-.425405 .278954-.774097 .299875c-.174346 .013948-.188294 .013948-.223163 .020922c-.013948 0-.069738 .013948-.069738 .09066c0 .097634 .062765 .097634 .18132 .097634h.376588z%27/%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page46%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3Cuse x=%275.979925%27 y=%27-3.615364%27 xlink:href=%27%23g0-51%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( n^3 \)" style="height: 0.8961em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> multiplications and we do <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.979929pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.979929 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page86%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( n \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> of those, so we get
<b>very very bad</b> complexity.
</p>

<p>
We could organize the way we do exponentiation more efficiently (by leveraging
<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2788.994183pt%27 height=%2711.948966pt%27 viewBox=%27-.500002 -8.958304 88.994183 11.948966%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g1-61%27 d=%27m6.844334-3.257783c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.967621c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h5.947696zm.009963 1.932752c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.33873-.199253h-5.947696c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.967621z%27/%3E%0A%3Cpath id=%27g0-43%27 d=%27m3.228892-1.57609h2.133998c.09066 0 .258032 0 .258032-.167372c0-.174346-.160399-.174346-.258032-.174346h-2.133998v-2.140971c0-.09066 0-.258032-.167372-.258032c-.174346 0-.174346 .160399-.174346 .258032v2.140971h-2.140971c-.09066 0-.258032 0-.258032 .167372c0 .174346 .160399 .174346 .258032 .174346h2.140971v2.140971c0 .09066 0 .258032 .167372 .258032c.174346 0 .174346-.160399 .174346-.258032v-2.140971z%27/%3E%0A%3Cpath id=%27g0-50%27 d=%27m3.521793-1.26924h-.237111c-.020922 .153425-.09066 .564882-.18132 .63462c-.055791 .041843-.592777 .041843-.690411 .041843h-1.283188c.732254-.648568 .976339-.843836 1.39477-1.171606c.516065-.411457 .99726-.843836 .99726-1.506351c0-.843836-.739228-1.3599-1.63188-1.3599c-.864757 0-1.45056 .606725-1.45056 1.248319c0 .355666 .299875 .390535 .369614 .390535c.167372 0 .369614-.118555 .369614-.369614c0-.125529-.048817-.369614-.411457-.369614c.216189-.495143 .690411-.648568 1.018182-.648568c.697385 0 1.060025 .54396 1.060025 1.108842c0 .606725-.432379 1.08792-.655542 1.338979l-1.680697 1.659776c-.069738 .062765-.069738 .076712-.069738 .27198h2.873225l.209215-1.26924z%27/%3E%0A%3Cpath id=%27g7-107%27 d=%27m2.182814-4.630635c.006974-.013948 .027895-.104608 .027895-.111582c0-.034869-.027895-.097634-.111582-.097634c-.139477 0-.718306 .055791-.892653 .069738c-.055791 .006974-.153425 .013948-.153425 .160399c0 .097634 .097634 .097634 .18132 .097634c.334745 0 .334745 .048817 .334745 .104608c0 .048817-.013948 .09066-.027895 .153425l-.983313 3.947198c-.034869 .125529-.034869 .139477-.034869 .153425c0 .104608 .083686 .223163 .237111 .223163c.188294 0 .278954-.139477 .320797-.292902c.013948-.027895 .313823-1.255293 .341719-1.352927c.495143 .048817 .892653 .209215 .892653 .571856c0 .034869 0 .069738-.013948 .139477c-.027895 .104608-.027895 .139477-.027895 .216189c0 .495143 .404483 .718306 .739228 .718306c.676463 0 .885679-1.060025 .885679-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .034869-.139477 .167372c-.083686 .299875-.27198 .795019-.613699 .795019c-.188294 0-.244085-.174346-.244085-.36264c0-.118555 0-.132503 .041843-.313823c.006974-.020922 .034869-.139477 .034869-.216189c0-.620672-.836862-.718306-1.129763-.739228c.202242-.125529 .460274-.355666 .578829-.460274c.355666-.334745 .704359-.662516 1.094894-.662516c.083686 0 .174346 .020922 .230137 .09066c-.299875 .048817-.36264 .285928-.36264 .390535c0 .153425 .118555 .258032 .278954 .258032c.188294 0 .397509-.153425 .397509-.446326c0-.230137-.167372-.488169-.536986-.488169c-.397509 0-.760149 .285928-1.115816 .613699c-.292902 .278954-.523039 .495143-.808966 .613699l.690411-2.782565z%27/%3E%0A%3Cpath id=%27g7-110%27 d=%27m.850809-.439352c-.027895 .09066-.069738 .265006-.069738 .285928c0 .153425 .125529 .223163 .237111 .223163c.125529 0 .237111-.09066 .27198-.153425s.09066-.285928 .125529-.432379c.034869-.132503 .111582-.4533 .153425-.627646c.041843-.153425 .083686-.306849 .118555-.467248c.076712-.285928 .09066-.341719 .292902-.627646c.195268-.278954 .523039-.641594 1.046077-.641594c.404483 0 .411457 .355666 .411457 .488169c0 .418431-.299875 1.192528-.411457 1.48543c-.076712 .195268-.104608 .258032-.104608 .376588c0 .369614 .306849 .599751 .662516 .599751c.697385 0 1.004234-.962391 1.004234-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .041843-.132503 .118555c-.160399 .557908-.460274 .843836-.739228 .843836c-.146451 0-.174346-.097634-.174346-.244085c0-.160399 .034869-.251059 .160399-.564882c.083686-.216189 .369614-.955417 .369614-1.345953c0-.676463-.536986-.795019-.9066-.795019c-.578829 0-.969365 .355666-1.17858 .63462c-.048817-.481196-.460274-.63462-.746202-.63462c-.299875 0-.460274 .216189-.550934 .376588c-.153425 .258032-.251059 .655542-.251059 .690411c0 .09066 .097634 .09066 .118555 .09066c.097634 0 .104608-.020922 .153425-.209215c.104608-.411457 .237111-.753176 .509091-.753176c.18132 0 .230137 .153425 .230137 .341719c0 .132503-.062765 .390535-.111582 .578829s-.118555 .474222-.153425 .627646l-.223163 .892653z%27/%3E%0A%3Cpath id=%27g8-77%27 d=%27m9.225405-6.03736c.089664-.358655 .109589-.458281 .856787-.458281c.229141 0 .318804 0 .318804-.199253c0-.109589-.099626-.109589-.268991-.109589h-1.315068c-.259029 0-.268991 0-.388543 .18929l-3.636364 5.678705l-.777086-5.638854c-.029888-.229141-.049813-.229141-.308842-.229141h-1.364882c-.18929 0-.298879 0-.298879 .18929c0 .119552 .089664 .119552 .288917 .119552c.129514 0 .308842 .009963 .428394 .019925c.159402 .019925 .219178 .049813 .219178 .159402c0 .039851-.009963 .069738-.039851 .18929l-1.265255 5.070984c-.099626 .398506-.268991 .71731-1.075965 .747198c-.049813 0-.179328 .009963-.179328 .18929c0 .089664 .059776 .119552 .139477 .119552c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.109589-.109589-.179328-.109589c-.56787-.009963-.67746-.209215-.67746-.438356c0-.069738 .009963-.119552 .039851-.229141l1.354919-5.429639h.009963l.856787 6.176837c.019925 .119552 .029888 .229141 .14944 .229141c.109589 0 .169365-.109589 .219178-.179328l4.024907-6.306351h.009963l-1.424658 5.708593c-.099626 .388543-.119552 .468244-.9066 .468244c-.169365 0-.278954 0-.278954 .18929c0 .119552 .119552 .119552 .14944 .119552c.278954 0 .956413-.029888 1.235367-.029888c.408468 0 .836862 .029888 1.24533 .029888c.059776 0 .18929 0 .18929-.199253c0-.109589-.089664-.109589-.278954-.109589c-.368618 0-.647572 0-.647572-.179328c0-.039851 0-.059776 .049813-.239103l1.325031-5.310087z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page48%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%2710.751343%27 y=%27-3.615364%27 xlink:href=%27%23g0-50%27/%3E%0A%3Cuse x=%2714.722583%27 y=%27-3.615364%27 xlink:href=%27%23g7-110%27/%3E%0A%3Cuse x=%2719.647446%27 y=%27-3.615364%27 xlink:href=%27%23g0-43%27/%3E%0A%3Cuse x=%2725.76343%27 y=%27-3.615364%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%2733.432539%27 y=%270%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%2743.948619%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2747.822993%27 y=%270%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%2758.574335%27 y=%27-3.615364%27 xlink:href=%27%23g7-110%27/%3E%0A%3Cuse x=%2763.997328%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%2767.871702%27 y=%27-3.615364%27 xlink:href=%27%23g0-50%27/%3E%0A%3Cuse x=%2772.341071%27 y=%270%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%2783.092414%27 y=%27-3.615364%27 xlink:href=%27%23g7-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( M^{2n + k} = (M^{n})^2M^k \)" style="height: 1.1754em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" />) making the computation <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2749.107032pt%27 height=%2711.600283pt%27 viewBox=%27-.500002 -8.609621 49.107032 11.600283%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g9-59%27 d=%27m4.83188-4.024907c0-.169365-.119552-.488169-.508095-.488169c-.199253 0-.637609 .059776-1.05604 .468244c-.418431-.328767-.836862-.358655-1.05604-.358655c-.926526 0-1.613948 .687422-1.613948 1.454545c0 .438356 .219178 .816936 .468244 1.026152c-.129514 .14944-.308842 .478207-.308842 .826899c0 .308842 .129514 .687422 .438356 .886675c-.597758 .169365-.916563 .597758-.916563 .996264c0 .71731 .986301 1.265255 2.201743 1.265255c1.175592 0 2.211706-.508095 2.211706-1.285181c0-.348692-.139477-.856787-.647572-1.135741c-.52802-.278954-1.105853-.278954-1.713574-.278954c-.249066 0-.67746 0-.747198-.009963c-.318804-.039851-.52802-.348692-.52802-.667497c0-.039851 0-.268991 .169365-.468244c.388543 .278954 .797011 .308842 .986301 .308842c.926526 0 1.613948-.687422 1.613948-1.454545c0-.368618-.159402-.737235-.408468-.966376c.358655-.33873 .71731-.388543 .896638-.388543c0 0 .069738 0 .099626 .009963c-.109589 .039851-.159402 .14944-.159402 .268991c0 .169365 .129514 .288917 .288917 .288917c.099626 0 .288917-.069738 .288917-.298879zm-1.753425 1.075965c0 .268991-.009963 .587796-.159402 .836862c-.079701 .119552-.308842 .398506-.707347 .398506c-.86675 0-.86675-.996264-.86675-1.225405c0-.268991 .009963-.587796 .159402-.836862c.079701-.119552 .308842-.398506 .707347-.398506c.86675 0 .86675 .996264 .86675 1.225405zm1.09589 3.73599c0 .537983-.707347 1.036115-1.683686 1.036115c-1.006227 0-1.693649-.508095-1.693649-1.036115c0-.458281 .37858-.826899 .816936-.856787h.587796c.856787 0 1.972603 0 1.972603 .856787z%27/%3E%0A%3Cpath id=%27g9-72%27 d=%27m2.540473 0v-.308842c-.667497 0-.777086 0-.777086-.448319v-6.156912l-1.43462 .109589v.308842c.697385 0 .777086 .069738 .777086 .557908v5.180573c0 .448319-.109589 .448319-.777086 .448319v.308842l1.105853-.029888l1.105853 .029888z%27/%3E%0A%3Cpath id=%27g9-81%27 d=%27m4.692403-2.132005c0-1.275218-.996264-2.331258-2.201743-2.331258c-1.24533 0-2.211706 1.085928-2.211706 2.331258c0 1.285181 1.036115 2.241594 2.201743 2.241594c1.205479 0 2.211706-.976339 2.211706-2.241594zm-.826899-.079701c0 .358655 0 .896638-.219178 1.334994c-.219178 .448319-.657534 .737235-1.155666 .737235c-.428394 0-.86675-.209215-1.135741-.667497c-.249066-.438356-.249066-1.046077-.249066-1.404732c0-.388543 0-.926526 .239103-1.364882c.268991-.458281 .737235-.667497 1.135741-.667497c.438356 0 .86675 .219178 1.125778 .647572s.259029 1.006227 .259029 1.384807z%27/%3E%0A%3Cpath id=%27g0-51%27 d=%27m1.903861-2.329265c.54396 0 .934496 .376588 .934496 1.12279c0 .864757-.502117 1.12279-.9066 1.12279c-.278954 0-.892653-.076712-1.185554-.488169c.327771-.013948 .404483-.244085 .404483-.390535c0-.223163-.167372-.383562-.383562-.383562c-.195268 0-.390535 .118555-.390535 .404483c0 .655542 .72528 1.080946 1.569116 1.080946c.969365 0 1.638854-.648568 1.638854-1.345953c0-.54396-.446326-1.08792-1.21345-1.248319c.732254-.265006 .99726-.788045 .99726-1.21345c0-.550934-.63462-.962391-1.408717-.962391s-1.366874 .376588-1.366874 .934496c0 .237111 .153425 .369614 .36264 .369614c.216189 0 .355666-.160399 .355666-.355666c0-.202242-.139477-.348692-.355666-.36264c.244085-.306849 .72528-.383562 .983313-.383562c.313823 0 .753176 .153425 .753176 .760149c0 .292902-.097634 .613699-.278954 .829888c-.230137 .265006-.425405 .278954-.774097 .299875c-.174346 .013948-.188294 .013948-.223163 .020922c-.013948 0-.069738 .013948-.069738 .09066c0 .097634 .062765 .097634 .18132 .097634h.376588z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g8-79%27 d=%27m7.372354-4.343711c0-1.603985-1.05604-2.67995-2.540473-2.67995c-2.15193 0-4.343711 2.261519-4.343711 4.582814c0 1.653798 1.115816 2.660025 2.550436 2.660025c2.11208 0 4.333748-2.181818 4.333748-4.562889zm-4.273973 4.303861c-.986301 0-1.683686-.806974-1.683686-2.122042c0-.438356 .139477-1.892902 .9066-3.058531c.687422-1.036115 1.663761-1.554172 2.450809-1.554172c.816936 0 1.713574 .557908 1.713574 2.042341c0 .71731-.268991 2.271482-1.255293 3.496887c-.478207 .607721-1.295143 1.195517-2.132005 1.195517z%27/%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page49%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-79%27/%3E%0A%3Cuse x=%277.876015%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2711.750389%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3Cuse x=%2717.730314%27 y=%27-3.615364%27 xlink:href=%27%23g0-51%27/%3E%0A%3Cuse x=%2723.860083%27 y=%270%27 xlink:href=%27%23g9-72%27/%3E%0A%3Cuse x=%2726.629697%27 y=%270%27 xlink:href=%27%23g9-81%27/%3E%0A%3Cuse x=%2731.611017%27 y=%270%27 xlink:href=%27%23g9-59%27/%3E%0A%3Cuse x=%2738.252735%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3Cuse x=%2744.23266%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( O(n^3 \log n) \)" style="height: 1.1411em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" />, but
that is still <b>very bad</b>.
</p>

<p>
Another thing we can do, is notice that in many cases, we don&rsquo;t actually care
about most of the optimal paths. Usually, we want a single optimal path from a
source to a destination and that&rsquo;s it.
</p>

<p>
We can leverage this weaker need by computing our shortest path as an iterated
matrix vector product (costs <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2727.074055pt%27 height=%2711.600283pt%27 viewBox=%27-.500002 -8.609621 27.074055 11.600283%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-50%27 d=%27m3.521793-1.26924h-.237111c-.020922 .153425-.09066 .564882-.18132 .63462c-.055791 .041843-.592777 .041843-.690411 .041843h-1.283188c.732254-.648568 .976339-.843836 1.39477-1.171606c.516065-.411457 .99726-.843836 .99726-1.506351c0-.843836-.739228-1.3599-1.63188-1.3599c-.864757 0-1.45056 .606725-1.45056 1.248319c0 .355666 .299875 .390535 .369614 .390535c.167372 0 .369614-.118555 .369614-.369614c0-.125529-.048817-.369614-.411457-.369614c.216189-.495143 .690411-.648568 1.018182-.648568c.697385 0 1.060025 .54396 1.060025 1.108842c0 .606725-.432379 1.08792-.655542 1.338979l-1.680697 1.659776c-.069738 .062765-.069738 .076712-.069738 .27198h2.873225l.209215-1.26924z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g8-79%27 d=%27m7.372354-4.343711c0-1.603985-1.05604-2.67995-2.540473-2.67995c-2.15193 0-4.343711 2.261519-4.343711 4.582814c0 1.653798 1.115816 2.660025 2.550436 2.660025c2.11208 0 4.333748-2.181818 4.333748-4.562889zm-4.273973 4.303861c-.986301 0-1.683686-.806974-1.683686-2.122042c0-.438356 .139477-1.892902 .9066-3.058531c.687422-1.036115 1.663761-1.554172 2.450809-1.554172c.816936 0 1.713574 .557908 1.713574 2.042341c0 .71731-.268991 2.271482-1.255293 3.496887c-.478207 .607721-1.295143 1.195517-2.132005 1.195517z%27/%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page87%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-79%27/%3E%0A%3Cuse x=%277.876015%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2711.750389%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3Cuse x=%2717.730314%27 y=%27-3.615364%27 xlink:href=%27%23g0-50%27/%3E%0A%3Cuse x=%2722.199683%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( O(n^2) \)" style="height: 1.1411em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" /> instead of <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2723.199683pt%27 height=%2711.600283pt%27 viewBox=%27-.500002 -8.609621 23.199683 11.600283%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-51%27 d=%27m1.903861-2.329265c.54396 0 .934496 .376588 .934496 1.12279c0 .864757-.502117 1.12279-.9066 1.12279c-.278954 0-.892653-.076712-1.185554-.488169c.327771-.013948 .404483-.244085 .404483-.390535c0-.223163-.167372-.383562-.383562-.383562c-.195268 0-.390535 .118555-.390535 .404483c0 .655542 .72528 1.080946 1.569116 1.080946c.969365 0 1.638854-.648568 1.638854-1.345953c0-.54396-.446326-1.08792-1.21345-1.248319c.732254-.265006 .99726-.788045 .99726-1.21345c0-.550934-.63462-.962391-1.408717-.962391s-1.366874 .376588-1.366874 .934496c0 .237111 .153425 .369614 .36264 .369614c.216189 0 .355666-.160399 .355666-.355666c0-.202242-.139477-.348692-.355666-.36264c.244085-.306849 .72528-.383562 .983313-.383562c.313823 0 .753176 .153425 .753176 .760149c0 .292902-.097634 .613699-.278954 .829888c-.230137 .265006-.425405 .278954-.774097 .299875c-.174346 .013948-.188294 .013948-.223163 .020922c-.013948 0-.069738 .013948-.069738 .09066c0 .097634 .062765 .097634 .18132 .097634h.376588z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g8-79%27 d=%27m7.372354-4.343711c0-1.603985-1.05604-2.67995-2.540473-2.67995c-2.15193 0-4.343711 2.261519-4.343711 4.582814c0 1.653798 1.115816 2.660025 2.550436 2.660025c2.11208 0 4.333748-2.181818 4.333748-4.562889zm-4.273973 4.303861c-.986301 0-1.683686-.806974-1.683686-2.122042c0-.438356 .139477-1.892902 .9066-3.058531c.687422-1.036115 1.663761-1.554172 2.450809-1.554172c.816936 0 1.713574 .557908 1.713574 2.042341c0 .71731-.268991 2.271482-1.255293 3.496887c-.478207 .607721-1.295143 1.195517-2.132005 1.195517z%27/%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page51%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-79%27/%3E%0A%3Cuse x=%277.876015%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2711.750389%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3Cuse x=%2717.730314%27 y=%27-3.615364%27 xlink:href=%27%23g0-51%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(O(n^3\)" style="height: 1.1411em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" />).<sup><a id="fnr.3" class="footref" href="#fn.3" role="doc-backlink">3</a></sup>
</p>


<div class="equation-container">
<span class="equation">
<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27613.000002pt%27 height=%2731.067366pt%27 viewBox=%27-.500002 -25.586044 613.000002 31.067366%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g4-62%27 d=%27m3.284682-4.498132h2.127024c.111582 0 .278954 0 .278954-.167372c0-.174346-.160399-.174346-.278954-.174346h-4.595766c-.104608 0-.278954 0-.278954 .167372c0 .174346 .160399 .174346 .278954 .174346h2.127024v4.226152c0 .111582 0 .27198 .174346 .27198c.167372 0 .167372-.167372 .167372-.27198v-4.226152z%27/%3E%0A%3Cpath id=%27g7-105%27 d=%27m2.259527-4.358655c0-.111582-.083686-.265006-.278954-.265006c-.188294 0-.390535 .18132-.390535 .383562c0 .118555 .09066 .265006 .278954 .265006c.202242 0 .390535-.195268 .390535-.383562zm-1.422665 3.542715c-.027895 .09066-.062765 .174346-.062765 .292902c0 .327771 .278954 .592777 .662516 .592777c.697385 0 1.004234-.962391 1.004234-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .041843-.132503 .118555c-.160399 .557908-.467248 .843836-.739228 .843836c-.139477 0-.174346-.09066-.174346-.244085c0-.160399 .048817-.292902 .111582-.446326c.069738-.188294 .146451-.376588 .223163-.557908c.062765-.167372 .313823-.801993 .341719-.885679c.020922-.069738 .041843-.153425 .041843-.223163c0-.327771-.278954-.592777-.662516-.592777c-.690411 0-1.011208 .948443-1.011208 1.066999c0 .09066 .097634 .09066 .118555 .09066c.097634 0 .104608-.034869 .125529-.111582c.18132-.599751 .488169-.850809 .746202-.850809c.111582 0 .174346 .055791 .174346 .244085c0 .160399-.041843 .265006-.216189 .697385l-.439352 1.12279z%27/%3E%0A%3Cpath id=%27g7-106%27 d=%27m3.061519-4.358655c0-.118555-.09066-.265006-.278954-.265006c-.202242 0-.390535 .195268-.390535 .383562c0 .111582 .083686 .265006 .278954 .265006c.188294 0 .390535-.18132 .390535-.383562zm-1.478456 4.700374c-.118555 .481196-.488169 .885679-.899626 .885679c-.09066 0-.174346-.013948-.251059-.041843c.18132-.083686 .237111-.251059 .237111-.355666c0-.167372-.132503-.258032-.27198-.258032c-.216189 0-.397509 .188294-.397509 .411457c0 .265006 .27198 .439352 .690411 .439352s1.234371-.251059 1.45056-1.101868l.627646-2.496638c.020922-.076712 .034869-.139477 .034869-.244085c0-.383562-.327771-.655542-.746202-.655542c-.774097 0-1.220423 .969365-1.220423 1.066999c0 .09066 .097634 .09066 .118555 .09066c.083686 0 .09066-.020922 .139477-.125529c.174346-.404483 .536986-.836862 .941469-.836862c.174346 0 .237111 .118555 .237111 .341719c0 .076712-.013948 .174346-.020922 .209215l-.669489 2.670984z%27/%3E%0A%3Cpath id=%27g7-110%27 d=%27m.850809-.439352c-.027895 .09066-.069738 .265006-.069738 .285928c0 .153425 .125529 .223163 .237111 .223163c.125529 0 .237111-.09066 .27198-.153425s.09066-.285928 .125529-.432379c.034869-.132503 .111582-.4533 .153425-.627646c.041843-.153425 .083686-.306849 .118555-.467248c.076712-.285928 .09066-.341719 .292902-.627646c.195268-.278954 .523039-.641594 1.046077-.641594c.404483 0 .411457 .355666 .411457 .488169c0 .418431-.299875 1.192528-.411457 1.48543c-.076712 .195268-.104608 .258032-.104608 .376588c0 .369614 .306849 .599751 .662516 .599751c.697385 0 1.004234-.962391 1.004234-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .041843-.132503 .118555c-.160399 .557908-.460274 .843836-.739228 .843836c-.146451 0-.174346-.097634-.174346-.244085c0-.160399 .034869-.251059 .160399-.564882c.083686-.216189 .369614-.955417 .369614-1.345953c0-.676463-.536986-.795019-.9066-.795019c-.578829 0-.969365 .355666-1.17858 .63462c-.048817-.481196-.460274-.63462-.746202-.63462c-.299875 0-.460274 .216189-.550934 .376588c-.153425 .258032-.251059 .655542-.251059 .690411c0 .09066 .097634 .09066 .118555 .09066c.097634 0 .104608-.020922 .153425-.209215c.104608-.411457 .237111-.753176 .509091-.753176c.18132 0 .230137 .153425 .230137 .341719c0 .132503-.062765 .390535-.111582 .578829s-.118555 .474222-.153425 .627646l-.223163 .892653z%27/%3E%0A%3Cpath id=%27g8-58%27 d=%27m1.912827-.52802c0-.288917-.239103-.52802-.52802-.52802s-.52802 .239103-.52802 .52802s.239103 .52802 .52802 .52802s.52802-.239103 .52802-.52802z%27/%3E%0A%3Cpath id=%27g8-77%27 d=%27m9.225405-6.03736c.089664-.358655 .109589-.458281 .856787-.458281c.229141 0 .318804 0 .318804-.199253c0-.109589-.099626-.109589-.268991-.109589h-1.315068c-.259029 0-.268991 0-.388543 .18929l-3.636364 5.678705l-.777086-5.638854c-.029888-.229141-.049813-.229141-.308842-.229141h-1.364882c-.18929 0-.298879 0-.298879 .18929c0 .119552 .089664 .119552 .288917 .119552c.129514 0 .308842 .009963 .428394 .019925c.159402 .019925 .219178 .049813 .219178 .159402c0 .039851-.009963 .069738-.039851 .18929l-1.265255 5.070984c-.099626 .398506-.268991 .71731-1.075965 .747198c-.049813 0-.179328 .009963-.179328 .18929c0 .089664 .059776 .119552 .139477 .119552c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.109589-.109589-.179328-.109589c-.56787-.009963-.67746-.209215-.67746-.438356c0-.069738 .009963-.119552 .039851-.229141l1.354919-5.429639h.009963l.856787 6.176837c.019925 .119552 .029888 .229141 .14944 .229141c.109589 0 .169365-.109589 .219178-.179328l4.024907-6.306351h.009963l-1.424658 5.708593c-.099626 .388543-.119552 .468244-.9066 .468244c-.169365 0-.278954 0-.278954 .18929c0 .119552 .119552 .119552 .14944 .119552c.278954 0 .956413-.029888 1.235367-.029888c.408468 0 .836862 .029888 1.24533 .029888c.059776 0 .18929 0 .18929-.199253c0-.109589-.089664-.109589-.278954-.109589c-.368618 0-.647572 0-.647572-.179328c0-.039851 0-.059776 .049813-.239103l1.325031-5.310087z%27/%3E%0A%3Cpath id=%27g8-101%27 d=%27m1.863014-2.30137c.288917 0 1.026152-.019925 1.524284-.229141c.697385-.298879 .747198-.886675 .747198-1.026152c0-.438356-.37858-.846824-1.066002-.846824c-1.105853 0-2.610212 .966376-2.610212 2.709838c0 1.016189 .587796 1.803238 1.564134 1.803238c1.424658 0 2.261519-1.05604 2.261519-1.175592c0-.059776-.059776-.129514-.119552-.129514c-.049813 0-.069738 .019925-.129514 .099626c-.787049 .986301-1.872976 .986301-1.992528 .986301c-.777086 0-.86675-.836862-.86675-1.155666c0-.119552 .009963-.428394 .159402-1.036115h.52802zm-.468244-.219178c.388543-1.514321 1.414695-1.663761 1.673724-1.663761c.468244 0 .737235 .288917 .737235 .627646c0 1.036115-1.594022 1.036115-2.002491 1.036115h-.408468z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g1-61%27 d=%27m6.844334-3.257783c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.967621c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h5.947696zm.009963 1.932752c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.33873-.199253h-5.947696c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.967621z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page52%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%27235.363055%27 y=%27-15.133344%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27239.237429%27 y=%27-15.133344%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27249.988772%27 y=%27-19.24684%27 xlink:href=%27%23g7-110%27/%3E%0A%3Cuse x=%27255.411764%27 y=%27-15.133344%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%27259.286138%27 y=%27-13.638963%27 xlink:href=%27%23g7-105%27/%3E%0A%3Cuse x=%27262.104865%27 y=%27-13.638963%27 xlink:href=%27%23g7-106%27/%3E%0A%3Cuse x=%27269.069998%27 y=%27-15.133344%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%27279.586078%27 y=%27-15.133344%27 xlink:href=%27%23g8-101%27/%3E%0A%3Cuse x=%27284.224949%27 y=%27-19.24684%27 xlink:href=%27%23g4-62%27/%3E%0A%3Cuse x=%27284.224949%27 y=%27-12.670412%27 xlink:href=%27%23g7-105%27/%3E%0A%3Cuse x=%27290.949746%27 y=%27-15.133344%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27301.701089%27 y=%27-19.24684%27 xlink:href=%27%23g7-110%27/%3E%0A%3Cuse x=%27307.124082%27 y=%27-15.133344%27 xlink:href=%27%23g8-101%27/%3E%0A%3Cuse x=%27311.762953%27 y=%27-13.638963%27 xlink:href=%27%23g7-106%27/%3E%0A%3Cuse x=%27269.069998%27 y=%271.394733%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%27279.586078%27 y=%271.394733%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27283.460451%27 y=%271.394733%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27287.334825%27 y=%271.394733%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%27291.762633%27 y=%271.394733%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%27296.190441%27 y=%271.394733%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%27300.618249%27 y=%271.394733%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27304.492623%27 y=%271.394733%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%27308.366996%27 y=%271.394733%27 xlink:href=%27%23g8-101%27/%3E%0A%3Cuse x=%27313.005868%27 y=%27-2.718763%27 xlink:href=%27%23g4-62%27/%3E%0A%3Cuse x=%27313.005868%27 y=%273.857665%27 xlink:href=%27%23g7-105%27/%3E%0A%3Cuse x=%27319.730665%27 y=%271.394733%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27330.482008%27 y=%271.394733%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%27336.016781%27 y=%271.394733%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%27340.444589%27 y=%271.394733%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%27344.872397%27 y=%271.394733%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%27349.300205%27 y=%271.394733%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%27353.174579%27 y=%271.394733%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27363.925921%27 y=%271.394733%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%27367.800295%27 y=%271.394733%27 xlink:href=%27%23g8-101%27/%3E%0A%3Cuse x=%27372.439167%27 y=%272.889114%27 xlink:href=%27%23g7-106%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\begin{equation*}
\begin{aligned}
(M^n)_{ij}
&amp;amp;= e_i^\top M^n e_j \\
&amp;amp;= ((\dots((e_i^\top M) \dots ) M) e_j
\end{aligned}
\end{equation*}
" style="height: 3.0560em; vertical-align: -0.5392em; display: inline-block" class="org-latex org-latex-inline" />
</span>
</div>

<div class="org-src-container">
<pre class="src src-julia"><code>V = [I O O O O]

<span style="color: #005e8b; font-weight: bold;">let</span>
    result = (V * A * A * A * A * A)[4]
    println(<span style="color: #a0132f;">"cost: $(result.a)"</span>)
    <span style="color: #005e8b; font-weight: bold;">for</span> path <span style="color: #005e8b; font-weight: bold;">in</span> result.b.choices
        println(<span style="color: #a0132f;">"path: $(path)"</span>)
    <span style="color: #005e8b; font-weight: bold;">end</span>
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<pre class="example">
cost: MinCost(2)
path: Edge[Edge("1&gt;2"), Edge("2&gt;4")]
</pre>

<p>
We finally achieved<sup><a id="fnr.4" class="footref" href="#fn.4" role="doc-backlink">4</a></sup> <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2727.074055pt%27 height=%2711.600283pt%27 viewBox=%27-.500002 -8.609621 27.074055 11.600283%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-51%27 d=%27m1.903861-2.329265c.54396 0 .934496 .376588 .934496 1.12279c0 .864757-.502117 1.12279-.9066 1.12279c-.278954 0-.892653-.076712-1.185554-.488169c.327771-.013948 .404483-.244085 .404483-.390535c0-.223163-.167372-.383562-.383562-.383562c-.195268 0-.390535 .118555-.390535 .404483c0 .655542 .72528 1.080946 1.569116 1.080946c.969365 0 1.638854-.648568 1.638854-1.345953c0-.54396-.446326-1.08792-1.21345-1.248319c.732254-.265006 .99726-.788045 .99726-1.21345c0-.550934-.63462-.962391-1.408717-.962391s-1.366874 .376588-1.366874 .934496c0 .237111 .153425 .369614 .36264 .369614c.216189 0 .355666-.160399 .355666-.355666c0-.202242-.139477-.348692-.355666-.36264c.244085-.306849 .72528-.383562 .983313-.383562c.313823 0 .753176 .153425 .753176 .760149c0 .292902-.097634 .613699-.278954 .829888c-.230137 .265006-.425405 .278954-.774097 .299875c-.174346 .013948-.188294 .013948-.223163 .020922c-.013948 0-.069738 .013948-.069738 .09066c0 .097634 .062765 .097634 .18132 .097634h.376588z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g8-79%27 d=%27m7.372354-4.343711c0-1.603985-1.05604-2.67995-2.540473-2.67995c-2.15193 0-4.343711 2.261519-4.343711 4.582814c0 1.653798 1.115816 2.660025 2.550436 2.660025c2.11208 0 4.333748-2.181818 4.333748-4.562889zm-4.273973 4.303861c-.986301 0-1.683686-.806974-1.683686-2.122042c0-.438356 .139477-1.892902 .9066-3.058531c.687422-1.036115 1.663761-1.554172 2.450809-1.554172c.816936 0 1.713574 .557908 1.713574 2.042341c0 .71731-.268991 2.271482-1.255293 3.496887c-.478207 .607721-1.295143 1.195517-2.132005 1.195517z%27/%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page53%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-79%27/%3E%0A%3Cuse x=%277.876015%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2711.750389%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3Cuse x=%2717.730314%27 y=%27-3.615364%27 xlink:href=%27%23g0-51%27/%3E%0A%3Cuse x=%2722.199683%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( O(n^3) \)" style="height: 1.1411em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" />, but if we compare it to the classical
algorithm for that class of problem, the Floyd-Warshall algorithm, we barely
achieve its complexity while doing <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.979929pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.979929 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page86%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( n \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> times less work (FW compute all
source and all destinations shortest paths). This is still <b>bad</b>. How could we
translate the FW algorithm to our weird semiring matrix usecase?
</p>
</div>
</div>
<div id="outline-container-org92c4fe4" class="outline-3">
<h3 id="org92c4fe4"><span class="section-number-3">4.4.</span> Generalized Floyd-Warshall</h3>
<div class="outline-text-3" id="text-4-4">
<p>
The Floyd-Warshall algorithm works recursively. If we know all the shortest
paths among all <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2750.778407pt%27 height=%279.85568pt%27 viewBox=%27-.500002 -7.4185 50.778407 9.85568%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g5-0%27 d=%27m6.56538-2.291407c.169365 0 .348692 0 .348692-.199253s-.179328-.199253-.348692-.199253h-5.389788c-.169365 0-.348692 0-.348692 .199253s.179328 .199253 .348692 .199253h5.389788z%27/%3E%0A%3Cpath id=%27g8-58%27 d=%27m1.912827-.52802c0-.288917-.239103-.52802-.52802-.52802s-.52802 .239103-.52802 .52802s.239103 .52802 .52802 .52802s.52802-.239103 .52802-.52802z%27/%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3Cpath id=%27g1-49%27 d=%27m2.929016-6.37609c0-.239103 0-.259029-.229141-.259029c-.617684 .637609-1.494396 .637609-1.8132 .637609v.308842c.199253 0 .787049 0 1.305106-.259029v5.160648c0 .358655-.029888 .478207-.926526 .478207h-.318804v.308842c.348692-.029888 1.215442-.029888 1.613948-.029888s1.265255 0 1.613948 .029888v-.308842h-.318804c-.896638 0-.926526-.109589-.926526-.478207v-5.589041z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page56%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g1-49%27/%3E%0A%3Cuse x=%274.981339%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%279.409147%27 y=%270%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%2713.836955%27 y=%270%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%2718.264763%27 y=%270%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%2722.692571%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2727.120379%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3Cuse x=%2734.834464%27 y=%270%27 xlink:href=%27%23g5-0%27/%3E%0A%3Cuse x=%2744.797078%27 y=%270%27 xlink:href=%27%23g1-49%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( 1, \dots, k-1 \)" style="height: 0.9695em; vertical-align: -0.2397em; display: inline-block" class="org-latex org-latex-inline" /> nodes, then we can quickly extend them to get
shortest paths among all <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2733.620596pt%27 height=%279.85568pt%27 viewBox=%27-.500002 -7.4185 33.620596 9.85568%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-58%27 d=%27m1.912827-.52802c0-.288917-.239103-.52802-.52802-.52802s-.52802 .239103-.52802 .52802s.239103 .52802 .52802 .52802s.52802-.239103 .52802-.52802z%27/%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3Cpath id=%27g1-49%27 d=%27m2.929016-6.37609c0-.239103 0-.259029-.229141-.259029c-.617684 .637609-1.494396 .637609-1.8132 .637609v.308842c.199253 0 .787049 0 1.305106-.259029v5.160648c0 .358655-.029888 .478207-.926526 .478207h-.318804v.308842c.348692-.029888 1.215442-.029888 1.613948-.029888s1.265255 0 1.613948 .029888v-.308842h-.318804c-.896638 0-.926526-.109589-.926526-.478207v-5.589041z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page57%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g1-49%27/%3E%0A%3Cuse x=%274.981339%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%279.409147%27 y=%270%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%2713.836955%27 y=%270%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%2718.264763%27 y=%270%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%2722.692571%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2727.120379%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( 1, \dots, k \)" style="height: 0.9695em; vertical-align: -0.2397em; display: inline-block" class="org-latex org-latex-inline" /> nodes.
</p>

<p>
Each iteration up, we:
</p>

<ol class="org-ol">
<li>Consider the matrix <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2725.764847pt%27 height=%2710.132398pt%27 viewBox=%27-.500002 -7.307786 25.764847 10.132398%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-49%27 d=%27m2.336239-4.435367c0-.188294-.013948-.195268-.209215-.195268c-.446326 .439352-1.080946 .446326-1.366874 .446326v.251059c.167372 0 .627646 0 1.011208-.195268v3.556663c0 .230137 0 .320797-.697385 .320797h-.265006v.251059c.125529-.006974 .983313-.027895 1.241345-.027895c.216189 0 1.094894 .020922 1.248319 .027895v-.251059h-.265006c-.697385 0-.697385-.09066-.697385-.320797v-3.863512z%27/%3E%0A%3Cpath id=%27g4-0%27 d=%27m5.188543-1.57609c.111582 0 .278954 0 .278954-.167372c0-.174346-.160399-.174346-.278954-.174346h-4.156413c-.111582 0-.278954 0-.278954 .167372c0 .174346 .160399 .174346 .278954 .174346h4.156413z%27/%3E%0A%3Cpath id=%27g7-107%27 d=%27m2.182814-4.630635c.006974-.013948 .027895-.104608 .027895-.111582c0-.034869-.027895-.097634-.111582-.097634c-.139477 0-.718306 .055791-.892653 .069738c-.055791 .006974-.153425 .013948-.153425 .160399c0 .097634 .097634 .097634 .18132 .097634c.334745 0 .334745 .048817 .334745 .104608c0 .048817-.013948 .09066-.027895 .153425l-.983313 3.947198c-.034869 .125529-.034869 .139477-.034869 .153425c0 .104608 .083686 .223163 .237111 .223163c.188294 0 .278954-.139477 .320797-.292902c.013948-.027895 .313823-1.255293 .341719-1.352927c.495143 .048817 .892653 .209215 .892653 .571856c0 .034869 0 .069738-.013948 .139477c-.027895 .104608-.027895 .139477-.027895 .216189c0 .495143 .404483 .718306 .739228 .718306c.676463 0 .885679-1.060025 .885679-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .034869-.139477 .167372c-.083686 .299875-.27198 .795019-.613699 .795019c-.188294 0-.244085-.174346-.244085-.36264c0-.118555 0-.132503 .041843-.313823c.006974-.020922 .034869-.139477 .034869-.216189c0-.620672-.836862-.718306-1.129763-.739228c.202242-.125529 .460274-.355666 .578829-.460274c.355666-.334745 .704359-.662516 1.094894-.662516c.083686 0 .174346 .020922 .230137 .09066c-.299875 .048817-.36264 .285928-.36264 .390535c0 .153425 .118555 .258032 .278954 .258032c.188294 0 .397509-.153425 .397509-.446326c0-.230137-.167372-.488169-.536986-.488169c-.397509 0-.760149 .285928-1.115816 .613699c-.292902 .278954-.523039 .495143-.808966 .613699l.690411-2.782565z%27/%3E%0A%3Cpath id=%27g8-77%27 d=%27m9.225405-6.03736c.089664-.358655 .109589-.458281 .856787-.458281c.229141 0 .318804 0 .318804-.199253c0-.109589-.099626-.109589-.268991-.109589h-1.315068c-.259029 0-.268991 0-.388543 .18929l-3.636364 5.678705l-.777086-5.638854c-.029888-.229141-.049813-.229141-.308842-.229141h-1.364882c-.18929 0-.298879 0-.298879 .18929c0 .119552 .089664 .119552 .288917 .119552c.129514 0 .308842 .009963 .428394 .019925c.159402 .019925 .219178 .049813 .219178 .159402c0 .039851-.009963 .069738-.039851 .18929l-1.265255 5.070984c-.099626 .398506-.268991 .71731-1.075965 .747198c-.049813 0-.179328 .009963-.179328 .18929c0 .089664 .059776 .119552 .139477 .119552c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.109589-.109589-.179328-.109589c-.56787-.009963-.67746-.209215-.67746-.438356c0-.069738 .009963-.119552 .039851-.229141l1.354919-5.429639h.009963l.856787 6.176837c.019925 .119552 .029888 .229141 .14944 .229141c.109589 0 .169365-.109589 .219178-.179328l4.024907-6.306351h.009963l-1.424658 5.708593c-.099626 .388543-.119552 .468244-.9066 .468244c-.169365 0-.278954 0-.278954 .18929c0 .119552 .119552 .119552 .14944 .119552c.278954 0 .956413-.029888 1.235367-.029888c.408468 0 .836862 .029888 1.24533 .029888c.059776 0 .18929 0 .18929-.199253c0-.109589-.089664-.109589-.278954-.109589c-.368618 0-.647572 0-.647572-.179328c0-.039851 0-.059776 .049813-.239103l1.325031-5.310087z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page81%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%279.66516%27 y=%271.494381%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%2714.068814%27 y=%271.494381%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%2720.295494%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( M_{k-1} \)" style="height: 0.9967em; vertical-align: -0.2779em; display: inline-block" class="org-latex org-latex-inline" /> of optimal paths for all nodes <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2717.016298pt%27 height=%278.308017pt%27 viewBox=%27-.500002 -7.4185 17.016298 8.308017%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-60%27 d=%27m6.724782-4.961395c.119552-.059776 .18929-.109589 .18929-.219178s-.089664-.199253-.199253-.199253c-.029888 0-.049813 0-.179328 .069738l-5.519303 2.600249c-.109589 .049813-.18929 .099626-.18929 .219178s.079701 .169365 .18929 .219178l5.519303 2.600249c.129514 .069738 .14944 .069738 .179328 .069738c.109589 0 .199253-.089664 .199253-.199253s-.069738-.159402-.18929-.219178l-5.230386-2.470735l5.230386-2.470735z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page63%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-60%27/%3E%0A%3Cuse x=%2710.51608%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( &amp;lt; k \)" style="height: 0.8172em; vertical-align: -0.0875em; display: inline-block" class="org-latex org-latex-inline" />.</li>
<li>Consider as <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%278.471999pt%27 height=%277.807787pt%27 viewBox=%27-.500002 -7.307786 8.471999 7.807787%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-65%27 d=%27m1.783313-1.145704c-.398506 .667497-.787049 .806974-1.225405 .836862c-.119552 .009963-.209215 .009963-.209215 .199253c0 .059776 .049813 .109589 .129514 .109589c.268991 0 .577833-.029888 .856787-.029888c.328767 0 .67746 .029888 .996264 .029888c.059776 0 .18929 0 .18929-.18929c0-.109589-.089664-.119552-.159402-.119552c-.229141-.019925-.468244-.099626-.468244-.348692c0-.119552 .059776-.229141 .139477-.368618l.757161-1.275218h2.500623c.019925 .209215 .159402 1.564134 .159402 1.663761c0 .298879-.518057 .328767-.71731 .328767c-.139477 0-.239103 0-.239103 .199253c0 .109589 .119552 .109589 .139477 .109589c.408468 0 .836862-.029888 1.24533-.029888c.249066 0 .876712 .029888 1.125778 .029888c.059776 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.229141-.109589c-.617684 0-.617684-.069738-.647572-.358655l-.607721-6.22665c-.019925-.199253-.019925-.239103-.18929-.239103c-.159402 0-.199253 .069738-.259029 .169365l-3.466999 5.818182zm1.195517-1.464508l1.96264-3.287671l.318804 3.287671h-2.281445z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page60%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-65%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( A \)" style="height: 0.7680em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> the adjacency matrix of the first <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.500221pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 6.500221 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page79%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( k \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> nodes (it is
the <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.500221pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 6.500221 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page79%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( k \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> wide upper left square of the complete adjacency matrix).</li>
<li>We try to improve the <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2717.016298pt%27 height=%278.308017pt%27 viewBox=%27-.500002 -7.4185 17.016298 8.308017%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-60%27 d=%27m6.724782-4.961395c.119552-.059776 .18929-.109589 .18929-.219178s-.089664-.199253-.199253-.199253c-.029888 0-.049813 0-.179328 .069738l-5.519303 2.600249c-.109589 .049813-.18929 .099626-.18929 .219178s.079701 .169365 .18929 .219178l5.519303 2.600249c.129514 .069738 .14944 .069738 .179328 .069738c.109589 0 .199253-.089664 .199253-.199253s-.069738-.159402-.18929-.219178l-5.230386-2.470735l5.230386-2.470735z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page63%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-60%27/%3E%0A%3Cuse x=%2710.51608%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( &amp;lt; k \)" style="height: 0.8172em; vertical-align: -0.0875em; display: inline-block" class="org-latex org-latex-inline" /> paths by asking, for each pair <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2732.316663pt%27 height=%279.85568pt%27 viewBox=%27-.500002 -7.4185 32.316663 9.85568%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-60%27 d=%27m6.724782-4.961395c.119552-.059776 .18929-.109589 .18929-.219178s-.089664-.199253-.199253-.199253c-.029888 0-.049813 0-.179328 .069738l-5.519303 2.600249c-.109589 .049813-.18929 .099626-.18929 .219178s.079701 .169365 .18929 .219178l5.519303 2.600249c.129514 .069738 .14944 .069738 .179328 .069738c.109589 0 .199253-.089664 .199253-.199253s-.069738-.159402-.18929-.219178l-5.230386-2.470735l5.230386-2.470735z%27/%3E%0A%3Cpath id=%27g8-105%27 d=%27m2.82939-6.22665c0-.199253-.139477-.358655-.368618-.358655c-.268991 0-.537983 .259029-.537983 .52802c0 .18929 .139477 .358655 .37858 .358655c.229141 0 .52802-.229141 .52802-.52802zm-.757161 3.745953c.119552-.288917 .119552-.308842 .219178-.577833c.079701-.199253 .129514-.33873 .129514-.52802c0-.448319-.318804-.816936-.816936-.816936c-.936488 0-1.315068 1.444583-1.315068 1.534247c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.019925 .159402-.179328c.268991-.936488 .667497-1.235367 1.006227-1.235367c.079701 0 .249066 0 .249066 .318804c0 .209215-.069738 .418431-.109589 .518057c-.079701 .259029-.52802 1.414695-.687422 1.843088c-.099626 .259029-.229141 .587796-.229141 .797011c0 .468244 .33873 .816936 .816936 .816936c.936488 0 1.305106-1.444583 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.179328 .627646-.508095 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .059776-.388543 .288917-.996264l.388543-1.046077z%27/%3E%0A%3Cpath id=%27g8-106%27 d=%27m3.955168-6.22665c0-.18929-.139477-.358655-.37858-.358655c-.229141 0-.52802 .229141-.52802 .52802c0 .199253 .139477 .358655 .368618 .358655c.268991 0 .537983-.259029 .537983-.52802zm-2.002491 6.724782c-.18929 .757161-.667497 1.325031-1.225405 1.325031c-.059776 0-.209215 0-.388543-.089664c.298879-.069738 .448319-.328767 .448319-.52802c0-.159402-.109589-.348692-.37858-.348692c-.249066 0-.537983 .209215-.537983 .56787c0 .398506 .398506 .617684 .876712 .617684c.697385 0 1.62391-.52802 1.872976-1.514321l.916563-3.646326c.049813-.199253 .049813-.33873 .049813-.368618c0-.56787-.418431-.916563-.916563-.916563c-1.016189 0-1.58406 1.444583-1.58406 1.534247c0 .099626 .099626 .099626 .119552 .099626c.089664 0 .099626-.009963 .179328-.199253c.249066-.607721 .707347-1.215442 1.255293-1.215442c.139477 0 .318804 .039851 .318804 .458281c0 .229141-.029888 .33873-.069738 .508095l-.936488 3.716065z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page64%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-105%27/%3E%0A%3Cuse x=%273.432258%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%277.860066%27 y=%270%27 xlink:href=%27%23g8-106%27/%3E%0A%3Cuse x=%2715.300379%27 y=%270%27 xlink:href=%27%23g8-60%27/%3E%0A%3Cuse x=%2725.816459%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( i, j
   &amp;lt; k \)" style="height: 0.9695em; vertical-align: -0.2397em; display: inline-block" class="org-latex org-latex-inline" /> of nodes: &ldquo;is my current opimal <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2721.281781pt%27 height=%2710.962644pt%27 viewBox=%27-.500002 -7.971982 21.281781 10.962644%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-105%27 d=%27m2.82939-6.22665c0-.199253-.139477-.358655-.368618-.358655c-.268991 0-.537983 .259029-.537983 .52802c0 .18929 .139477 .358655 .37858 .358655c.229141 0 .52802-.229141 .52802-.52802zm-.757161 3.745953c.119552-.288917 .119552-.308842 .219178-.577833c.079701-.199253 .129514-.33873 .129514-.52802c0-.448319-.318804-.816936-.816936-.816936c-.936488 0-1.315068 1.444583-1.315068 1.534247c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.019925 .159402-.179328c.268991-.936488 .667497-1.235367 1.006227-1.235367c.079701 0 .249066 0 .249066 .318804c0 .209215-.069738 .418431-.109589 .518057c-.079701 .259029-.52802 1.414695-.687422 1.843088c-.099626 .259029-.229141 .587796-.229141 .797011c0 .468244 .33873 .816936 .816936 .816936c.936488 0 1.305106-1.444583 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.179328 .627646-.508095 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .059776-.388543 .288917-.996264l.388543-1.046077z%27/%3E%0A%3Cpath id=%27g8-106%27 d=%27m3.955168-6.22665c0-.18929-.139477-.358655-.37858-.358655c-.229141 0-.52802 .229141-.52802 .52802c0 .199253 .139477 .358655 .368618 .358655c.268991 0 .537983-.259029 .537983-.52802zm-2.002491 6.724782c-.18929 .757161-.667497 1.325031-1.225405 1.325031c-.059776 0-.209215 0-.388543-.089664c.298879-.069738 .448319-.328767 .448319-.52802c0-.159402-.109589-.348692-.37858-.348692c-.249066 0-.537983 .209215-.537983 .56787c0 .398506 .398506 .617684 .876712 .617684c.697385 0 1.62391-.52802 1.872976-1.514321l.916563-3.646326c.049813-.199253 .049813-.33873 .049813-.368618c0-.56787-.418431-.916563-.916563-.916563c-1.016189 0-1.58406 1.444583-1.58406 1.534247c0 .099626 .099626 .099626 .119552 .099626c.089664 0 .099626-.009963 .179328-.199253c.249066-.607721 .707347-1.215442 1.255293-1.215442c.139477 0 .318804 .039851 .318804 .458281c0 .229141-.029888 .33873-.069738 .508095l-.936488 3.716065z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page65%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%273.874374%27 y=%270%27 xlink:href=%27%23g8-105%27/%3E%0A%3Cuse x=%277.306632%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2711.73444%27 y=%270%27 xlink:href=%27%23g8-106%27/%3E%0A%3Cuse x=%2716.407421%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( (i,j) \)" style="height: 1.0784em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" />-path as good as going <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2723.461063pt%27 height=%279.85568pt%27 viewBox=%27-.500002 -7.4185 23.461063 9.85568%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-105%27 d=%27m2.82939-6.22665c0-.199253-.139477-.358655-.368618-.358655c-.268991 0-.537983 .259029-.537983 .52802c0 .18929 .139477 .358655 .37858 .358655c.229141 0 .52802-.229141 .52802-.52802zm-.757161 3.745953c.119552-.288917 .119552-.308842 .219178-.577833c.079701-.199253 .129514-.33873 .129514-.52802c0-.448319-.318804-.816936-.816936-.816936c-.936488 0-1.315068 1.444583-1.315068 1.534247c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.019925 .159402-.179328c.268991-.936488 .667497-1.235367 1.006227-1.235367c.079701 0 .249066 0 .249066 .318804c0 .209215-.069738 .418431-.109589 .518057c-.079701 .259029-.52802 1.414695-.687422 1.843088c-.099626 .259029-.229141 .587796-.229141 .797011c0 .468244 .33873 .816936 .816936 .816936c.936488 0 1.305106-1.444583 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.179328 .627646-.508095 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .059776-.388543 .288917-.996264l.388543-1.046077z%27/%3E%0A%3Cpath id=%27g8-106%27 d=%27m3.955168-6.22665c0-.18929-.139477-.358655-.37858-.358655c-.229141 0-.52802 .229141-.52802 .52802c0 .199253 .139477 .358655 .368618 .358655c.268991 0 .537983-.259029 .537983-.52802zm-2.002491 6.724782c-.18929 .757161-.667497 1.325031-1.225405 1.325031c-.059776 0-.209215 0-.388543-.089664c.298879-.069738 .448319-.328767 .448319-.52802c0-.159402-.109589-.348692-.37858-.348692c-.249066 0-.537983 .209215-.537983 .56787c0 .398506 .398506 .617684 .876712 .617684c.697385 0 1.62391-.52802 1.872976-1.514321l.916563-3.646326c.049813-.199253 .049813-.33873 .049813-.368618c0-.56787-.418431-.916563-.916563-.916563c-1.016189 0-1.58406 1.444583-1.58406 1.534247c0 .099626 .099626 .099626 .119552 .099626c.089664 0 .099626-.009963 .179328-.199253c.249066-.607721 .707347-1.215442 1.255293-1.215442c.139477 0 .318804 .039851 .318804 .458281c0 .229141-.029888 .33873-.069738 .508095l-.936488 3.716065z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page66%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-105%27/%3E%0A%3Cuse x=%273.432258%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%277.860066%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3Cuse x=%2713.360286%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2717.788094%27 y=%270%27 xlink:href=%27%23g8-106%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(
   i,k,j \)" style="height: 0.9695em; vertical-align: -0.2397em; display: inline-block" class="org-latex org-latex-inline" />?&rdquo;</li>
<li>We compute the optimal paths from <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.500221pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 6.500221 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page79%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( k \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> to everywhere (that is <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2717.016298pt%27 height=%278.308017pt%27 viewBox=%27-.500002 -7.4185 17.016298 8.308017%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-60%27 d=%27m6.724782-4.961395c.119552-.059776 .18929-.109589 .18929-.219178s-.089664-.199253-.199253-.199253c-.029888 0-.049813 0-.179328 .069738l-5.519303 2.600249c-.109589 .049813-.18929 .099626-.18929 .219178s.079701 .169365 .18929 .219178l5.519303 2.600249c.129514 .069738 .14944 .069738 .179328 .069738c.109589 0 .199253-.089664 .199253-.199253s-.069738-.159402-.18929-.219178l-5.230386-2.470735l5.230386-2.470735z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page73%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-60%27/%3E%0A%3Cuse x=%2710.51608%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( &amp;lt;k \)" style="height: 0.8172em; vertical-align: -0.0875em; display: inline-block" class="org-latex org-latex-inline" />) by gluing together
the paths from <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.500221pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 6.500221 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page79%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( k \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> to everywhere (<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2717.016298pt%27 height=%278.308017pt%27 viewBox=%27-.500002 -7.4185 17.016298 8.308017%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-60%27 d=%27m6.724782-4.961395c.119552-.059776 .18929-.109589 .18929-.219178s-.089664-.199253-.199253-.199253c-.029888 0-.049813 0-.179328 .069738l-5.519303 2.600249c-.109589 .049813-.18929 .099626-.18929 .219178s.079701 .169365 .18929 .219178l5.519303 2.600249c.129514 .069738 .14944 .069738 .179328 .069738c.109589 0 .199253-.089664 .199253-.199253s-.069738-.159402-.18929-.219178l-5.230386-2.470735l5.230386-2.470735z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page73%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-60%27/%3E%0A%3Cuse x=%2710.51608%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( &amp;lt;k \)" style="height: 0.8172em; vertical-align: -0.0875em; display: inline-block" class="org-latex org-latex-inline" />) with the paths from everywhere (<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2717.016298pt%27 height=%278.308017pt%27 viewBox=%27-.500002 -7.4185 17.016298 8.308017%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-60%27 d=%27m6.724782-4.961395c.119552-.059776 .18929-.109589 .18929-.219178s-.089664-.199253-.199253-.199253c-.029888 0-.049813 0-.179328 .069738l-5.519303 2.600249c-.109589 .049813-.18929 .099626-.18929 .219178s.079701 .169365 .18929 .219178l5.519303 2.600249c.129514 .069738 .14944 .069738 .179328 .069738c.109589 0 .199253-.089664 .199253-.199253s-.069738-.159402-.18929-.219178l-5.230386-2.470735l5.230386-2.470735z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page73%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-60%27/%3E%0A%3Cuse x=%2710.51608%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( &amp;lt;k \)" style="height: 0.8172em; vertical-align: -0.0875em; display: inline-block" class="org-latex org-latex-inline" />) to
everywhere (<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2717.016298pt%27 height=%278.308017pt%27 viewBox=%27-.500002 -7.4185 17.016298 8.308017%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-60%27 d=%27m6.724782-4.961395c.119552-.059776 .18929-.109589 .18929-.219178s-.089664-.199253-.199253-.199253c-.029888 0-.049813 0-.179328 .069738l-5.519303 2.600249c-.109589 .049813-.18929 .099626-.18929 .219178s.079701 .169365 .18929 .219178l5.519303 2.600249c.129514 .069738 .14944 .069738 .179328 .069738c.109589 0 .199253-.089664 .199253-.199253s-.069738-.159402-.18929-.219178l-5.230386-2.470735l5.230386-2.470735z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page73%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-60%27/%3E%0A%3Cuse x=%2710.51608%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( &amp;lt;k \)" style="height: 0.8172em; vertical-align: -0.0875em; display: inline-block" class="org-latex org-latex-inline" />).</li>
<li>We compute the optimal paths from everywhere (again <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2717.016298pt%27 height=%278.308017pt%27 viewBox=%27-.500002 -7.4185 17.016298 8.308017%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-60%27 d=%27m6.724782-4.961395c.119552-.059776 .18929-.109589 .18929-.219178s-.089664-.199253-.199253-.199253c-.029888 0-.049813 0-.179328 .069738l-5.519303 2.600249c-.109589 .049813-.18929 .099626-.18929 .219178s.079701 .169365 .18929 .219178l5.519303 2.600249c.129514 .069738 .14944 .069738 .179328 .069738c.109589 0 .199253-.089664 .199253-.199253s-.069738-.159402-.18929-.219178l-5.230386-2.470735l5.230386-2.470735z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page73%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-60%27/%3E%0A%3Cuse x=%2710.51608%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( &amp;lt;k \)" style="height: 0.8172em; vertical-align: -0.0875em; display: inline-block" class="org-latex org-latex-inline" />) to <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.500221pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 6.500221 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page79%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( k \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> by gluing together
the paths from everywhere to everywhere with the paths from everywhere to <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.500221pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 6.500221 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page75%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(
   k \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />.</li>
<li>The best path from <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.500221pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 6.500221 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page79%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( k \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> to <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.500221pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 6.500221 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page79%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( k \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> is the empty path, the multiplicative
identity.</li>
</ol>

<p>
When we try to formulate these steps as matrix operations, we get that the new
matrix of optimal paths is the sum of two matrices:
</p>

<ol class="org-ol">
<li>The matrix computed with the exterior product of the <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.500221pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 6.500221 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page79%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( k \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />&rsquo;t column with
the <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.500221pt%27 height=%277.918502pt%27 viewBox=%27-.500002 -7.4185 6.500221 7.918502%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page79%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( k \)" style="height: 0.7789em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />&rsquo;th row of the adjacency matrix. This is the <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2723.461063pt%27 height=%279.85568pt%27 viewBox=%27-.500002 -7.4185 23.461063 9.85568%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-105%27 d=%27m2.82939-6.22665c0-.199253-.139477-.358655-.368618-.358655c-.268991 0-.537983 .259029-.537983 .52802c0 .18929 .139477 .358655 .37858 .358655c.229141 0 .52802-.229141 .52802-.52802zm-.757161 3.745953c.119552-.288917 .119552-.308842 .219178-.577833c.079701-.199253 .129514-.33873 .129514-.52802c0-.448319-.318804-.816936-.816936-.816936c-.936488 0-1.315068 1.444583-1.315068 1.534247c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.019925 .159402-.179328c.268991-.936488 .667497-1.235367 1.006227-1.235367c.079701 0 .249066 0 .249066 .318804c0 .209215-.069738 .418431-.109589 .518057c-.079701 .259029-.52802 1.414695-.687422 1.843088c-.099626 .259029-.229141 .587796-.229141 .797011c0 .468244 .33873 .816936 .816936 .816936c.936488 0 1.305106-1.444583 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.179328 .627646-.508095 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .059776-.388543 .288917-.996264l.388543-1.046077z%27/%3E%0A%3Cpath id=%27g8-106%27 d=%27m3.955168-6.22665c0-.18929-.139477-.358655-.37858-.358655c-.229141 0-.52802 .229141-.52802 .52802c0 .199253 .139477 .358655 .368618 .358655c.268991 0 .537983-.259029 .537983-.52802zm-2.002491 6.724782c-.18929 .757161-.667497 1.325031-1.225405 1.325031c-.059776 0-.209215 0-.388543-.089664c.298879-.069738 .448319-.328767 .448319-.52802c0-.159402-.109589-.348692-.37858-.348692c-.249066 0-.537983 .209215-.537983 .56787c0 .398506 .398506 .617684 .876712 .617684c.697385 0 1.62391-.52802 1.872976-1.514321l.916563-3.646326c.049813-.199253 .049813-.33873 .049813-.368618c0-.56787-.418431-.916563-.916563-.916563c-1.016189 0-1.58406 1.444583-1.58406 1.534247c0 .099626 .099626 .099626 .119552 .099626c.089664 0 .099626-.009963 .179328-.199253c.249066-.607721 .707347-1.215442 1.255293-1.215442c.139477 0 .318804 .039851 .318804 .458281c0 .229141-.029888 .33873-.069738 .508095l-.936488 3.716065z%27/%3E%0A%3Cpath id=%27g8-107%27 d=%27m2.859278-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365l-.029888 .199253l-1.444583 5.738481c-.039851 .139477-.039851 .159402-.039851 .219178c0 .229141 .199253 .278954 .288917 .278954c.129514 0 .278954-.089664 .33873-.209215c.049813-.089664 .498132-1.932752 .557908-2.181818c.33873 .029888 1.155666 .18929 1.155666 .846824c0 .069738 0 .109589-.029888 .209215c-.019925 .119552-.039851 .239103-.039851 .348692c0 .587796 .398506 .986301 .916563 .986301c.298879 0 .56787-.159402 .787049-.52802c.249066-.438356 .358655-.986301 .358655-1.006227c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.199253 .727273-.428394 1.235367-.86675 1.235367c-.18929 0-.318804-.109589-.318804-.468244c0-.169365 .039851-.398506 .079701-.557908c.039851-.169365 .039851-.209215 .039851-.308842c0-.647572-.627646-.936488-1.474471-1.046077c.308842-.179328 .627646-.498132 .856787-.737235c.478207-.52802 .936488-.956413 1.424658-.956413c.059776 0 .069738 0 .089664 .009963c.119552 .019925 .129514 .019925 .209215 .079701c.019925 .009963 .019925 .019925 .039851 .039851c-.478207 .029888-.56787 .418431-.56787 .537983c0 .159402 .109589 .348692 .37858 .348692c.259029 0 .547945-.219178 .547945-.607721c0-.298879-.229141-.627646-.67746-.627646c-.278954 0-.737235 .079701-1.454545 .876712c-.33873 .37858-.727273 .777086-1.105853 .926526l1.036115-4.204234z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page80%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-105%27/%3E%0A%3Cuse x=%273.432258%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%277.860066%27 y=%270%27 xlink:href=%27%23g8-107%27/%3E%0A%3Cuse x=%2713.360286%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2717.788094%27 y=%270%27 xlink:href=%27%23g8-106%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( i,k,j \)" style="height: 0.9695em; vertical-align: -0.2397em; display: inline-block" class="org-latex org-latex-inline" /> part.</li>
<li>The block matrix which contains <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2725.764847pt%27 height=%2710.132398pt%27 viewBox=%27-.500002 -7.307786 25.764847 10.132398%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-49%27 d=%27m2.336239-4.435367c0-.188294-.013948-.195268-.209215-.195268c-.446326 .439352-1.080946 .446326-1.366874 .446326v.251059c.167372 0 .627646 0 1.011208-.195268v3.556663c0 .230137 0 .320797-.697385 .320797h-.265006v.251059c.125529-.006974 .983313-.027895 1.241345-.027895c.216189 0 1.094894 .020922 1.248319 .027895v-.251059h-.265006c-.697385 0-.697385-.09066-.697385-.320797v-3.863512z%27/%3E%0A%3Cpath id=%27g4-0%27 d=%27m5.188543-1.57609c.111582 0 .278954 0 .278954-.167372c0-.174346-.160399-.174346-.278954-.174346h-4.156413c-.111582 0-.278954 0-.278954 .167372c0 .174346 .160399 .174346 .278954 .174346h4.156413z%27/%3E%0A%3Cpath id=%27g7-107%27 d=%27m2.182814-4.630635c.006974-.013948 .027895-.104608 .027895-.111582c0-.034869-.027895-.097634-.111582-.097634c-.139477 0-.718306 .055791-.892653 .069738c-.055791 .006974-.153425 .013948-.153425 .160399c0 .097634 .097634 .097634 .18132 .097634c.334745 0 .334745 .048817 .334745 .104608c0 .048817-.013948 .09066-.027895 .153425l-.983313 3.947198c-.034869 .125529-.034869 .139477-.034869 .153425c0 .104608 .083686 .223163 .237111 .223163c.188294 0 .278954-.139477 .320797-.292902c.013948-.027895 .313823-1.255293 .341719-1.352927c.495143 .048817 .892653 .209215 .892653 .571856c0 .034869 0 .069738-.013948 .139477c-.027895 .104608-.027895 .139477-.027895 .216189c0 .495143 .404483 .718306 .739228 .718306c.676463 0 .885679-1.060025 .885679-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .034869-.139477 .167372c-.083686 .299875-.27198 .795019-.613699 .795019c-.188294 0-.244085-.174346-.244085-.36264c0-.118555 0-.132503 .041843-.313823c.006974-.020922 .034869-.139477 .034869-.216189c0-.620672-.836862-.718306-1.129763-.739228c.202242-.125529 .460274-.355666 .578829-.460274c.355666-.334745 .704359-.662516 1.094894-.662516c.083686 0 .174346 .020922 .230137 .09066c-.299875 .048817-.36264 .285928-.36264 .390535c0 .153425 .118555 .258032 .278954 .258032c.188294 0 .397509-.153425 .397509-.446326c0-.230137-.167372-.488169-.536986-.488169c-.397509 0-.760149 .285928-1.115816 .613699c-.292902 .278954-.523039 .495143-.808966 .613699l.690411-2.782565z%27/%3E%0A%3Cpath id=%27g8-77%27 d=%27m9.225405-6.03736c.089664-.358655 .109589-.458281 .856787-.458281c.229141 0 .318804 0 .318804-.199253c0-.109589-.099626-.109589-.268991-.109589h-1.315068c-.259029 0-.268991 0-.388543 .18929l-3.636364 5.678705l-.777086-5.638854c-.029888-.229141-.049813-.229141-.308842-.229141h-1.364882c-.18929 0-.298879 0-.298879 .18929c0 .119552 .089664 .119552 .288917 .119552c.129514 0 .308842 .009963 .428394 .019925c.159402 .019925 .219178 .049813 .219178 .159402c0 .039851-.009963 .069738-.039851 .18929l-1.265255 5.070984c-.099626 .398506-.268991 .71731-1.075965 .747198c-.049813 0-.179328 .009963-.179328 .18929c0 .089664 .059776 .119552 .139477 .119552c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.109589-.109589-.179328-.109589c-.56787-.009963-.67746-.209215-.67746-.438356c0-.069738 .009963-.119552 .039851-.229141l1.354919-5.429639h.009963l.856787 6.176837c.019925 .119552 .029888 .229141 .14944 .229141c.109589 0 .169365-.109589 .219178-.179328l4.024907-6.306351h.009963l-1.424658 5.708593c-.099626 .388543-.119552 .468244-.9066 .468244c-.169365 0-.278954 0-.278954 .18929c0 .119552 .119552 .119552 .14944 .119552c.278954 0 .956413-.029888 1.235367-.029888c.408468 0 .836862 .029888 1.24533 .029888c.059776 0 .18929 0 .18929-.199253c0-.109589-.089664-.109589-.278954-.109589c-.368618 0-.647572 0-.647572-.179328c0-.039851 0-.059776 .049813-.239103l1.325031-5.310087z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page81%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%279.66516%27 y=%271.494381%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%2714.068814%27 y=%271.494381%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%2720.295494%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( M_{k-1} \)" style="height: 0.9967em; vertical-align: -0.2779em; display: inline-block" class="org-latex org-latex-inline" />, <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2761.33299pt%27 height=%2710.658182pt%27 viewBox=%27-.500002 -7.307786 61.33299 10.658182%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-49%27 d=%27m2.336239-4.435367c0-.188294-.013948-.195268-.209215-.195268c-.446326 .439352-1.080946 .446326-1.366874 .446326v.251059c.167372 0 .627646 0 1.011208-.195268v3.556663c0 .230137 0 .320797-.697385 .320797h-.265006v.251059c.125529-.006974 .983313-.027895 1.241345-.027895c.216189 0 1.094894 .020922 1.248319 .027895v-.251059h-.265006c-.697385 0-.697385-.09066-.697385-.320797v-3.863512z%27/%3E%0A%3Cpath id=%27g0-58%27 d=%27m1.527273-2.601245c0-.244085-.195268-.404483-.397509-.404483c-.244085 0-.404483 .195268-.404483 .397509c0 .244085 .195268 .404483 .397509 .404483c.244085 0 .404483-.195268 .404483-.397509zm0 2.203736c0-.244085-.195268-.404483-.397509-.404483c-.244085 0-.404483 .195268-.404483 .397509c0 .244085 .195268 .404483 .397509 .404483c.244085 0 .404483-.195268 .404483-.397509z%27/%3E%0A%3Cpath id=%27g4-0%27 d=%27m5.188543-1.57609c.111582 0 .278954 0 .278954-.167372c0-.174346-.160399-.174346-.278954-.174346h-4.156413c-.111582 0-.278954 0-.278954 .167372c0 .174346 .160399 .174346 .278954 .174346h4.156413z%27/%3E%0A%3Cpath id=%27g7-59%27 d=%27m1.471482-.111582c0 .383562-.069738 .829888-.54396 1.276214c-.027895 .027895-.048817 .048817-.048817 .083686c0 .048817 .055791 .097634 .097634 .097634c.097634 0 .690411-.557908 .690411-1.387796c0-.432379-.167372-.760149-.488169-.760149c-.230137 0-.397509 .18132-.397509 .397509c0 .223163 .160399 .404483 .404483 .404483c.167372 0 .278954-.111582 .285928-.111582z%27/%3E%0A%3Cpath id=%27g7-107%27 d=%27m2.182814-4.630635c.006974-.013948 .027895-.104608 .027895-.111582c0-.034869-.027895-.097634-.111582-.097634c-.139477 0-.718306 .055791-.892653 .069738c-.055791 .006974-.153425 .013948-.153425 .160399c0 .097634 .097634 .097634 .18132 .097634c.334745 0 .334745 .048817 .334745 .104608c0 .048817-.013948 .09066-.027895 .153425l-.983313 3.947198c-.034869 .125529-.034869 .139477-.034869 .153425c0 .104608 .083686 .223163 .237111 .223163c.188294 0 .278954-.139477 .320797-.292902c.013948-.027895 .313823-1.255293 .341719-1.352927c.495143 .048817 .892653 .209215 .892653 .571856c0 .034869 0 .069738-.013948 .139477c-.027895 .104608-.027895 .139477-.027895 .216189c0 .495143 .404483 .718306 .739228 .718306c.676463 0 .885679-1.060025 .885679-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .034869-.139477 .167372c-.083686 .299875-.27198 .795019-.613699 .795019c-.188294 0-.244085-.174346-.244085-.36264c0-.118555 0-.132503 .041843-.313823c.006974-.020922 .034869-.139477 .034869-.216189c0-.620672-.836862-.718306-1.129763-.739228c.202242-.125529 .460274-.355666 .578829-.460274c.355666-.334745 .704359-.662516 1.094894-.662516c.083686 0 .174346 .020922 .230137 .09066c-.299875 .048817-.36264 .285928-.36264 .390535c0 .153425 .118555 .258032 .278954 .258032c.188294 0 .397509-.153425 .397509-.446326c0-.230137-.167372-.488169-.536986-.488169c-.397509 0-.760149 .285928-1.115816 .613699c-.292902 .278954-.523039 .495143-.808966 .613699l.690411-2.782565z%27/%3E%0A%3Cpath id=%27g8-65%27 d=%27m1.783313-1.145704c-.398506 .667497-.787049 .806974-1.225405 .836862c-.119552 .009963-.209215 .009963-.209215 .199253c0 .059776 .049813 .109589 .129514 .109589c.268991 0 .577833-.029888 .856787-.029888c.328767 0 .67746 .029888 .996264 .029888c.059776 0 .18929 0 .18929-.18929c0-.109589-.089664-.119552-.159402-.119552c-.229141-.019925-.468244-.099626-.468244-.348692c0-.119552 .059776-.229141 .139477-.368618l.757161-1.275218h2.500623c.019925 .209215 .159402 1.564134 .159402 1.663761c0 .298879-.518057 .328767-.71731 .328767c-.139477 0-.239103 0-.239103 .199253c0 .109589 .119552 .109589 .139477 .109589c.408468 0 .836862-.029888 1.24533-.029888c.249066 0 .876712 .029888 1.125778 .029888c.059776 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.229141-.109589c-.617684 0-.617684-.069738-.647572-.358655l-.607721-6.22665c-.019925-.199253-.019925-.239103-.18929-.239103c-.159402 0-.199253 .069738-.259029 .169365l-3.466999 5.818182zm1.195517-1.464508l1.96264-3.287671l.318804 3.287671h-2.281445z%27/%3E%0A%3Cpath id=%27g8-77%27 d=%27m9.225405-6.03736c.089664-.358655 .109589-.458281 .856787-.458281c.229141 0 .318804 0 .318804-.199253c0-.109589-.099626-.109589-.268991-.109589h-1.315068c-.259029 0-.268991 0-.388543 .18929l-3.636364 5.678705l-.777086-5.638854c-.029888-.229141-.049813-.229141-.308842-.229141h-1.364882c-.18929 0-.298879 0-.298879 .18929c0 .119552 .089664 .119552 .288917 .119552c.129514 0 .308842 .009963 .428394 .019925c.159402 .019925 .219178 .049813 .219178 .159402c0 .039851-.009963 .069738-.039851 .18929l-1.265255 5.070984c-.099626 .398506-.268991 .71731-1.075965 .747198c-.049813 0-.179328 .009963-.179328 .18929c0 .089664 .059776 .119552 .139477 .119552c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.109589-.109589-.179328-.109589c-.56787-.009963-.67746-.209215-.67746-.438356c0-.069738 .009963-.119552 .039851-.229141l1.354919-5.429639h.009963l.856787 6.176837c.019925 .119552 .029888 .229141 .14944 .229141c.109589 0 .169365-.109589 .219178-.179328l4.024907-6.306351h.009963l-1.424658 5.708593c-.099626 .388543-.119552 .468244-.9066 .468244c-.169365 0-.278954 0-.278954 .18929c0 .119552 .119552 .119552 .14944 .119552c.278954 0 .956413-.029888 1.235367-.029888c.408468 0 .836862 .029888 1.24533 .029888c.059776 0 .18929 0 .18929-.199253c0-.109589-.089664-.109589-.278954-.109589c-.368618 0-.647572 0-.647572-.179328c0-.039851 0-.059776 .049813-.239103l1.325031-5.310087z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page82%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%279.66516%27 y=%271.494381%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%2714.068814%27 y=%271.494381%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%2720.295494%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%2724.764847%27 y=%270%27 xlink:href=%27%23g8-65%27/%3E%0A%3Cuse x=%2732.236847%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%2736.208087%27 y=%271.494381%27 xlink:href=%27%23g0-58%27/%3E%0A%3Cuse x=%2738.463533%27 y=%271.494381%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%2742.867187%27 y=%271.494381%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%2749.093866%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%2753.065107%27 y=%271.494381%27 xlink:href=%27%23g7-59%27/%3E%0A%3Cuse x=%2755.431248%27 y=%271.494381%27 xlink:href=%27%23g7-107%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( M_{k-1} A_{1:k-1,k} \)" style="height: 1.0484em; vertical-align: -0.3296em; display: inline-block" class="org-latex org-latex-inline" />, <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2761.33299pt%27 height=%2710.658182pt%27 viewBox=%27-.500002 -7.307786 61.33299 10.658182%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g4-0%27 d=%27m5.188543-1.57609c.111582 0 .278954 0 .278954-.167372c0-.174346-.160399-.174346-.278954-.174346h-4.156413c-.111582 0-.278954 0-.278954 .167372c0 .174346 .160399 .174346 .278954 .174346h4.156413z%27/%3E%0A%3Cpath id=%27g0-49%27 d=%27m2.336239-4.435367c0-.188294-.013948-.195268-.209215-.195268c-.446326 .439352-1.080946 .446326-1.366874 .446326v.251059c.167372 0 .627646 0 1.011208-.195268v3.556663c0 .230137 0 .320797-.697385 .320797h-.265006v.251059c.125529-.006974 .983313-.027895 1.241345-.027895c.216189 0 1.094894 .020922 1.248319 .027895v-.251059h-.265006c-.697385 0-.697385-.09066-.697385-.320797v-3.863512z%27/%3E%0A%3Cpath id=%27g0-58%27 d=%27m1.527273-2.601245c0-.244085-.195268-.404483-.397509-.404483c-.244085 0-.404483 .195268-.404483 .397509c0 .244085 .195268 .404483 .397509 .404483c.244085 0 .404483-.195268 .404483-.397509zm0 2.203736c0-.244085-.195268-.404483-.397509-.404483c-.244085 0-.404483 .195268-.404483 .397509c0 .244085 .195268 .404483 .397509 .404483c.244085 0 .404483-.195268 .404483-.397509z%27/%3E%0A%3Cpath id=%27g7-59%27 d=%27m1.471482-.111582c0 .383562-.069738 .829888-.54396 1.276214c-.027895 .027895-.048817 .048817-.048817 .083686c0 .048817 .055791 .097634 .097634 .097634c.097634 0 .690411-.557908 .690411-1.387796c0-.432379-.167372-.760149-.488169-.760149c-.230137 0-.397509 .18132-.397509 .397509c0 .223163 .160399 .404483 .404483 .404483c.167372 0 .278954-.111582 .285928-.111582z%27/%3E%0A%3Cpath id=%27g7-107%27 d=%27m2.182814-4.630635c.006974-.013948 .027895-.104608 .027895-.111582c0-.034869-.027895-.097634-.111582-.097634c-.139477 0-.718306 .055791-.892653 .069738c-.055791 .006974-.153425 .013948-.153425 .160399c0 .097634 .097634 .097634 .18132 .097634c.334745 0 .334745 .048817 .334745 .104608c0 .048817-.013948 .09066-.027895 .153425l-.983313 3.947198c-.034869 .125529-.034869 .139477-.034869 .153425c0 .104608 .083686 .223163 .237111 .223163c.188294 0 .278954-.139477 .320797-.292902c.013948-.027895 .313823-1.255293 .341719-1.352927c.495143 .048817 .892653 .209215 .892653 .571856c0 .034869 0 .069738-.013948 .139477c-.027895 .104608-.027895 .139477-.027895 .216189c0 .495143 .404483 .718306 .739228 .718306c.676463 0 .885679-1.060025 .885679-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .034869-.139477 .167372c-.083686 .299875-.27198 .795019-.613699 .795019c-.188294 0-.244085-.174346-.244085-.36264c0-.118555 0-.132503 .041843-.313823c.006974-.020922 .034869-.139477 .034869-.216189c0-.620672-.836862-.718306-1.129763-.739228c.202242-.125529 .460274-.355666 .578829-.460274c.355666-.334745 .704359-.662516 1.094894-.662516c.083686 0 .174346 .020922 .230137 .09066c-.299875 .048817-.36264 .285928-.36264 .390535c0 .153425 .118555 .258032 .278954 .258032c.188294 0 .397509-.153425 .397509-.446326c0-.230137-.167372-.488169-.536986-.488169c-.397509 0-.760149 .285928-1.115816 .613699c-.292902 .278954-.523039 .495143-.808966 .613699l.690411-2.782565z%27/%3E%0A%3Cpath id=%27g8-65%27 d=%27m1.783313-1.145704c-.398506 .667497-.787049 .806974-1.225405 .836862c-.119552 .009963-.209215 .009963-.209215 .199253c0 .059776 .049813 .109589 .129514 .109589c.268991 0 .577833-.029888 .856787-.029888c.328767 0 .67746 .029888 .996264 .029888c.059776 0 .18929 0 .18929-.18929c0-.109589-.089664-.119552-.159402-.119552c-.229141-.019925-.468244-.099626-.468244-.348692c0-.119552 .059776-.229141 .139477-.368618l.757161-1.275218h2.500623c.019925 .209215 .159402 1.564134 .159402 1.663761c0 .298879-.518057 .328767-.71731 .328767c-.139477 0-.239103 0-.239103 .199253c0 .109589 .119552 .109589 .139477 .109589c.408468 0 .836862-.029888 1.24533-.029888c.249066 0 .876712 .029888 1.125778 .029888c.059776 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.229141-.109589c-.617684 0-.617684-.069738-.647572-.358655l-.607721-6.22665c-.019925-.199253-.019925-.239103-.18929-.239103c-.159402 0-.199253 .069738-.259029 .169365l-3.466999 5.818182zm1.195517-1.464508l1.96264-3.287671l.318804 3.287671h-2.281445z%27/%3E%0A%3Cpath id=%27g8-77%27 d=%27m9.225405-6.03736c.089664-.358655 .109589-.458281 .856787-.458281c.229141 0 .318804 0 .318804-.199253c0-.109589-.099626-.109589-.268991-.109589h-1.315068c-.259029 0-.268991 0-.388543 .18929l-3.636364 5.678705l-.777086-5.638854c-.029888-.229141-.049813-.229141-.308842-.229141h-1.364882c-.18929 0-.298879 0-.298879 .18929c0 .119552 .089664 .119552 .288917 .119552c.129514 0 .308842 .009963 .428394 .019925c.159402 .019925 .219178 .049813 .219178 .159402c0 .039851-.009963 .069738-.039851 .18929l-1.265255 5.070984c-.099626 .398506-.268991 .71731-1.075965 .747198c-.049813 0-.179328 .009963-.179328 .18929c0 .089664 .059776 .119552 .139477 .119552c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.109589-.109589-.179328-.109589c-.56787-.009963-.67746-.209215-.67746-.438356c0-.069738 .009963-.119552 .039851-.229141l1.354919-5.429639h.009963l.856787 6.176837c.019925 .119552 .029888 .229141 .14944 .229141c.109589 0 .169365-.109589 .219178-.179328l4.024907-6.306351h.009963l-1.424658 5.708593c-.099626 .388543-.119552 .468244-.9066 .468244c-.169365 0-.278954 0-.278954 .18929c0 .119552 .119552 .119552 .14944 .119552c.278954 0 .956413-.029888 1.235367-.029888c.408468 0 .836862 .029888 1.24533 .029888c.059776 0 .18929 0 .18929-.199253c0-.109589-.089664-.109589-.278954-.109589c-.368618 0-.647572 0-.647572-.179328c0-.039851 0-.059776 .049813-.239103l1.325031-5.310087z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page83%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-65%27/%3E%0A%3Cuse x=%277.471999%27 y=%271.494381%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%2711.875653%27 y=%271.494381%27 xlink:href=%27%23g7-59%27/%3E%0A%3Cuse x=%2714.241795%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%2718.213035%27 y=%271.494381%27 xlink:href=%27%23g0-58%27/%3E%0A%3Cuse x=%2720.468481%27 y=%271.494381%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%2724.872135%27 y=%271.494381%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%2731.098814%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%2735.568146%27 y=%270%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%2745.233306%27 y=%271.494381%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%2749.636961%27 y=%271.494381%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%2755.86364%27 y=%271.494381%27 xlink:href=%27%23g0-49%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(
   A_{k, 1:k-1} M_{k-1} \)" style="height: 1.0484em; vertical-align: -0.3296em; display: inline-block" class="org-latex org-latex-inline" /> and <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%275.981339pt%27 height=%277.42037pt%27 viewBox=%27-.500002 -6.920368 5.981339 7.42037%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g1-49%27 d=%27m2.929016-6.37609c0-.239103 0-.259029-.229141-.259029c-.617684 .637609-1.494396 .637609-1.8132 .637609v.308842c.199253 0 .787049 0 1.305106-.259029v5.160648c0 .358655-.029888 .478207-.926526 .478207h-.318804v.308842c.348692-.029888 1.215442-.029888 1.613948-.029888s1.265255 0 1.613948 .029888v-.308842h-.318804c-.896638 0-.926526-.109589-.926526-.478207v-5.589041z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page84%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g1-49%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( 1 \)" style="height: 0.7299em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />.</li>
</ol>


<div class="equation-container">
<span class="equation">
<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27613.000002pt%27 height=%2725.906832pt%27 viewBox=%27-.500002 -20.42551 613.000002 25.906832%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g4-0%27 d=%27m5.188543-1.57609c.111582 0 .278954 0 .278954-.167372c0-.174346-.160399-.174346-.278954-.174346h-4.156413c-.111582 0-.278954 0-.278954 .167372c0 .174346 .160399 .174346 .278954 .174346h4.156413z%27/%3E%0A%3Cpath id=%27g3-18%27 d=%27m6.973848 23.402242c0-.039851-.019925-.059776-.039851-.089664c-.368618-.368618-1.036115-1.036115-1.703611-2.11208c-1.603985-2.570361-2.331258-5.808219-2.331258-9.643836c0-2.67995 .358655-6.136986 2.002491-9.105853c.787049-1.414695 1.603985-2.231631 2.042341-2.669988c.029888-.029888 .029888-.049813 .029888-.079701c0-.099626-.069738-.099626-.209215-.099626s-.159402 0-.308842 .14944c-3.337484 3.038605-4.383562 7.601494-4.383562 11.795766c0 3.915318 .896638 7.860523 3.427148 10.839352c.199253 .229141 .577833 .637609 .986301 .996264c.119552 .119552 .139477 .119552 .278954 .119552s.209215 0 .209215-.099626z%27/%3E%0A%3Cpath id=%27g3-19%27 d=%27m5.250311 11.556663c0-3.915318-.896638-7.860523-3.427148-10.839352c-.199253-.229141-.577833-.637609-.986301-.996264c-.119552-.119552-.139477-.119552-.278954-.119552c-.119552 0-.209215 0-.209215 .099626c0 .039851 .039851 .079701 .059776 .099626c.348692 .358655 1.016189 1.026152 1.683686 2.102117c1.603985 2.570361 2.331258 5.808219 2.331258 9.643836c0 2.67995-.358655 6.136986-2.002491 9.105853c-.787049 1.414695-1.613948 2.241594-2.032379 2.660025c-.019925 .029888-.039851 .059776-.039851 .089664c0 .099626 .089664 .099626 .209215 .099626c.139477 0 .159402 0 .308842-.14944c3.337484-3.038605 4.383562-7.601494 4.383562-11.795766z%27/%3E%0A%3Cpath id=%27g0-49%27 d=%27m2.336239-4.435367c0-.188294-.013948-.195268-.209215-.195268c-.446326 .439352-1.080946 .446326-1.366874 .446326v.251059c.167372 0 .627646 0 1.011208-.195268v3.556663c0 .230137 0 .320797-.697385 .320797h-.265006v.251059c.125529-.006974 .983313-.027895 1.241345-.027895c.216189 0 1.094894 .020922 1.248319 .027895v-.251059h-.265006c-.697385 0-.697385-.09066-.697385-.320797v-3.863512z%27/%3E%0A%3Cpath id=%27g0-58%27 d=%27m1.527273-2.601245c0-.244085-.195268-.404483-.397509-.404483c-.244085 0-.404483 .195268-.404483 .397509c0 .244085 .195268 .404483 .397509 .404483c.244085 0 .404483-.195268 .404483-.397509zm0 2.203736c0-.244085-.195268-.404483-.397509-.404483c-.244085 0-.404483 .195268-.404483 .397509c0 .244085 .195268 .404483 .397509 .404483c.244085 0 .404483-.195268 .404483-.397509z%27/%3E%0A%3Cpath id=%27g1-43%27 d=%27m4.07472-2.291407h2.779577c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.328767-.199253h-2.779577v-2.789539c0-.139477 0-.328767-.199253-.328767s-.199253 .18929-.199253 .328767v2.789539h-2.789539c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .328767 .199253h2.789539v2.789539c0 .139477 0 .328767 .199253 .328767s.199253-.18929 .199253-.328767v-2.789539z%27/%3E%0A%3Cpath id=%27g1-49%27 d=%27m2.929016-6.37609c0-.239103 0-.259029-.229141-.259029c-.617684 .637609-1.494396 .637609-1.8132 .637609v.308842c.199253 0 .787049 0 1.305106-.259029v5.160648c0 .358655-.029888 .478207-.926526 .478207h-.318804v.308842c.348692-.029888 1.215442-.029888 1.613948-.029888s1.265255 0 1.613948 .029888v-.308842h-.318804c-.896638 0-.926526-.109589-.926526-.478207v-5.589041z%27/%3E%0A%3Cpath id=%27g1-61%27 d=%27m6.844334-3.257783c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.967621c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h5.947696zm.009963 1.932752c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.33873-.199253h-5.947696c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.967621z%27/%3E%0A%3Cpath id=%27g7-59%27 d=%27m1.471482-.111582c0 .383562-.069738 .829888-.54396 1.276214c-.027895 .027895-.048817 .048817-.048817 .083686c0 .048817 .055791 .097634 .097634 .097634c.097634 0 .690411-.557908 .690411-1.387796c0-.432379-.167372-.760149-.488169-.760149c-.230137 0-.397509 .18132-.397509 .397509c0 .223163 .160399 .404483 .404483 .404483c.167372 0 .278954-.111582 .285928-.111582z%27/%3E%0A%3Cpath id=%27g7-107%27 d=%27m2.182814-4.630635c.006974-.013948 .027895-.104608 .027895-.111582c0-.034869-.027895-.097634-.111582-.097634c-.139477 0-.718306 .055791-.892653 .069738c-.055791 .006974-.153425 .013948-.153425 .160399c0 .097634 .097634 .097634 .18132 .097634c.334745 0 .334745 .048817 .334745 .104608c0 .048817-.013948 .09066-.027895 .153425l-.983313 3.947198c-.034869 .125529-.034869 .139477-.034869 .153425c0 .104608 .083686 .223163 .237111 .223163c.188294 0 .278954-.139477 .320797-.292902c.013948-.027895 .313823-1.255293 .341719-1.352927c.495143 .048817 .892653 .209215 .892653 .571856c0 .034869 0 .069738-.013948 .139477c-.027895 .104608-.027895 .139477-.027895 .216189c0 .495143 .404483 .718306 .739228 .718306c.676463 0 .885679-1.060025 .885679-1.066999c0-.09066-.09066-.09066-.111582-.09066c-.097634 0-.104608 .034869-.139477 .167372c-.083686 .299875-.27198 .795019-.613699 .795019c-.188294 0-.244085-.174346-.244085-.36264c0-.118555 0-.132503 .041843-.313823c.006974-.020922 .034869-.139477 .034869-.216189c0-.620672-.836862-.718306-1.129763-.739228c.202242-.125529 .460274-.355666 .578829-.460274c.355666-.334745 .704359-.662516 1.094894-.662516c.083686 0 .174346 .020922 .230137 .09066c-.299875 .048817-.36264 .285928-.36264 .390535c0 .153425 .118555 .258032 .278954 .258032c.188294 0 .397509-.153425 .397509-.446326c0-.230137-.167372-.488169-.536986-.488169c-.397509 0-.760149 .285928-1.115816 .613699c-.292902 .278954-.523039 .495143-.808966 .613699l.690411-2.782565z%27/%3E%0A%3Cpath id=%27g8-65%27 d=%27m1.783313-1.145704c-.398506 .667497-.787049 .806974-1.225405 .836862c-.119552 .009963-.209215 .009963-.209215 .199253c0 .059776 .049813 .109589 .129514 .109589c.268991 0 .577833-.029888 .856787-.029888c.328767 0 .67746 .029888 .996264 .029888c.059776 0 .18929 0 .18929-.18929c0-.109589-.089664-.119552-.159402-.119552c-.229141-.019925-.468244-.099626-.468244-.348692c0-.119552 .059776-.229141 .139477-.368618l.757161-1.275218h2.500623c.019925 .209215 .159402 1.564134 .159402 1.663761c0 .298879-.518057 .328767-.71731 .328767c-.139477 0-.239103 0-.239103 .199253c0 .109589 .119552 .109589 .139477 .109589c.408468 0 .836862-.029888 1.24533-.029888c.249066 0 .876712 .029888 1.125778 .029888c.059776 0 .179328 0 .179328-.199253c0-.109589-.099626-.109589-.229141-.109589c-.617684 0-.617684-.069738-.647572-.358655l-.607721-6.22665c-.019925-.199253-.019925-.239103-.18929-.239103c-.159402 0-.199253 .069738-.259029 .169365l-3.466999 5.818182zm1.195517-1.464508l1.96264-3.287671l.318804 3.287671h-2.281445z%27/%3E%0A%3Cpath id=%27g8-77%27 d=%27m9.225405-6.03736c.089664-.358655 .109589-.458281 .856787-.458281c.229141 0 .318804 0 .318804-.199253c0-.109589-.099626-.109589-.268991-.109589h-1.315068c-.259029 0-.268991 0-.388543 .18929l-3.636364 5.678705l-.777086-5.638854c-.029888-.229141-.049813-.229141-.308842-.229141h-1.364882c-.18929 0-.298879 0-.298879 .18929c0 .119552 .089664 .119552 .288917 .119552c.129514 0 .308842 .009963 .428394 .019925c.159402 .019925 .219178 .049813 .219178 .159402c0 .039851-.009963 .069738-.039851 .18929l-1.265255 5.070984c-.099626 .398506-.268991 .71731-1.075965 .747198c-.049813 0-.179328 .009963-.179328 .18929c0 .089664 .059776 .119552 .139477 .119552c.318804 0 .667497-.029888 .996264-.029888c.33873 0 .697385 .029888 1.026152 .029888c.049813 0 .179328 0 .179328-.199253c0-.109589-.109589-.109589-.179328-.109589c-.56787-.009963-.67746-.209215-.67746-.438356c0-.069738 .009963-.119552 .039851-.229141l1.354919-5.429639h.009963l.856787 6.176837c.019925 .119552 .029888 .229141 .14944 .229141c.109589 0 .169365-.109589 .219178-.179328l4.024907-6.306351h.009963l-1.424658 5.708593c-.099626 .388543-.119552 .468244-.9066 .468244c-.169365 0-.278954 0-.278954 .18929c0 .119552 .119552 .119552 .14944 .119552c.278954 0 .956413-.029888 1.235367-.029888c.408468 0 .836862 .029888 1.24533 .029888c.059776 0 .18929 0 .18929-.199253c0-.109589-.089664-.109589-.278954-.109589c-.368618 0-.647572 0-.647572-.179328c0-.039851 0-.059776 .049813-.239103l1.325031-5.310087z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page85%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%27187.968397%27 y=%27-4.48331%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27197.633558%27 y=%27-2.988929%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27205.302674%27 y=%27-4.48331%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%27215.818754%27 y=%27-4.48331%27 xlink:href=%27%23g8-65%27/%3E%0A%3Cuse x=%27223.290753%27 y=%27-2.988929%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27227.261994%27 y=%27-2.988929%27 xlink:href=%27%23g0-58%27/%3E%0A%3Cuse x=%27229.51744%27 y=%27-2.988929%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27233.921094%27 y=%27-2.988929%27 xlink:href=%27%23g7-59%27/%3E%0A%3Cuse x=%27236.287235%27 y=%27-2.988929%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27241.188998%27 y=%27-4.48331%27 xlink:href=%27%23g8-65%27/%3E%0A%3Cuse x=%27248.660997%27 y=%27-2.988929%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27253.064651%27 y=%27-2.988929%27 xlink:href=%27%23g7-59%27/%3E%0A%3Cuse x=%27255.430792%27 y=%27-2.988929%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27259.402033%27 y=%27-2.988929%27 xlink:href=%27%23g0-58%27/%3E%0A%3Cuse x=%27261.657478%27 y=%27-2.988929%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27268.773107%27 y=%27-4.48331%27 xlink:href=%27%23g1-43%27/%3E%0A%3Cuse x=%27278.73572%27 y=%27-18.53076%27 xlink:href=%27%23g3-18%27/%3E%0A%3Cuse x=%27303.853443%27 y=%27-10.560557%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27313.518603%27 y=%27-9.066176%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27317.922257%27 y=%27-9.066176%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%27324.148937%27 y=%27-9.066176%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27356.36499%27 y=%27-10.560557%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27366.03015%27 y=%27-9.066176%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27370.433805%27 y=%27-9.066176%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%27376.660484%27 y=%27-9.066176%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27381.129838%27 y=%27-10.560557%27 xlink:href=%27%23g8-65%27/%3E%0A%3Cuse x=%27388.601837%27 y=%27-9.066176%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27392.573077%27 y=%27-9.066176%27 xlink:href=%27%23g0-58%27/%3E%0A%3Cuse x=%27394.828523%27 y=%27-9.066176%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27399.232177%27 y=%27-9.066176%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%27405.458856%27 y=%27-9.066176%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27409.430097%27 y=%27-9.066176%27 xlink:href=%27%23g7-59%27/%3E%0A%3Cuse x=%27411.796238%27 y=%27-9.066176%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27286.069364%27 y=%271.394612%27 xlink:href=%27%23g8-65%27/%3E%0A%3Cuse x=%27293.541363%27 y=%272.888992%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27297.945017%27 y=%272.888992%27 xlink:href=%27%23g7-59%27/%3E%0A%3Cuse x=%27300.311159%27 y=%272.888992%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27304.282399%27 y=%272.888992%27 xlink:href=%27%23g0-58%27/%3E%0A%3Cuse x=%27306.537845%27 y=%272.888992%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27310.941499%27 y=%272.888992%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%27317.168179%27 y=%272.888992%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27321.63751%27 y=%271.394612%27 xlink:href=%27%23g8-77%27/%3E%0A%3Cuse x=%27331.30267%27 y=%272.888992%27 xlink:href=%27%23g7-107%27/%3E%0A%3Cuse x=%27335.706325%27 y=%272.888992%27 xlink:href=%27%23g4-0%27/%3E%0A%3Cuse x=%27341.933004%27 y=%272.888992%27 xlink:href=%27%23g0-49%27/%3E%0A%3Cuse x=%27384.040823%27 y=%271.394612%27 xlink:href=%27%23g1-49%27/%3E%0A%3Cuse x=%27416.697976%27 y=%27-18.53076%27 xlink:href=%27%23g3-19%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\begin{equation*}
\begin{aligned}
M_{k} = A_{1:k,k} A_{k,1:k} +
\left(\begin{matrix}
M_{k-1} &amp;amp; M_{k-1}A_{1:k-1,k} \\
A_{k, 1:k-1} M_{k-1} &amp;amp; 1 \\
\end{matrix}\right)
\end{aligned}
\end{equation*}
" style="height: 2.5484em; vertical-align: -0.5392em; display: inline-block" class="org-latex org-latex-inline" />
</span>
</div>


<p>
Our implementation is this:
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">function</span> <span style="color: #8f0075;">generalized_floyd_warshall</span>(A::<span style="color: #531ab6; font-weight: bold;">Matrix</span>{S}) <span style="color: #005e8b; font-weight: bold;">where</span> S
    k,_ = size(A)
    <span style="color: #005e8b; font-weight: bold;">if</span> k == 0
        <span style="color: #005e8b; font-weight: bold;">return</span> A
    <span style="color: #005e8b; font-weight: bold;">end</span>

    M&#8342;&#8331;&#8321; = generalized_floyd_warshall(A[1:<span style="color: #005e8b; font-weight: bold;">end</span>-1,1:<span style="color: #005e8b; font-weight: bold;">end</span>-1])


    A[:,<span style="color: #005e8b; font-weight: bold;">end</span>:<span style="color: #005e8b; font-weight: bold;">end</span>] .* A[<span style="color: #005e8b; font-weight: bold;">end</span>:<span style="color: #005e8b; font-weight: bold;">end</span>,:] +
        <span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">I love julia's block matrix notation.
</span>    [M&#8342;&#8331;&#8321;                         M&#8342;&#8331;&#8321; * A[1:<span style="color: #005e8b; font-weight: bold;">end</span>-1,<span style="color: #005e8b; font-weight: bold;">end</span>:<span style="color: #005e8b; font-weight: bold;">end</span>]
     A[<span style="color: #005e8b; font-weight: bold;">end</span>:<span style="color: #005e8b; font-weight: bold;">end</span>,1:<span style="color: #005e8b; font-weight: bold;">end</span>-1] * M&#8342;&#8331;&#8321;    one(S)]
<span style="color: #005e8b; font-weight: bold;">end</span>


<span style="color: #005e8b; font-weight: bold;">let</span>
    result = generalized_floyd_warshall(A)[1,4]
    println(<span style="color: #a0132f;">"cost: $(result.a)"</span>)
    <span style="color: #005e8b; font-weight: bold;">for</span> path <span style="color: #005e8b; font-weight: bold;">in</span> result.b.choices
        println(<span style="color: #a0132f;">"path: $(path)"</span>)
    <span style="color: #005e8b; font-weight: bold;">end</span>
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<pre class="example">
cost: MinCost(2)
path: Edge[Edge("1&gt;2"), Edge("2&gt;4")]
</pre>

<p>
This algorithm runs <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%276.979929pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 6.979929 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page86%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( n \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> iterations where each iteration contains 3
operations of complexity <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2727.074055pt%27 height=%2711.600283pt%27 viewBox=%27-.500002 -8.609621 27.074055 11.600283%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g0-50%27 d=%27m3.521793-1.26924h-.237111c-.020922 .153425-.09066 .564882-.18132 .63462c-.055791 .041843-.592777 .041843-.690411 .041843h-1.283188c.732254-.648568 .976339-.843836 1.39477-1.171606c.516065-.411457 .99726-.843836 .99726-1.506351c0-.843836-.739228-1.3599-1.63188-1.3599c-.864757 0-1.45056 .606725-1.45056 1.248319c0 .355666 .299875 .390535 .369614 .390535c.167372 0 .369614-.118555 .369614-.369614c0-.125529-.048817-.369614-.411457-.369614c.216189-.495143 .690411-.648568 1.018182-.648568c.697385 0 1.060025 .54396 1.060025 1.108842c0 .606725-.432379 1.08792-.655542 1.338979l-1.680697 1.659776c-.069738 .062765-.069738 .076712-.069738 .27198h2.873225l.209215-1.26924z%27/%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g8-79%27 d=%27m7.372354-4.343711c0-1.603985-1.05604-2.67995-2.540473-2.67995c-2.15193 0-4.343711 2.261519-4.343711 4.582814c0 1.653798 1.115816 2.660025 2.550436 2.660025c2.11208 0 4.333748-2.181818 4.333748-4.562889zm-4.273973 4.303861c-.986301 0-1.683686-.806974-1.683686-2.122042c0-.438356 .139477-1.892902 .9066-3.058531c.687422-1.036115 1.663761-1.554172 2.450809-1.554172c.816936 0 1.713574 .557908 1.713574 2.042341c0 .71731-.268991 2.271482-1.255293 3.496887c-.478207 .607721-1.295143 1.195517-2.132005 1.195517z%27/%3E%0A%3Cpath id=%27g8-110%27 d=%27m.876712-.587796c-.029888 .14944-.089664 .37858-.089664 .428394c0 .179328 .139477 .268991 .288917 .268991c.119552 0 .298879-.079701 .368618-.278954c.009963-.019925 .129514-.488169 .18929-.737235l.219178-.896638c.059776-.219178 .119552-.438356 .169365-.667497c.039851-.169365 .119552-.458281 .129514-.498132c.14944-.308842 .67746-1.215442 1.62391-1.215442c.448319 0 .537983 .368618 .537983 .697385c0 .617684-.488169 1.892902-.647572 2.321295c-.089664 .229141-.099626 .348692-.099626 .458281c0 .468244 .348692 .816936 .816936 .816936c.936488 0 1.305106-1.454545 1.305106-1.534247c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.099626 .029888-.14944 .179328c-.199253 .67746-.52802 1.235367-1.016189 1.235367c-.169365 0-.239103-.099626-.239103-.328767c0-.249066 .089664-.488169 .179328-.707347c.18929-.52802 .607721-1.62391 .607721-2.191781c0-.667497-.428394-1.066002-1.145704-1.066002c-.896638 0-1.384807 .637609-1.554172 .86675c-.049813-.557908-.458281-.86675-.916563-.86675s-.647572 .388543-.747198 .56787c-.159402 .33873-.298879 .926526-.298879 .966376c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.009963 .169365-.229141c.169365-.707347 .368618-1.185554 .727273-1.185554c.199253 0 .308842 .129514 .308842 .458281c0 .209215-.029888 .318804-.159402 .836862l-.577833 2.30137z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page87%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-79%27/%3E%0A%3Cuse x=%277.876015%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2711.750389%27 y=%270%27 xlink:href=%27%23g8-110%27/%3E%0A%3Cuse x=%2717.730314%27 y=%27-3.615364%27 xlink:href=%27%23g0-50%27/%3E%0A%3Cuse x=%2722.199683%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( O(n^2) \)" style="height: 1.1411em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" />. We have achieved Floyd-Warshall&rsquo;s
complexity bound! (because that is what we, albeit in an obfuscated way, have
implemented).
</p>
</div>
</div>
</div>
<div id="outline-container-org440cc33" class="outline-2">
<h2 id="org440cc33"><span class="section-number-2">5.</span> Generalized dijkstra algorithm</h2>
<div class="outline-text-2" id="text-5">
<p>
The &ldquo;shortest path calculating algorithm&rdquo; we have implemented, however, is not
the one familiar to most of you dear readers, however. This is because in the
most general case of &ldquo;shortest path through graph where edge have weights&rdquo;,
Dijkstra&rsquo;s algorithm doesn&rsquo;t actually work. In fact, it relies on an additional
assumption we haven&rsquo;t made until now: positive weights.
</p>
</div>
<div id="outline-container-orga3920ed" class="outline-3">
<h3 id="orga3920ed"><span class="section-number-3">5.1.</span> Monotone vs non-monotone semi rings</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Dijkstra&rsquo;s algorithm is able to beat Floyd-Warshall by leveraging the assumption
of positive weights. What this lets Dijkstra do is early stopping: once the
algorithm visits the target node, it can be sure no new paths are going to be
better.
</p>

<p>
If we translate this &ldquo;positive weights&rdquo; in semi ring-speak, we get:
</p>

<ol class="org-ol">
<li>The existence of an order operation on the elements. This is easy, since <code>Sel</code>
already uses this for its addition.</li>
<li>For all weights <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2727.260201pt%27 height=%278.197303pt%27 viewBox=%27-.500002 -7.307786 27.260201 8.197303%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g5-50%27 d=%27m5.459527-2.291407c.169365 0 .348692 0 .348692-.199253s-.179328-.199253-.348692-.199253h-4.224159c.119552-1.334994 1.265255-2.291407 2.669988-2.291407h1.554172c.169365 0 .348692 0 .348692-.199253s-.179328-.199253-.348692-.199253h-1.574097c-1.703611 0-3.058531 1.295143-3.058531 2.889166s1.354919 2.889166 3.058531 2.889166h1.574097c.169365 0 .348692 0 .348692-.199253s-.179328-.199253-.348692-.199253h-1.554172c-1.404732 0-2.550436-.956413-2.669988-2.291407h4.224159z%27/%3E%0A%3Cpath id=%27g8-83%27 d=%27m6.425903-6.924035c0-.029888-.019925-.099626-.109589-.099626c-.049813 0-.059776 .009963-.179328 .14944l-.478207 .56787c-.259029-.468244-.777086-.71731-1.424658-.71731c-1.265255 0-2.460772 1.145704-2.460772 2.351183c0 .806974 .52802 1.265255 1.036115 1.414695l1.066002 .278954c.368618 .089664 .916563 .239103 .916563 1.05604c0 .896638-.816936 1.833126-1.793275 1.833126c-.637609 0-1.743462-.219178-1.743462-1.454545c0-.239103 .049813-.478207 .059776-.537983c.009963-.039851 .019925-.049813 .019925-.069738c0-.099626-.069738-.109589-.119552-.109589s-.069738 .009963-.099626 .039851c-.039851 .039851-.597758 2.311333-.597758 2.34122c0 .059776 .049813 .099626 .109589 .099626c.049813 0 .059776-.009963 .179328-.14944l.488169-.56787c.428394 .577833 1.105853 .71731 1.683686 .71731c1.354919 0 2.530511-1.325031 2.530511-2.560399c0-.687422-.33873-1.026152-.488169-1.165629c-.229141-.229141-.37858-.268991-1.265255-.498132c-.219178-.059776-.577833-.159402-.667497-.179328c-.268991-.089664-.607721-.37858-.607721-.9066c0-.806974 .797011-1.653798 1.743462-1.653798c.826899 0 1.43462 .428394 1.43462 1.544209c0 .318804-.039851 .498132-.039851 .557908c0 .009963 0 .099626 .119552 .099626c.099626 0 .109589-.029888 .14944-.199253l.537983-2.181818z%27/%3E%0A%3Cpath id=%27g8-119%27 d=%27m4.60274-3.377335c.049813-.219178 .14944-.587796 .14944-.647572c0-.179328-.139477-.268991-.288917-.268991c-.119552 0-.298879 .079701-.368618 .278954c-.029888 .069738-.498132 1.972603-.56787 2.231631c-.069738 .298879-.089664 .478207-.089664 .657534c0 .109589 0 .129514 .009963 .179328c-.229141 .52802-.52802 .836862-.916563 .836862c-.797011 0-.797011-.737235-.797011-.9066c0-.318804 .049813-.707347 .518057-1.932752c.109589-.298879 .169365-.438356 .169365-.637609c0-.448319-.328767-.816936-.816936-.816936c-.946451 0-1.315068 1.444583-1.315068 1.534247c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.019925 .159402-.179328c.268991-.926526 .657534-1.235367 1.006227-1.235367c.089664 0 .249066 .009963 .249066 .328767c0 .249066-.109589 .52802-.179328 .697385c-.438356 1.175592-.557908 1.633873-.557908 2.012453c0 .9066 .667497 1.255293 1.414695 1.255293c.169365 0 .637609 0 1.036115-.697385c.259029 .637609 .946451 .697385 1.24533 .697385c.747198 0 1.185554-.627646 1.444583-1.225405c.33873-.777086 .657534-2.11208 .657534-2.590286c0-.547945-.268991-.697385-.438356-.697385c-.249066 0-.498132 .259029-.498132 .478207c0 .129514 .059776 .18929 .14944 .268991c.109589 .109589 .358655 .368618 .358655 .846824c0 .33873-.288917 1.315068-.547945 1.823163c-.259029 .52802-.607721 .876712-1.09589 .876712c-.468244 0-.737235-.298879-.737235-.86675c0-.278954 .069738-.587796 .109589-.727273l.418431-1.673724z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page88%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-119%27/%3E%0A%3Cuse x=%2710.167845%27 y=%270%27 xlink:href=%27%23g5-50%27/%3E%0A%3Cuse x=%2719.57696%27 y=%270%27 xlink:href=%27%23g8-83%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( w \in S \)" style="height: 0.8063em; vertical-align: -0.0875em; display: inline-block" class="org-latex org-latex-inline" /> of some edge, multiplying by <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%278.400505pt%27 height=%275.28946pt%27 viewBox=%27-.500002 -4.789458 8.400505 5.28946%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-119%27 d=%27m4.60274-3.377335c.049813-.219178 .14944-.587796 .14944-.647572c0-.179328-.139477-.268991-.288917-.268991c-.119552 0-.298879 .079701-.368618 .278954c-.029888 .069738-.498132 1.972603-.56787 2.231631c-.069738 .298879-.089664 .478207-.089664 .657534c0 .109589 0 .129514 .009963 .179328c-.229141 .52802-.52802 .836862-.916563 .836862c-.797011 0-.797011-.737235-.797011-.9066c0-.318804 .049813-.707347 .518057-1.932752c.109589-.298879 .169365-.438356 .169365-.637609c0-.448319-.328767-.816936-.816936-.816936c-.946451 0-1.315068 1.444583-1.315068 1.534247c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.019925 .159402-.179328c.268991-.926526 .657534-1.235367 1.006227-1.235367c.089664 0 .249066 .009963 .249066 .328767c0 .249066-.109589 .52802-.179328 .697385c-.438356 1.175592-.557908 1.633873-.557908 2.012453c0 .9066 .667497 1.255293 1.414695 1.255293c.169365 0 .637609 0 1.036115-.697385c.259029 .637609 .946451 .697385 1.24533 .697385c.747198 0 1.185554-.627646 1.444583-1.225405c.33873-.777086 .657534-2.11208 .657534-2.590286c0-.547945-.268991-.697385-.438356-.697385c-.249066 0-.498132 .259029-.498132 .478207c0 .129514 .059776 .18929 .14944 .268991c.109589 .109589 .358655 .368618 .358655 .846824c0 .33873-.288917 1.315068-.547945 1.823163c-.259029 .52802-.607721 .876712-1.09589 .876712c-.468244 0-.737235-.298879-.737235-.86675c0-.278954 .069738-.587796 .109589-.727273l.418431-1.673724z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page89%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-119%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( w \)" style="height: 0.5203em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" /> is a
monotone operation. This means that <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27113.704224pt%27 height=%279.85568pt%27 viewBox=%27-.500002 -7.4185 113.704224 9.85568%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g8-58%27 d=%27m1.912827-.52802c0-.288917-.239103-.52802-.52802-.52802s-.52802 .239103-.52802 .52802s.239103 .52802 .52802 .52802s.52802-.239103 .52802-.52802z%27/%3E%0A%3Cpath id=%27g8-59%27 d=%27m2.022416-.009963c0-.657534-.249066-1.046077-.637609-1.046077c-.328767 0-.52802 .249066-.52802 .52802c0 .268991 .199253 .52802 .52802 .52802c.119552 0 .249066-.039851 .348692-.129514c.029888-.019925 .039851-.029888 .049813-.029888s.019925 .009963 .019925 .14944c0 .737235-.348692 1.334994-.67746 1.663761c-.109589 .109589-.109589 .129514-.109589 .159402c0 .069738 .049813 .109589 .099626 .109589c.109589 0 .9066-.767123 .9066-1.932752z%27/%3E%0A%3Cpath id=%27g8-83%27 d=%27m6.425903-6.924035c0-.029888-.019925-.099626-.109589-.099626c-.049813 0-.059776 .009963-.179328 .14944l-.478207 .56787c-.259029-.468244-.777086-.71731-1.424658-.71731c-1.265255 0-2.460772 1.145704-2.460772 2.351183c0 .806974 .52802 1.265255 1.036115 1.414695l1.066002 .278954c.368618 .089664 .916563 .239103 .916563 1.05604c0 .896638-.816936 1.833126-1.793275 1.833126c-.637609 0-1.743462-.219178-1.743462-1.454545c0-.239103 .049813-.478207 .059776-.537983c.009963-.039851 .019925-.049813 .019925-.069738c0-.099626-.069738-.109589-.119552-.109589s-.069738 .009963-.099626 .039851c-.039851 .039851-.597758 2.311333-.597758 2.34122c0 .059776 .049813 .099626 .109589 .099626c.049813 0 .059776-.009963 .179328-.14944l.488169-.56787c.428394 .577833 1.105853 .71731 1.683686 .71731c1.354919 0 2.530511-1.325031 2.530511-2.560399c0-.687422-.33873-1.026152-.488169-1.165629c-.229141-.229141-.37858-.268991-1.265255-.498132c-.219178-.059776-.577833-.159402-.667497-.179328c-.268991-.089664-.607721-.37858-.607721-.9066c0-.806974 .797011-1.653798 1.743462-1.653798c.826899 0 1.43462 .428394 1.43462 1.544209c0 .318804-.039851 .498132-.039851 .557908c0 .009963 0 .099626 .119552 .099626c.099626 0 .109589-.029888 .14944-.199253l.537983-2.181818z%27/%3E%0A%3Cpath id=%27g8-115%27 d=%27m3.895392-3.726027c-.278954 .009963-.478207 .229141-.478207 .448319c0 .139477 .089664 .288917 .308842 .288917s.458281-.169365 .458281-.557908c0-.448319-.428394-.856787-1.185554-.856787c-1.315068 0-1.683686 1.016189-1.683686 1.454545c0 .777086 .737235 .926526 1.026152 .986301c.518057 .099626 1.036115 .209215 1.036115 .757161c0 .259029-.229141 1.09589-1.424658 1.09589c-.139477 0-.9066 0-1.135741-.52802c.37858 .049813 .627646-.249066 .627646-.52802c0-.229141-.159402-.348692-.368618-.348692c-.259029 0-.557908 .209215-.557908 .657534c0 .56787 .56787 .966376 1.424658 .966376c1.613948 0 2.002491-1.205479 2.002491-1.653798c0-.358655-.18929-.607721-.308842-.727273c-.268991-.278954-.557908-.328767-.996264-.418431c-.358655-.079701-.757161-.14944-.757161-.597758c0-.288917 .239103-.896638 1.115816-.896638c.249066 0 .747198 .069738 .896638 .458281z%27/%3E%0A%3Cpath id=%27g8-116%27 d=%27m2.052304-3.985056h.936488c.199253 0 .298879 0 .298879-.199253c0-.109589-.099626-.109589-.278954-.109589h-.876712c.358655-1.414695 .408468-1.613948 .408468-1.673724c0-.169365-.119552-.268991-.288917-.268991c-.029888 0-.308842 .009963-.398506 .358655l-.388543 1.58406h-.936488c-.199253 0-.298879 0-.298879 .18929c0 .119552 .079701 .119552 .278954 .119552h.876712c-.71731 2.82939-.757161 2.998755-.757161 3.178082c0 .537983 .37858 .916563 .916563 .916563c1.016189 0 1.58406-1.454545 1.58406-1.534247c0-.099626-.079701-.099626-.119552-.099626c-.089664 0-.099626 .029888-.14944 .139477c-.428394 1.036115-.956413 1.275218-1.295143 1.275218c-.209215 0-.308842-.129514-.308842-.458281c0-.239103 .019925-.308842 .059776-.478207l.737235-2.938979z%27/%3E%0A%3Cpath id=%27g8-119%27 d=%27m4.60274-3.377335c.049813-.219178 .14944-.587796 .14944-.647572c0-.179328-.139477-.268991-.288917-.268991c-.119552 0-.298879 .079701-.368618 .278954c-.029888 .069738-.498132 1.972603-.56787 2.231631c-.069738 .298879-.089664 .478207-.089664 .657534c0 .109589 0 .129514 .009963 .179328c-.229141 .52802-.52802 .836862-.916563 .836862c-.797011 0-.797011-.737235-.797011-.9066c0-.318804 .049813-.707347 .518057-1.932752c.109589-.298879 .169365-.438356 .169365-.637609c0-.448319-.328767-.816936-.816936-.816936c-.946451 0-1.315068 1.444583-1.315068 1.534247c0 .099626 .099626 .099626 .119552 .099626c.099626 0 .109589-.019925 .159402-.179328c.268991-.926526 .657534-1.235367 1.006227-1.235367c.089664 0 .249066 .009963 .249066 .328767c0 .249066-.109589 .52802-.179328 .697385c-.438356 1.175592-.557908 1.633873-.557908 2.012453c0 .9066 .667497 1.255293 1.414695 1.255293c.169365 0 .637609 0 1.036115-.697385c.259029 .637609 .946451 .697385 1.24533 .697385c.747198 0 1.185554-.627646 1.444583-1.225405c.33873-.777086 .657534-2.11208 .657534-2.590286c0-.547945-.268991-.697385-.438356-.697385c-.249066 0-.498132 .259029-.498132 .478207c0 .129514 .059776 .18929 .14944 .268991c.109589 .109589 .358655 .368618 .358655 .846824c0 .33873-.288917 1.315068-.547945 1.823163c-.259029 .52802-.607721 .876712-1.09589 .876712c-.468244 0-.737235-.298879-.737235-.86675c0-.278954 .069738-.587796 .109589-.727273l.418431-1.673724z%27/%3E%0A%3Cpath id=%27g5-20%27 d=%27m6.724782-5.917808c.109589-.049813 .18929-.099626 .18929-.219178c0-.109589-.079701-.199253-.199253-.199253c-.049813 0-.139477 .039851-.179328 .059776l-5.50934 2.600249c-.169365 .079701-.199253 .14944-.199253 .229141c0 .089664 .059776 .159402 .199253 .219178l5.50934 2.590286c.129514 .069738 .14944 .069738 .179328 .069738c.109589 0 .199253-.089664 .199253-.199253c0-.089664-.039851-.14944-.209215-.229141l-5.210461-2.450809l5.230386-2.470735zm-.159402 7.28269c.169365 0 .348692 0 .348692-.199253s-.209215-.199253-.358655-.199253h-5.369863c-.14944 0-.358655 0-.358655 .199253s.179328 .199253 .348692 .199253h5.389788z%27/%3E%0A%3Cpath id=%27g5-41%27 d=%27m7.232877-3.257783c.418431 .358655 .926526 .617684 1.255293 .767123c-.358655 .159402-.846824 .418431-1.255293 .767123h-6.326276c-.169365 0-.358655 0-.358655 .199253s.179328 .199253 .348692 .199253h5.88792c-.478207 .458281-.996264 1.334994-.996264 1.464508c0 .109589 .129514 .109589 .18929 .109589c.079701 0 .14944 0 .18929-.079701c.209215-.37858 .488169-.9066 1.135741-1.484433c.687422-.607721 1.354919-.876712 1.872976-1.026152c.169365-.059776 .179328-.069738 .199253-.089664c.019925-.009963 .019925-.039851 .019925-.059776s0-.039851-.009963-.059776l-.029888-.019925c-.019925-.009963-.029888-.019925-.219178-.079701c-1.344956-.398506-2.34122-1.305106-2.899128-2.371108c-.109589-.199253-.119552-.209215-.259029-.209215c-.059776 0-.18929 0-.18929 .109589c0 .129514 .508095 .996264 .996264 1.464508h-5.88792c-.169365 0-.348692 0-.348692 .199253s.18929 .199253 .358655 .199253h6.326276z%27/%3E%0A%3Cpath id=%27g5-50%27 d=%27m5.459527-2.291407c.169365 0 .348692 0 .348692-.199253s-.179328-.199253-.348692-.199253h-4.224159c.119552-1.334994 1.265255-2.291407 2.669988-2.291407h1.554172c.169365 0 .348692 0 .348692-.199253s-.179328-.199253-.348692-.199253h-1.574097c-1.703611 0-3.058531 1.295143-3.058531 2.889166s1.354919 2.889166 3.058531 2.889166h1.574097c.169365 0 .348692 0 .348692-.199253s-.179328-.199253-.348692-.199253h-1.554172c-1.404732 0-2.550436-.956413-2.669988-2.291407h4.224159z%27/%3E%0A%3Cpath id=%27g5-56%27 d=%27m5.489415-6.535492c.049813-.109589 .049813-.129514 .049813-.179328c0-.099626-.079701-.199253-.199253-.199253c-.129514 0-.18929 .119552-.229141 .229141l-.826899 2.191781h-3.028643l-.826899-2.191781c-.049813-.139477-.099626-.229141-.229141-.229141c-.099626 0-.199253 .099626-.199253 .199253c0 .019925 0 .039851 .059776 .179328l2.480697 6.525529c.049813 .139477 .099626 .229141 .229141 .229141c.139477 0 .179328-.109589 .219178-.209215l2.500623-6.545455zm-4.07472 2.440847h2.709838l-1.354919 3.5467l-1.354919-3.5467z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page90%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g5-56%27/%3E%0A%3Cuse x=%275.534817%27 y=%270%27 xlink:href=%27%23g8-115%27/%3E%0A%3Cuse x=%2710.204804%27 y=%270%27 xlink:href=%27%23g8-59%27/%3E%0A%3Cuse x=%2714.632612%27 y=%270%27 xlink:href=%27%23g8-116%27/%3E%0A%3Cuse x=%2720.99758%27 y=%270%27 xlink:href=%27%23g5-50%27/%3E%0A%3Cuse x=%2730.406694%27 y=%270%27 xlink:href=%27%23g8-83%27/%3E%0A%3Cuse x=%2736.536475%27 y=%270%27 xlink:href=%27%23g8-58%27/%3E%0A%3Cuse x=%2739.303883%27 y=%270%27 xlink:href=%27%23g8-115%27/%3E%0A%3Cuse x=%2746.741203%27 y=%270%27 xlink:href=%27%23g5-20%27/%3E%0A%3Cuse x=%2757.257283%27 y=%270%27 xlink:href=%27%23g8-116%27/%3E%0A%3Cuse x=%2763.622251%27 y=%270%27 xlink:href=%27%23g5-41%27/%3E%0A%3Cuse x=%2776.352252%27 y=%270%27 xlink:href=%27%23g8-115%27/%3E%0A%3Cuse x=%2781.022239%27 y=%270%27 xlink:href=%27%23g8-119%27/%3E%0A%3Cuse x=%2791.190084%27 y=%270%27 xlink:href=%27%23g5-20%27/%3E%0A%3Cuse x=%27101.706164%27 y=%270%27 xlink:href=%27%23g8-116%27/%3E%0A%3Cuse x=%27105.303799%27 y=%270%27 xlink:href=%27%23g8-119%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\( \forall s,t \in S. s \le t \Rightarrow sw \le tw \)" style="height: 0.9695em; vertical-align: -0.2397em; display: inline-block" class="org-latex org-latex-inline" /></li>
</ol>

<p>
Let&rsquo;s implement the order structure for <code>Sel</code>.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code>Base.<span style="color: #8f0075;">isless</span>(x::<span style="color: #531ab6; font-weight: bold;">Sel</span>{A,B}, y::<span style="color: #531ab6; font-weight: bold;">Sel</span>{A,B}) <span style="color: #005e8b; font-weight: bold;">where</span> {A,B} = x.a &lt; y.a
</code></pre>
</div>

<p>
With this property, Dijkstra&rsquo;s algorithm can be used almost verbatim. We only
need to tweak a few types to make it work.
</p>

<p>
Because julia doesn&rsquo;t have a builtin priority heap, let me write a slow
implementation of one first.
</p>
<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">mutable struct</span> <span style="color: #531ab6; font-weight: bold;">MinHeap</span>
    keys
    values
<span style="color: #005e8b; font-weight: bold;">end</span>

<span style="color: #005e8b; font-weight: bold;">function</span> <span style="color: #8f0075;">MinHeap</span>()
    MinHeap(
        [],
        [],
    )
<span style="color: #005e8b; font-weight: bold;">end</span>

<span style="color: #005e8b; font-weight: bold;">function</span> Base.<span style="color: #8f0075;">pop!</span>(h::<span style="color: #531ab6; font-weight: bold;">MinHeap</span>)
    k = pop!(h.keys)
    v = pop!(h.values)
    k, v
<span style="color: #005e8b; font-weight: bold;">end</span>

<span style="color: #005e8b; font-weight: bold;">function</span> <span style="color: #8f0075;">insert!</span>(h::<span style="color: #531ab6; font-weight: bold;">MinHeap</span>, k, v)
    push!(h.keys, k)
    push!(h.values, v)

    perms = sortperm(h.keys, rev=<span style="color: #531ab6;">true</span>)
    h.keys = h.keys[perms]
    h.values = h.values[perms]
<span style="color: #005e8b; font-weight: bold;">end</span>
</code></pre>
</div>

<p>
Since dijkstra isn&rsquo;t using the same graph representation as FW, we need to
massage the graph into a different representation.
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">Here a graph is represented by a function that gives you the
</span><span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">outgoing edges to a given node.
</span><span style="color: #005e8b; font-weight: bold;">function</span> <span style="color: #8f0075;">the_graph</span>(from_node)
    <span style="color: #005e8b; font-weight: bold;">if</span> from_node == 1
        [(1, 2), (1,5)]
    <span style="color: #005e8b; font-weight: bold;">elseif</span> from_node == 2
        <span style="color: #005e8b; font-weight: bold;">return</span> [(2, 3), (2, 4)]
    <span style="color: #005e8b; font-weight: bold;">elseif</span> from_node == 3
        <span style="color: #005e8b; font-weight: bold;">return</span> [(3, 4)]
    <span style="color: #005e8b; font-weight: bold;">elseif</span> from_node == 4
        <span style="color: #005e8b; font-weight: bold;">return</span> []
    <span style="color: #005e8b; font-weight: bold;">elseif</span> from_node == 5
        <span style="color: #005e8b; font-weight: bold;">return</span> [(5,3)]
    <span style="color: #005e8b; font-weight: bold;">else</span>
        error(<span style="color: #a0132f;">"no such node:"</span>, from_node)
    <span style="color: #005e8b; font-weight: bold;">end</span>
<span style="color: #005e8b; font-weight: bold;">end</span>

<span style="color: #595959; font-style: italic;"># </span><span style="color: #595959; font-style: italic;">The weight of an edge is a tuple of a constant 1 and the edge name.
</span><span style="color: #005e8b; font-weight: bold;">function</span> <span style="color: #8f0075;">cost</span>(n)
    edges = [(1,2), (1,5), (2,3), (2,4), (3,4), (5,3)]
    <span style="color: #005e8b; font-weight: bold;">if</span> n &#8712; edges
        a,b = n
        Sel(MinCost(1), Free(Set([[Edge(<span style="color: #a0132f;">"$(a)&gt;$(b)"</span>)]])))
    <span style="color: #005e8b; font-weight: bold;">else</span>
        error(<span style="color: #a0132f;">"no such edge"</span>, n)
    <span style="color: #005e8b; font-weight: bold;">end</span>
<span style="color: #005e8b; font-weight: bold;">end</span>

<span style="color: #8f0075;">target</span>((a,b)) = b
</code></pre>
</div>

<p>
Now we are ready for the final algorithm. Behold, Dijkstra!!
</p>

<div class="org-src-container">
<pre class="src src-julia"><code><span style="color: #005e8b; font-weight: bold;">function</span> <span style="color: #8f0075;">generalized_dijkstra</span>(S::<span style="color: #531ab6; font-weight: bold;">Type</span>{&lt;:<span style="color: #531ab6; font-weight: bold;">Semiring</span>}, graph, cost, s&#8320;, s&#8321;)
    queue = MinHeap()
    state_costs = Dict()
    visited = Set()

    state_costs[s&#8320;] = one(S)
    insert!(queue, state_costs[s&#8320;], s&#8320;)

    <span style="color: #005e8b; font-weight: bold;">while</span> <span style="color: #531ab6;">true</span>
        source_cost, source_state = pop!(queue)
        <span style="color: #005e8b; font-weight: bold;">if</span> source_state == s&#8321;
            <span style="color: #005e8b; font-weight: bold;">return</span> state_costs[source_state]
        <span style="color: #005e8b; font-weight: bold;">end</span>

        <span style="color: #005e8b; font-weight: bold;">if</span> source_state &#8712; visited
            <span style="color: #005e8b; font-weight: bold;">continue</span>
        <span style="color: #005e8b; font-weight: bold;">else</span>
            push!(visited, source_state)
        <span style="color: #005e8b; font-weight: bold;">end</span>

        edges = graph(source_state)
        <span style="color: #005e8b; font-weight: bold;">for</span> edge <span style="color: #005e8b; font-weight: bold;">in</span> edges

            target_state = target(edge)
            <span style="color: #005e8b; font-weight: bold;">if</span> target_state &#8713; keys(state_costs)
                state_costs[target_state] = zero(S)
            <span style="color: #005e8b; font-weight: bold;">end</span>

            state_costs[target_state] += source_cost * cost(edge)
            insert!(queue, state_costs[target_state], target_state)
        <span style="color: #005e8b; font-weight: bold;">end</span>
    <span style="color: #005e8b; font-weight: bold;">end</span>
<span style="color: #005e8b; font-weight: bold;">end</span>

println(generalized_dijkstra(Sel{MinCost, Free{Edge}}, the_graph, cost, 1, 4))
</code></pre>
</div>

<pre class="example">
Sel{MinCost, Free{Edge}}(MinCost(2), Free{Edge}(Set(Vector{Edge}[[Edge("1&gt;2"), Edge("2&gt;4")]])))
</pre>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
They are other properties, but they aren&rsquo;t as useful for intuition.
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
Note: This looks a lot like what the wikipedia page on <a href="https://en.wikipedia.org/wiki/Weighted_automaton">weighted automata</a>
calls the weight of a word.
</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3" role="doc-backlink">3</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
This optimization looks a lot like the idea of computing gradients instead
of jacobians in automatic differentiation. We leverage a specific more efficient
order of computation for complexity gains.
</p></div></div>

<div class="footdef"><sup><a id="fn.4" class="footnum" href="#fnr.4" role="doc-backlink">4</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
Be careful! in Julia, the multiplication operator is left associative (<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.4.3 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2787.374737pt%27 height=%2710.962644pt%27 viewBox=%27-.500002 -7.971982 87.374737 10.962644%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g1-40%27 d=%27m3.297634 2.391034c0-.029888 0-.049813-.169365-.219178c-1.24533-1.255293-1.564134-3.138232-1.564134-4.662516c0-1.733499 .37858-3.466999 1.603985-4.712329c.129514-.119552 .129514-.139477 .129514-.169365c0-.069738-.039851-.099626-.099626-.099626c-.099626 0-.996264 .67746-1.58406 1.942715c-.508095 1.09589-.627646 2.201743-.627646 3.038605c0 .777086 .109589 1.982565 .657534 3.108344c.597758 1.225405 1.454545 1.872976 1.554172 1.872976c.059776 0 .099626-.029888 .099626-.099626z%27/%3E%0A%3Cpath id=%27g1-41%27 d=%27m2.879203-2.49066c0-.777086-.109589-1.982565-.657534-3.108344c-.597758-1.225405-1.454545-1.872976-1.554172-1.872976c-.059776 0-.099626 .039851-.099626 .099626c0 .029888 0 .049813 .18929 .229141c.976339 .986301 1.544209 2.570361 1.544209 4.652553c0 1.703611-.368618 3.457036-1.603985 4.712329c-.129514 .119552-.129514 .139477-.129514 .169365c0 .059776 .039851 .099626 .099626 .099626c.099626 0 .996264-.67746 1.58406-1.942715c.508095-1.09589 .627646-2.201743 .627646-3.038605z%27/%3E%0A%3Cpath id=%27g1-61%27 d=%27m6.844334-3.257783c.14944 0 .33873 0 .33873-.199253s-.18929-.199253-.328767-.199253h-5.967621c-.139477 0-.328767 0-.328767 .199253s.18929 .199253 .33873 .199253h5.947696zm.009963 1.932752c.139477 0 .328767 0 .328767-.199253s-.18929-.199253-.33873-.199253h-5.947696c-.14944 0-.33873 0-.33873 .199253s.18929 .199253 .328767 .199253h5.967621z%27/%3E%0A%3Cpath id=%27g5-3%27 d=%27m2.739726-4.254047c.009963-.139477 .009963-.37858-.249066-.37858c-.159402 0-.288917 .129514-.259029 .259029v.129514l.139477 1.544209l-1.275218-.926526c-.089664-.049813-.109589-.069738-.179328-.069738c-.139477 0-.268991 .139477-.268991 .278954c0 .159402 .099626 .199253 .199253 .249066l1.414695 .67746l-1.374844 .667497c-.159402 .079701-.239103 .119552-.239103 .268991s.129514 .278954 .268991 .278954c.069738 0 .089664 0 .33873-.18929l1.115816-.806974l-.14944 1.673724c0 .209215 .179328 .259029 .259029 .259029c.119552 0 .268991-.069738 .268991-.259029l-.14944-1.673724l1.275218 .926526c.089664 .049813 .109589 .069738 .179328 .069738c.139477 0 .268991-.139477 .268991-.278954c0-.14944-.089664-.199253-.209215-.259029c-.597758-.298879-.617684-.298879-1.404732-.667497l1.374844-.667497c.159402-.079701 .239103-.119552 .239103-.268991s-.129514-.278954-.268991-.278954c-.069738 0-.089664 0-.33873 .18929l-1.115816 .806974l.139477-1.554172z%27/%3E%0A%3Cpath id=%27g8-97%27 d=%27m3.716065-3.765878c-.179328-.368618-.468244-.637609-.916563-.637609c-1.165629 0-2.400996 1.464508-2.400996 2.919054c0 .936488 .547945 1.594022 1.325031 1.594022c.199253 0 .697385-.039851 1.295143-.747198c.079701 .418431 .428394 .747198 .9066 .747198c.348692 0 .577833-.229141 .737235-.547945c.169365-.358655 .298879-.966376 .298879-.986301c0-.099626-.089664-.099626-.119552-.099626c-.099626 0-.109589 .039851-.139477 .179328c-.169365 .647572-.348692 1.235367-.757161 1.235367c-.268991 0-.298879-.259029-.298879-.458281c0-.219178 .019925-.298879 .129514-.737235c.109589-.418431 .129514-.518057 .219178-.896638l.358655-1.39477c.069738-.278954 .069738-.298879 .069738-.33873c0-.169365-.119552-.268991-.288917-.268991c-.239103 0-.388543 .219178-.418431 .438356zm-.647572 2.580324c-.049813 .179328-.049813 .199253-.199253 .368618c-.438356 .547945-.846824 .707347-1.125778 .707347c-.498132 0-.637609-.547945-.637609-.936488c0-.498132 .318804-1.723537 .547945-2.181818c.308842-.587796 .757161-.956413 1.155666-.956413c.647572 0 .787049 .816936 .787049 .876712s-.019925 .119552-.029888 .169365l-.498132 1.952677z%27/%3E%0A%3Cpath id=%27g8-98%27 d=%27m2.381071-6.804483c0-.009963 0-.109589-.129514-.109589c-.229141 0-.956413 .079701-1.215442 .099626c-.079701 .009963-.18929 .019925-.18929 .199253c0 .119552 .089664 .119552 .239103 .119552c.478207 0 .498132 .069738 .498132 .169365c0 .069738-.089664 .408468-.139477 .617684l-.816936 3.247821c-.119552 .498132-.159402 .657534-.159402 1.006227c0 .946451 .52802 1.564134 1.265255 1.564134c1.175592 0 2.400996-1.484433 2.400996-2.919054c0-.9066-.52802-1.594022-1.325031-1.594022c-.458281 0-.86675 .288917-1.165629 .597758l.737235-2.998755zm-.936488 3.765878c.059776-.219178 .059776-.239103 .14944-.348692c.488169-.647572 .936488-.797011 1.195517-.797011c.358655 0 .627646 .298879 .627646 .936488c0 .587796-.328767 1.733499-.508095 2.11208c-.328767 .667497-.787049 1.026152-1.175592 1.026152c-.33873 0-.667497-.268991-.667497-1.006227c0-.18929 0-.37858 .159402-1.006227l.219178-.916563z%27/%3E%0A%3Cpath id=%27g8-99%27 d=%27m3.945205-3.785803c-.159402 0-.298879 0-.438356 .139477c-.159402 .14944-.179328 .318804-.179328 .388543c0 .239103 .179328 .348692 .368618 .348692c.288917 0 .557908-.239103 .557908-.637609c0-.488169-.468244-.856787-1.175592-.856787c-1.344956 0-2.669988 1.424658-2.669988 2.82939c0 .896638 .577833 1.683686 1.613948 1.683686c1.424658 0 2.261519-1.05604 2.261519-1.175592c0-.059776-.059776-.129514-.119552-.129514c-.049813 0-.069738 .019925-.129514 .099626c-.787049 .986301-1.872976 .986301-1.992528 .986301c-.627646 0-.896638-.488169-.896638-1.085928c0-.408468 .199253-1.374844 .537983-1.992528c.308842-.56787 .856787-.996264 1.404732-.996264c.33873 0 .71731 .129514 .856787 .398506z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page55%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%270%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%277.48002%27 y=%270%27 xlink:href=%27%23g5-3%27/%3E%0A%3Cuse x=%2714.675225%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3Cuse x=%2721.164725%27 y=%270%27 xlink:href=%27%23g5-3%27/%3E%0A%3Cuse x=%2728.35993%27 y=%270%27 xlink:href=%27%23g8-99%27/%3E%0A%3Cuse x=%2735.438659%27 y=%270%27 xlink:href=%27%23g1-61%27/%3E%0A%3Cuse x=%2745.954739%27 y=%270%27 xlink:href=%27%23g1-40%27/%3E%0A%3Cuse x=%2749.829113%27 y=%270%27 xlink:href=%27%23g8-97%27/%3E%0A%3Cuse x=%2757.309133%27 y=%270%27 xlink:href=%27%23g5-3%27/%3E%0A%3Cuse x=%2764.504338%27 y=%270%27 xlink:href=%27%23g8-98%27/%3E%0A%3Cuse x=%2768.779972%27 y=%270%27 xlink:href=%27%23g1-41%27/%3E%0A%3Cuse x=%2774.868212%27 y=%270%27 xlink:href=%27%23g5-3%27/%3E%0A%3Cuse x=%2782.063417%27 y=%270%27 xlink:href=%27%23g8-99%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(
a*b*c = (a*b)*c \)" style="height: 1.0784em; vertical-align: -0.2942em; display: inline-block" class="org-latex org-latex-inline" />). If that weren&rsquo;t the case, the same text would parse as
repeated matrix multiplication, followed by vector matrix multiplication.
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="date">Date: 2025-09-25 Thu 00:00</p>
<p class="author">Author: Justin Veilleux</p>
<p class="date">Created: 2025-09-25 Thu 18:12</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
